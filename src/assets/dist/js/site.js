var Xn=Object.defineProperty;var Jn=(n,e,t)=>e in n?Xn(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var S=(n,e,t)=>(Jn(n,typeof e!="symbol"?e+"":e,t),t);function Zn(){const n=document.getElementById("nav"),e=document.getElementById("mobile-icon"),t=document.querySelector("#mobile-icon > svg > use");function s(){n.classList.toggle("block"),n.classList.toggle("active"),t.setAttribute("xlink:href","#close"),e.title="Close Menu",!n.classList.contains("block")&&!n.classList.contains("active")&&(t.setAttribute("xlink:href","#solid-bars"),e.title="Open Menu")}e==null||e.addEventListener("click",s)}Zn();function es(){document.addEventListener("DOMContentLoaded",function(){const n=document.querySelector("[data-field-handle='virtualRecruiter']");if(n!==null){let l=function(){n.addEventListener("onAfterFormieEvaluateConditions",function(u){u.target.conditionallyHidden?c(!1):r.dispatchEvent(new Event("change",{bubbles:!0}))}),r.addEventListener("change",u=>{c(u.target.checked)})},c=function(u){const h=u?"thankyou":"sorry";a.value=h};var t=l,s=c;const i=document.querySelector(".fui-form"),r=n.querySelector("input[type='checkbox']"),a=i.querySelector("[data-field-handle='vrRedirect'] input");l()}},!1)}es();function ts(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var xe={exports:{}};xe.exports=vt;xe.exports.isMobile=vt;xe.exports.default=vt;const ns=/(android|bb\d+|meego).+mobile|armv7l|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|samsungbrowser.*mobile|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,ss=/CrOS/,is=/android|ipad|playbook|silk/i;function vt(n){n||(n={});let e=n.ua;if(!e&&typeof navigator<"u"&&(e=navigator.userAgent),e&&e.headers&&typeof e.headers["user-agent"]=="string"&&(e=e.headers["user-agent"]),typeof e!="string")return!1;let t=ns.test(e)&&!ss.test(e)||!!n.tablet&&is.test(e);return!t&&n.tablet&&n.featureDetect&&navigator&&navigator.maxTouchPoints>1&&e.indexOf("Macintosh")!==-1&&e.indexOf("Safari")!==-1&&(t=!0),t}var rs=xe.exports;const os=ts(rs);/*! js-cookie v3.0.5 | MIT */function Ae(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)n[s]=t[s]}return n}var as={read:function(n){return n[0]==='"'&&(n=n.slice(1,-1)),n.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(n){return encodeURIComponent(n).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function et(n,e){function t(i,r,a){if(!(typeof document>"u")){a=Ae({},e,a),typeof a.expires=="number"&&(a.expires=new Date(Date.now()+a.expires*864e5)),a.expires&&(a.expires=a.expires.toUTCString()),i=encodeURIComponent(i).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var l="";for(var c in a)a[c]&&(l+="; "+c,a[c]!==!0&&(l+="="+a[c].split(";")[0]));return document.cookie=i+"="+n.write(r,i)+l}}function s(i){if(!(typeof document>"u"||arguments.length&&!i)){for(var r=document.cookie?document.cookie.split("; "):[],a={},l=0;l<r.length;l++){var c=r[l].split("="),u=c.slice(1).join("=");try{var h=decodeURIComponent(c[0]);if(a[h]=n.read(u,h),i===h)break}catch{}}return i?a[i]:a}}return Object.create({set:t,get:s,remove:function(i,r){t(i,"",Ae({},r,{expires:-1}))},withAttributes:function(i){return et(this.converter,Ae({},this.attributes,i))},withConverter:function(i){return et(Ae({},this.converter,i),this.attributes)}},{attributes:{value:Object.freeze(e)},converter:{value:Object.freeze(n)}})}var tt=et(as,{path:"/"});function ls(){const n="exitModal",e=document.querySelector(`#${n}`),t=!!e,s=os(),i=!!tt.get(`modal.${n}`);function r(){new bootstrap.Modal(`#${n}`).show(),tt.set(`modal.${n}`,"1",{expires:1})}function a(){s?setTimeout(r,6e3):document.addEventListener("mouseleave",r,{once:!0})}function l(){a(),u()}function c(v=0){setTimeout(()=>{typeof window.bootstrap<"u"?l():v<10&&c(v+1)},500)}t&&!i&&c();function u(){const g=e.dataset.referrer+"_eb";h(g)}function h(v){const A=e.dataset.utmSource,g=new URL("#quickApp",location);g.searchParams.set("utm_source",A),g.searchParams.set("utm_campaign",v),g.searchParams.set("utm_medium","eb"),g.searchParams.set("r",v),document.getElementById("exitbannerLink").href=g.href}}ls();const cs="modulepreload",us=function(n){return"/"+n},Rt={},ds=function(e,t,s){if(!t||t.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(t.map(r=>{if(r=us(r),r in Rt)return;Rt[r]=!0;const a=r.endsWith(".css"),l=a?'[rel="stylesheet"]':"";if(!!s)for(let h=i.length-1;h>=0;h--){const v=i[h];if(v.href===r&&(!a||v.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${r}"]${l}`))return;const u=document.createElement("link");if(u.rel=a?"stylesheet":cs,a||(u.as="script",u.crossOrigin=""),u.href=r,document.head.appendChild(u),a)return new Promise((h,v)=>{u.addEventListener("load",h),u.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>e()).catch(r=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=r,window.dispatchEvent(a),!a.defaultPrevented)throw r})};function O(n){return n!=null&&typeof n=="object"&&n["@@functional/placeholder"]===!0}function Q(n){return function e(t){return arguments.length===0||O(t)?e:n.apply(this,arguments)}}function q(n){return function e(t,s){switch(arguments.length){case 0:return e;case 1:return O(t)?e:Q(function(i){return n(t,i)});default:return O(t)&&O(s)?e:O(t)?Q(function(i){return n(i,s)}):O(s)?Q(function(i){return n(t,i)}):n(t,s)}}}function Et(n){return function e(t,s,i){switch(arguments.length){case 0:return e;case 1:return O(t)?e:q(function(r,a){return n(t,r,a)});case 2:return O(t)&&O(s)?e:O(t)?q(function(r,a){return n(r,s,a)}):O(s)?q(function(r,a){return n(t,r,a)}):Q(function(r){return n(t,s,r)});default:return O(t)&&O(s)&&O(i)?e:O(t)&&O(s)?q(function(r,a){return n(r,a,i)}):O(t)&&O(i)?q(function(r,a){return n(r,s,a)}):O(s)&&O(i)?q(function(r,a){return n(t,r,a)}):O(t)?Q(function(r){return n(r,s,i)}):O(s)?Q(function(r){return n(t,r,i)}):O(i)?Q(function(r){return n(t,s,r)}):n(t,s,i)}}}function _e(n,e){return Object.prototype.hasOwnProperty.call(e,n)}var gs=Q(function(e){return e===null?"Null":e===void 0?"Undefined":Object.prototype.toString.call(e).slice(8,-1)});function It(n){return Object.prototype.toString.call(n)==="[object Object]"}const hs=Number.isInteger||function(e){return e<<0===e};function fs(n){return Object.prototype.toString.call(n)==="[object String]"}function ps(n,e){var t=n<0?e.length+n:n;return fs(e)?e.charAt(t):e[t]}function vs(n){return new RegExp(n.source,n.flags?n.flags:(n.global?"g":"")+(n.ignoreCase?"i":"")+(n.multiline?"m":"")+(n.sticky?"y":"")+(n.unicode?"u":"")+(n.dotAll?"s":""))}function sn(n,e,t){if(t||(t=new ms),Es(n))return n;var s=function(r){var a=t.get(n);if(a)return a;t.set(n,r);for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(r[l]=sn(n[l],!0,t));return r};switch(gs(n)){case"Object":return s(Object.create(Object.getPrototypeOf(n)));case"Array":return s(Array(n.length));case"Date":return new Date(n.valueOf());case"RegExp":return vs(n);case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":return n.slice();default:return n}}function Es(n){var e=typeof n;return n==null||e!="object"&&e!="function"}var ms=function(){function n(){this.map={},this.length=0}return n.prototype.set=function(e,t){var s=this.hash(e),i=this.map[s];i||(this.map[s]=i=[]),i.push([e,t]),this.length+=1},n.prototype.hash=function(e){var t=[];for(var s in e)t.push(Object.prototype.toString.call(e[s]));return t.join()},n.prototype.get=function(e){if(this.length<=180){for(var t in this.map)for(var a=this.map[t],s=0;s<a.length;s+=1){var i=a[s];if(i[0]===e)return i[1]}return}var r=this.hash(e),a=this.map[r];if(a)for(var s=0;s<a.length;s+=1){var i=a[s];if(i[0]===e)return i[1]}},n}(),R=Q(function(e){return e!=null&&typeof e.clone=="function"?e.clone():sn(e)});function ys(n,e){for(var t=e,s=0;s<n.length;s+=1){if(t==null)return;var i=n[s];hs(i)?t=ps(i,t):t=t[i]}return t}var bs=Et(function(e,t,s){var i={},r;t=t||{},s=s||{};for(r in t)_e(r,t)&&(i[r]=_e(r,s)?e(r,t[r],s[r]):t[r]);for(r in s)_e(r,s)&&!_e(r,i)&&(i[r]=s[r]);return i}),Ss=Et(function n(e,t,s){return bs(function(i,r,a){return It(r)&&It(a)?n(e,r,a):e(i,r,a)},t,s)}),Rs=Et(function(e,t,s){return Ss(function(i,r,a){return e(r,a)},t,s)}),Is=q(ys),rn=q(function(e,t){var s={};for(var i in t)e(t[i],i,t)&&(s[i]=t[i]);return s});const f=n=>typeof n=="function"&&!!(n.constructor&&n.call&&n.apply),N=n=>typeof n=="string",F=n=>n===null,D=n=>typeof n>"u",j=n=>F(n)||D(n),_=n=>!D(n),ue=n=>!j(n),Ts=n=>ue(n)&&n!=="",on=n=>n instanceof Error,nt=(n,e)=>{const t=e.split(".");return Is(t,n)},As=(n,e)=>!!nt(n,e),an=n=>!F(n)&&typeof n=="object"&&!Array.isArray(n),m=n=>!F(n)&&Object.prototype.toString.call(n)==="[object Object]",_s=(n,e)=>{if(!Array.isArray(n)||!Array.isArray(e))return R(e);const t=R(n);return e.forEach((s,i)=>{t[i]=Array.isArray(s)||an(s)?C(t[i],s):s}),t},C=(n,e)=>Rs(_s,n,e),Ge=n=>m(n)&&Object.keys(n).length>0,pe=n=>{const e=rn(_,n);return Object.keys(e).forEach(t=>{const s=e[t];m(s)&&(e[t]=pe(s))}),e},ee=n=>{const e=rn(ue,n);return Object.keys(e).forEach(t=>{const s=e[t];m(s)&&(e[t]=ee(s))}),e},Os=n=>n.replace(/^\s+|\s+$/gm,""),Ps=n=>n.replace(/ {2,}/g," "),Me=n=>{let e=n;if(!N(n)&&!j(n))try{e=JSON.stringify(n)}catch{e=null}return e},Cs=n=>{const e=Array.from(n,t=>String.fromCodePoint(t)).join("");return globalThis.btoa(e)},ks=n=>Cs(new TextEncoder().encode(n)),Ue=(n,e,t,s,i)=>{const r={category:n,name:e,properties:t,options:s};return f(i)&&(r.callback=i),f(s)&&(r.category=n,r.name=e,r.properties=t,delete r.options,r.callback=s),f(t)&&(r.category=n,r.name=e,delete r.properties,delete r.options,r.callback=t),f(e)&&(r.category=n,delete r.name,delete r.properties,delete r.options,r.callback=e),f(n)&&(delete r.category,delete r.name,delete r.properties,delete r.options,r.callback=n),m(n)?(delete r.name,delete r.category,r.properties=n,r.options=e):m(e)&&(delete r.name,r.properties=e,r.options=f(t)?null:t),N(n)&&!N(e)&&(delete r.category,r.name=n),_(r.category)||delete r.category,_(r.name)||delete r.name,r.properties=r.properties?R(r.properties):{},_(r.options)?r.options=R(r.options):delete r.options,r.properties=C(m(r.properties)?r.properties:{},{name:N(r.name)?r.name:null,category:N(r.category)?r.category:null}),r},mt=(n,e,t,s)=>{const i={name:n,properties:e,options:t};return f(s)&&(i.callback=s),f(t)&&(i.properties=e,delete i.options,i.callback=t),f(e)&&(delete i.properties,delete i.options,i.callback=e),i.properties=ue(i.properties)?R(i.properties):{},_(i.options)?i.options=R(i.options):delete i.options,i},ln=(n,e,t,s)=>{const i={userId:n,traits:e,options:t};return f(s)&&(i.callback=s),f(t)&&(i.userId=n,i.traits=e,delete i.options,i.callback=t),f(e)&&(i.userId=n,delete i.traits,delete i.options,i.callback=e),(m(n)||F(n))&&(i.userId=null,i.traits=n,i.options=e),_(i.userId)?i.userId=Me(i.userId):delete i.userId,m(i.traits)?i.traits=R(i.traits):delete i.traits,_(i.options)?i.options=R(i.options):delete i.options,i},cn=(n,e,t,s)=>{const i={to:n,from:e,options:t};return f(s)&&(i.callback=s),f(t)&&(i.to=n,i.from=e,delete i.options,i.callback=t),f(e)?(i.to=n,delete i.from,delete i.options,i.callback=e):(m(e)||F(e))&&(i.to=n,delete i.from,i.options=e),f(n)?(delete i.to,delete i.from,delete i.options,i.callback=n):(m(n)||F(n))&&(delete i.to,delete i.from,i.options=n),_(i.to)?i.to=Me(i.to):delete i.to,_(i.from)?i.from=Me(i.from):delete i.from,_(i.options)?i.options=R(i.options):delete i.options,i},un=(n,e,t,s)=>{const i={groupId:n,traits:e,options:t};return f(s)&&(i.callback=s),f(t)&&(i.groupId=n,i.traits=e,delete i.options,i.callback=t),f(e)&&(i.groupId=n,delete i.traits,delete i.options,i.callback=e),f(n)?(i.groupId=null,delete i.traits,delete i.options,i.callback=n):(m(n)||F(n))&&(i.groupId=null,i.traits=n,i.options=f(e)?null:e),_(i.groupId)?i.groupId=Me(i.groupId):delete i.groupId,i.traits=m(i.traits)?R(i.traits):{},_(i.options)?i.options=R(i.options):delete i.options,i},st="CapabilitiesManager",K="ConfigManager",dn="EventManager",Tt="PluginsManager",ve="UserSessionManager",Oe="ErrorHandler",ie="PluginEngine",At="StoreManager",Ns="readyApi",Ds="EventRepository",Ls="ExternalSrcLoader",ws="HttpClient",_t="RudderStackApplication",Qe="AnalyticsCore",Ot="RudderLabs JavaScript SDK",ye="3.5.2",Ms="com.rudderlabs.javascript",gn="npm",Pt="RudderJS-Initiated",Us="ad-block page request",Bs="/ad-blocked",it="preloadedEventsBuffer",$s="Consent Management Interaction",xs="ajs_trait_",Gs="ajs_prop_",Ct="ajs_aid",kt="ajs_uid",Nt="ajs_event",Fs=10*1e3,js=31536e3*1e3,be=30*60*1e3,Dt=10*1e3,Hs=10*1e3,Vs=250,hn=(n="app")=>{globalThis.RudderStackGlobals||(globalThis.RudderStackGlobals={}),globalThis.RudderStackGlobals[n]||(globalThis.RudderStackGlobals[n]={})},Fe=(n,e,t="app")=>{hn(t),globalThis.RudderStackGlobals[t][n]=e},Ks=(n,e="app")=>(hn(e),globalThis.RudderStackGlobals[e][n]);function Qs(n,e,t=Vs){let s;return(...i)=>{globalThis.clearTimeout(s),s=globalThis.setTimeout(()=>{n.apply(e,i)},t)}}const Lt=(n,e)=>{const t={};return n.forEach((s,i)=>{if(i.startsWith(e)){const r=i.substring(e.length);t[r]=n.get(i)}}),t},zs=(n=[])=>{const e={trait:xs,properties:Gs},t=new URLSearchParams(globalThis.location.search);t.get(Nt)&&n.unshift(["track",t.get(Nt),Lt(t,e.properties)]),t.get(kt)&&n.unshift(["identify",t.get(kt),Lt(t,e.trait)]),t.get(Ct)&&n.unshift(["setAnonymousId",t.get(Ct)])},qs=n=>{const e="load";let t=[],s=0;for(;s<n.length;){if(n[s]&&n[s][0]===e){t=R(n[s]),n.splice(s,1);break}s+=1}return t},Ws=n=>{const e="consent",t=n.filter(i=>i[0]===e),s=n.filter(i=>i[0]!==e);n.splice(0,n.length,...t,...s)},Ys=n=>{const e=Ks(it)||[];zs(e),e.length>0&&(n.enqueuePreloadBufferEvents(e),Fe(it,[]))},Xs=(n,e)=>{const t=n.shift();let s;if(f(e[t])){switch(t){case"page":s=Ue(...n);break;case"track":s=mt(...n);break;case"identify":s=ln(...n);break;case"alias":s=cn(...n);break;case"group":s=un(...n);break;default:e[t](...n);break}s&&e[t](s)}},Js=10*1e3,y=":: ",Zs=n=>`A script with the id "${n}" is already loaded. Skipping the loading of this script to prevent conflicts.`,wt=(n,e)=>`Failed to load the script with the id "${n}" from URL "${e}".`,ei=(n,e,t)=>`A timeout of ${t} ms occurred while trying to load the script with id "${n}" from URL "${e}".`,ti=(n,e)=>`${n}${y}A circular reference has been detected in the object and the property "${e}" has been dropped from the output.`,ni="Failed to convert the value to a JSON string.",si="JSONStringify",ii=(n,e,t)=>{const s=[];return function(i,r){if(!(e!=null&&e.includes(i))&&!(n&&j(r))){if(typeof r!="object"||F(r))return r;for(;s.length>0&&s[s.length-1]!==this;)s.pop();return s.includes(r)?(t==null||t.warn(ti(si,i)),"[Circular Reference]"):(s.push(r),r)}}},Y=(n,e,t,s)=>{try{return JSON.stringify(n,ii(e,t,s))}catch(i){return s==null||s.warn(ni,i),null}},Re=(n,e)=>{let t=n;return on(n)?t.message=`${e}: ${n.message}`:t=new Error(`${e}: ${Y(n)}`),t},ri="RS_JS_SDK",oi=(n,e,t=!0,s=null,i=null,r={})=>{const a=document.createElement("script");return a.type="text/javascript",a.onload=s,a.onerror=i,a.src=n,a.id=e,a.async=t,Object.keys(r).forEach(l=>{a.setAttribute(l,r[l])}),a.setAttribute("data-loader",ri),a},ai=n=>{var r,a,l,c;const e=document.getElementsByTagName("head");if(e.length>0){(a=e[0])==null||a.insertBefore(n,(r=e[0])==null?void 0:r.firstChild);return}const t=document.getElementsByTagName("script");if(t.length>0&&((l=t[0])!=null&&l.parentNode)){(c=t[0])==null||c.parentNode.insertBefore(n,t[0]);return}const s=document.createElement("head");s.appendChild(n);const i=document.getElementsByTagName("html")[0];i==null||i.insertBefore(s,i.firstChild)},li=(n,e,t,s=!0,i)=>new Promise((r,a)=>{document.getElementById(e)&&a(new Error(Zs(e)));try{let c;ai(oi(n,e,s,()=>{globalThis.clearTimeout(c),r(e)},()=>{globalThis.clearTimeout(c),a(new Error(wt(e,n)))},i)),c=globalThis.setTimeout(()=>{a(new Error(ei(e,n,t)))},t)}catch(c){a(Re(c,wt(e,n)))}});class fn{constructor(e,t,s=Js){S(this,"hasErrorHandler",!1);this.errorHandler=e,this.logger=t,this.timeout=s,this.hasErrorHandler=!!this.errorHandler,this.onError=this.onError.bind(this)}loadJSFile(e){const{url:t,id:s,timeout:i,async:r,callback:a,extraAttributes:l}=e,c=!f(a);li(t,s,i||this.timeout,r,l).then(u=>{c||a(u)}).catch(u=>{this.onError(u),c||a()})}onError(e){var t;if(this.hasErrorHandler)(t=this.errorHandler)==null||t.onError(e,Ls);else throw e}}var ci=Symbol.for("preact-signals");function je(){if(J>1)J--;else{for(var n,e=!1;me!==void 0;){var t=me;for(me=void 0,rt++;t!==void 0;){var s=t.o;if(t.o=void 0,t.f&=-3,!(8&t.f)&&vn(t))try{t.c()}catch(i){e||(n=i,e=!0)}t=s}}if(rt=0,J--,e)throw n}}function M(n){if(J>0)return n();J++;try{return n()}finally{je()}}var T=void 0,me=void 0,J=0,rt=0,Be=0;function pn(n){if(T!==void 0){var e=n.n;if(e===void 0||e.t!==T)return e={i:0,S:n,p:T.s,n:void 0,t:T,e:void 0,x:void 0,r:e},T.s!==void 0&&(T.s.n=e),T.s=e,n.n=e,32&T.f&&n.S(e),e;if(e.i===-1)return e.i=0,e.n!==void 0&&(e.n.p=e.p,e.p!==void 0&&(e.p.n=e.n),e.p=T.s,e.n=void 0,T.s.n=e,T.s=e),e}}function U(n){this.v=n,this.i=0,this.n=void 0,this.t=void 0}U.prototype.brand=ci;U.prototype.h=function(){return!0};U.prototype.S=function(n){this.t!==n&&n.e===void 0&&(n.x=this.t,this.t!==void 0&&(this.t.e=n),this.t=n)};U.prototype.U=function(n){if(this.t!==void 0){var e=n.e,t=n.x;e!==void 0&&(e.x=t,n.e=void 0),t!==void 0&&(t.e=e,n.x=void 0),n===this.t&&(this.t=t)}};U.prototype.subscribe=function(n){var e=this;return z(function(){var t=e.value,s=T;T=void 0;try{n(t)}finally{T=s}})};U.prototype.valueOf=function(){return this.value};U.prototype.toString=function(){return this.value+""};U.prototype.toJSON=function(){return this.value};U.prototype.peek=function(){var n=T;T=void 0;try{return this.value}finally{T=n}};Object.defineProperty(U.prototype,"value",{get:function(){var n=pn(this);return n!==void 0&&(n.i=this.i),this.v},set:function(n){if(n!==this.v){if(rt>100)throw new Error("Cycle detected");this.v=n,this.i++,Be++,J++;try{for(var e=this.t;e!==void 0;e=e.x)e.t.N()}finally{je()}}}});function d(n){return new U(n)}function vn(n){for(var e=n.s;e!==void 0;e=e.n)if(e.S.i!==e.i||!e.S.h()||e.S.i!==e.i)return!0;return!1}function En(n){for(var e=n.s;e!==void 0;e=e.n){var t=e.S.n;if(t!==void 0&&(e.r=t),e.S.n=e,e.i=-1,e.n===void 0){n.s=e;break}}}function mn(n){for(var e=n.s,t=void 0;e!==void 0;){var s=e.p;e.i===-1?(e.S.U(e),s!==void 0&&(s.n=e.n),e.n!==void 0&&(e.n.p=s)):t=e,e.S.n=e.r,e.r!==void 0&&(e.r=void 0),e=s}n.s=t}function Ie(n){U.call(this,void 0),this.x=n,this.s=void 0,this.g=Be-1,this.f=4}(Ie.prototype=new U).h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===Be))return!0;if(this.g=Be,this.f|=1,this.i>0&&!vn(this))return this.f&=-2,!0;var n=T;try{En(this),T=this;var e=this.x();(16&this.f||this.v!==e||this.i===0)&&(this.v=e,this.f&=-17,this.i++)}catch(t){this.v=t,this.f|=16,this.i++}return T=n,mn(this),this.f&=-2,!0};Ie.prototype.S=function(n){if(this.t===void 0){this.f|=36;for(var e=this.s;e!==void 0;e=e.n)e.S.S(e)}U.prototype.S.call(this,n)};Ie.prototype.U=function(n){if(this.t!==void 0&&(U.prototype.U.call(this,n),this.t===void 0)){this.f&=-33;for(var e=this.s;e!==void 0;e=e.n)e.S.U(e)}};Ie.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var n=this.t;n!==void 0;n=n.x)n.t.N()}};Object.defineProperty(Ie.prototype,"value",{get:function(){if(1&this.f)throw new Error("Cycle detected");var n=pn(this);if(this.h(),n!==void 0&&(n.i=this.i),16&this.f)throw this.v;return this.v}});function yn(n){var e=n.u;if(n.u=void 0,typeof e=="function"){J++;var t=T;T=void 0;try{e()}catch(s){throw n.f&=-2,n.f|=8,yt(n),s}finally{T=t,je()}}}function yt(n){for(var e=n.s;e!==void 0;e=e.n)e.S.U(e);n.x=void 0,n.s=void 0,yn(n)}function ui(n){if(T!==this)throw new Error("Out-of-order effect");mn(this),T=n,this.f&=-2,8&this.f&&yt(this),je()}function Te(n){this.x=n,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32}Te.prototype.c=function(){var n=this.S();try{if(8&this.f||this.x===void 0)return;var e=this.x();typeof e=="function"&&(this.u=e)}finally{n()}};Te.prototype.S=function(){if(1&this.f)throw new Error("Cycle detected");this.f|=1,this.f&=-9,yn(this),En(this),J++;var n=T;return T=this,ui.bind(this,n)};Te.prototype.N=function(){2&this.f||(this.f|=2,this.o=me,me=this)};Te.prototype.d=function(){this.f|=8,1&this.f||yt(this)};function z(n){var e=new Te(n);try{e.c()}catch(t){throw e.d(),t}return e.d.bind(e)}class bn{constructor(){this.items=[]}enqueue(e){this.items.push(e)}dequeue(){return this.items.length===0?null:this.items.shift()}isEmpty(){return this.items.length===0}size(){return this.items.length}clear(){this.items=[]}}const Pe={LOG:0,INFO:1,DEBUG:2,WARN:3,ERROR:4,NONE:5},Mt="ERROR",di="RS SDK",gi="font-weight: bold; background: black; color: white;",hi="font-weight: normal;";class fi{constructor(e=Mt,t="",s=console){this.minLogLevel=Pe[e],this.scope=t,this.logProvider=s}log(...e){this.outputLog("LOG",e)}info(...e){this.outputLog("INFO",e)}debug(...e){this.outputLog("DEBUG",e)}warn(...e){this.outputLog("WARN",e)}error(...e){this.outputLog("ERROR",e)}outputLog(e,t){var s,i;this.minLogLevel<=Pe[e]&&((i=(s=this.logProvider)[e.toLowerCase()])==null||i.call(s,...this.formatLogData(t)))}setScope(e){this.scope=e||this.scope}setMinLogLevel(e){this.minLogLevel=Pe[e],D(this.minLogLevel)&&(this.minLogLevel=Pe[Mt])}formatLogData(e){if(Array.isArray(e)&&e.length>0){let t=`%c ${di}`;this.scope&&(t=`${t} - ${this.scope}`);const s=N(e[0])?e[0].trim():"";t=`${t} %c ${s}`;const i=[t,gi,hi];return N(e[0])||i.push(e[0]),i.push(...e.slice(1)),i}return e}}const H=new fi,Sn=["localStorage","memoryStorage","cookieStorage","sessionStorage","none"],ot="cookieStorage",pi='"getSourceConfig" must be a function. Please make sure that it is defined and returns a valid source configuration object.',Ut="Unable to process/parse source configuration response.",vi="The source is disabled. Please enable the source in the dashboard to send events.",Ei="Failed to prepare data for the request.",mi="Failed to generate the event object.",yi="Failed to invoke plugin because the extension point name is missing.",bi="Failed to invoke plugin because the extension point name is invalid.",Si=n=>`Failed to load the SDK as the base URL for ${n} is not valid.`,Ri=(n,e,t)=>`${n}${y}The consent manager "${e}" is not supported. Please choose one of the following supported consent managers: "${Object.keys(t)}".`,Ii=n=>`${n}${y}Failed to initialize the error reporting plugin.`,Ti=n=>`${n}${y}Failed to notify the error.`,Ai=n=>`${n}${y}Plugin name is missing.`,_i=(n,e)=>`${n}${y}Plugin "${e}" already exists.`,Oi=(n,e)=>`${n}${y}Plugin "${e}" not found.`,Pi=(n,e)=>`${n}${y}Plugin "${e}" not found in plugins but found in byName. This indicates a bug in the plugin engine. Please report this issue to the development team.`,Ci=(n,e,t)=>`${n}${y}Plugin "${e}" could not be loaded because some of its dependencies "${t}" do not exist.`,ki=(n,e,t)=>`${n}${y}Failed to invoke the "${e}" extension point of plugin "${t}".`,Ni=(n,e)=>`${n}${y}The "${e}" storage type is `,Di=n=>`Failed to fetch the source config. Reason: ${n}`,Li=n=>`The write key "${n}" is invalid. It must be a non-empty string. Please check that the write key is correct and try again.`,wi=n=>`The data plane URL "${n}" is invalid. It must be a valid URL string. Please check that the data plane URL is correct and try again.`,Mi=n=>`${n}${y}The callback is not a function.`,Ui=(n,e,t,s)=>`${n} with status: ${e}, ${t} for URL: ${s}.`,Bi=(n,e,t)=>`${n} due to timeout or no connection (${e?e.type:""}) for URL: ${t}.`,$i=(n,e)=>`${n} for URL: ${e}`,xi=n=>`Failed to save the value for "${n}" to storage`,Gi=n=>`Failed to retrieve or parse data for "${n}" from storage`,Fi=n=>`The server responded with status ${n} while setting the cookies. As a fallback, the cookies will be set client side.`,ji=n=>`The server failed to set the ${n} cookie. As a fallback, the cookies will be set client side.`,Hi="Failed to set/remove cookies via server. As a fallback, the cookies will be managed client side.",Vi=(n,e,t)=>`${n}${y}The storage type "${e}" is not supported. Please choose one of the following supported types: "${Sn}". The default type "${t}" will be used instead.`,Ki=(n,e,t,s)=>`${n}${y}The error reporting provider "${e}" is not supported. Please choose one of the following supported providers: "${Object.keys(t)}". The default provider "${s}" will be used instead.`,Qi=(n,e,t,s)=>`${n}${y}The storage encryption version "${e}" is not supported. Please choose one of the following supported versions: "${Object.keys(t)}". The default version "${s}" will be used instead.`,zi=(n,e,t)=>`${n}${y}The storage data migration has been disabled because the configured storage encryption version (${e}) is not the latest (${t}). To enable storage data migration, please update the storage encryption version to the latest version.`,qi=(n,e,t,s)=>`${n}${y}The "${e}" property defined under "${t}" is a reserved keyword. Please choose a different property name to avoid conflicts with reserved keywords (${s}).`,Wi=n=>`${n}${y}The Beacon API is not supported by your browser. The events will be sent using XHR instead.`,Yi=(n,e,t)=>`${n}${y}The session timeout value "${e}" is not a number. The default timeout of ${t} ms will be used instead.`,Xi=n=>`${n}${y}The session timeout value is 0, which disables the automatic session tracking feature. If you want to enable session tracking, please provide a positive integer value for the timeout.`,Ji=(n,e,t)=>`${n}${y}The session timeout value ${e} ms is less than the recommended minimum of ${t} ms. Please consider increasing the timeout value to ensure optimal performance and reliability.`,Zi=(n,e,t)=>`${n}${y}The provided session ID (${e}) is either invalid, not a positive integer, or not at least "${t}" digits long. A new session ID will be auto-generated instead.`,er=n=>`${n}${y}The storage is either full or unavailable, so the data will not be persisted. Switching to in-memory storage.`,tr=(n,e,t,s)=>`${n}${y}The storage type "${t}" is not available for entry "${e}". The SDK will initialize the entry with "${s}" storage type instead.`,nr=(n,e)=>`${n}${y}The write key "${e}" is not a string. Please check that the write key is correct and try again.`,sr=n=>`${n}${y}The group() method must be called with at least one argument.`,Bt="Failed to invoke the ready callback",ir="API Callback Invocation Failed",rr="NativeDestinationQueuePlugin initialization failed",or="XhrQueuePlugin initialization failed",ar="DeviceModeTransformationPlugin initialization failed",lr="NativeDestinationQueuePlugin event enqueue failed",cr="XhrQueuePlugin event enqueue failed",ur=(n,e)=>`${n}${y}The provided source config URL "${e}" is invalid. Using the default source config URL instead.`,dr=(n,e)=>`Failed to load the polyfill script with ID "${n}" from URL ${e}.`,gr=(n,e,t)=>`${n}${y}The pre-consent storage strategy "${e}" is not supported. Please choose one of the following supported strategies: "none, session, anonymousId". The default strategy "${t}" will be used instead.`,hr=(n,e,t)=>`${n}${y}The pre-consent events delivery type "${e}" is not supported. Please choose one of the following supported types: "immediate, buffer". The default type "${t}" will be used instead.`,fr=(n,e,t,s)=>{const i=t.length===1,r=i?` '${t[0]}' plugin was`:` ['${t.join("', '")}'] plugins were`,a=`${n}${y}${e}, but${r} not configured to load.`;return s?`${a} So, ${i?"the plugin":"those plugins"} will be loaded automatically.`:`${a} Ignore if this was intentional. Otherwise, consider adding ${i?"it":"them"} to the 'plugins' load API option.`},pr=(n,e)=>`${n}${y}The provided polyfill URL "${e}" is invalid. The default polyfill URL will be used instead.`,Rn="js-integrations",In="plugins",vr=new RegExp("^(https?:\\/\\/)(((([a-zA-Z\\d]([a-zA-Z\\d-]*[a-zA-Z\\d])*)\\.)+[a-zA-Z]{2,}|localhost|((25[0-5]|2[0-4][0-9]|[0-1]?[0-9]?[0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[0-1]?[0-9]?[0-9]?)))(\\:\\d+)?(\\/[-a-zA-Z\\d%_.~+]*)*(\\?[;&a-zA-Z\\d%_.~+=-]*)?(\\#[-a-zA-Z\\d_]*)?$"),Se="modern",Tn="https://cdn.rudderlabs.com",bt="v3",An=`${Tn}/${bt}/${Se}/${Rn}`,_n=`${Tn}/${bt}/${Se}/${In}`,On="https://api.rudderstack.com",at="bugsnag",te="v3",Er="xhr",lt={oneTrust:"OneTrustConsentManager",ketch:"KetchConsentManager",custom:"CustomConsentManager"},ke={[at]:"Bugsnag"},Ne={[te]:"StorageEncryption",legacy:"StorageEncryptionLegacy"},mr={[Er]:"XhrQueue",beacon:"BeaconQueue"},yr="rsaRequest",br={logLevel:"ERROR",configUrl:On,loadIntegration:!0,sessions:{autoTrack:!0,timeout:be},sameSiteCookie:"Lax",polyfillIfRequired:!0,integrations:{All:!0},useBeacon:!1,beaconQueueOptions:{},destinationsQueueOptions:{},queueOptions:{},lockIntegrationsVersion:!1,lockPluginsVersion:!1,uaChTrackLevel:"none",plugins:[],useGlobalIntegrationsConfigInEvents:!1,bufferDataPlaneEventsUntilReady:!1,dataPlaneEventsBufferTimeout:Hs,storage:{encryption:{version:te},migrate:!0},sendAdblockPageOptions:{},useServerSideCookies:!1},Sr=d(R(br)),I={userId:"",userTraits:{},anonymousId:"",groupId:"",groupTraits:{},initialReferrer:"",initialReferringDomain:"",sessionInfo:{},authToken:null},Rr=10,Ir={autoTrack:!0,timeout:be},Tr={userId:d(I.userId),userTraits:d(I.userTraits),anonymousId:d(I.anonymousId),groupId:d(I.groupId),groupTraits:d(I.groupTraits),initialReferrer:d(I.initialReferrer),initialReferringDomain:d(I.initialReferringDomain),sessionInfo:d(I.sessionInfo),authToken:d(I.authToken)},Ar={isOnline:d(!0),storage:{isLocalStorageAvailable:d(!1),isCookieStorageAvailable:d(!1),isSessionStorageAvailable:d(!1)},isBeaconAvailable:d(!1),isLegacyDOM:d(!1),isUaCHAvailable:d(!1),isCryptoAvailable:d(!1),isIE11:d(!1),isAdBlocked:d(!1)},_r={isErrorReportingEnabled:d(!1),isMetricsReportingEnabled:d(!1),errorReportingProviderPluginName:d(void 0),isErrorReportingPluginLoaded:d(!1)},Or=d(void 0),Pr={activeDataplaneUrl:d(void 0),integrationsCDNPath:d(An),pluginsCDNPath:d(_n),sourceConfigUrl:d(void 0),status:d(void 0),initialized:d(!1),logLevel:d("ERROR"),loaded:d(!1),readyCallbacks:d([]),writeKey:d(void 0),dataPlaneUrl:d(void 0)},Cr={enabled:d(!1),initialized:d(!1),data:d({}),activeConsentManagerPluginName:d(void 0),preConsent:d({enabled:!1}),postConsent:d({}),resolutionStrategy:d("and"),provider:d(void 0),metadata:d(void 0)},kr={retries:d(0),dropped:d(0),sent:d(0),queued:d(0),triggered:d(0)},Nr={app:d({name:Ot,namespace:Ms,version:ye,installType:gn}),traits:d(null),library:d({name:Ot,version:ye,snippetVersion:globalThis.RudderSnippetVersion}),userAgent:d(""),device:d(null),network:d(null),os:d({name:"",version:""}),locale:d(null),screen:d({density:0,width:0,height:0,innerWidth:0,innerHeight:0}),"ua-ch":d(void 0),timezone:d(void 0)},Dr={configuredDestinations:d([]),activeDestinations:d([]),loadOnlyIntegrations:d({}),failedDestinations:d([]),loadIntegration:d(!0),initializedDestinations:d([]),clientDestinationsReady:d(!1),integrationsConfig:d({})},Lr={toBeProcessedArray:d([]),readyCallbacksArray:d([])},wr={ready:d(!1),loadedPlugins:d([]),failedPlugins:d([]),pluginsToLoadFromConfig:d([]),activePlugins:d([]),totalPluginsToLoad:d(0)},Mr={encryptionPluginName:d(void 0),migrate:d(!1),type:d(void 0),cookie:d(void 0),entries:d({}),trulyAnonymousTracking:d(!1)},Ur={isEnabledServerSideCookies:d(!1),dataServiceUrl:d(void 0)},Br={eventsQueuePluginName:d(void 0),deliveryEnabled:d(!0)},$r={capabilities:Ar,consents:Cr,context:Nr,eventBuffer:Lr,lifecycle:Pr,loadOptions:Sr,metrics:kr,nativeDestinations:Dr,plugins:wr,reporting:_r,session:Tr,source:Or,storage:Mr,serverCookies:Ur,dataPlaneEvents:Br},o={...R($r)};class xr{constructor(e={},t){S(this,"plugins",[]);S(this,"byName",{});S(this,"cache",{});S(this,"config",{throws:!0});this.config={throws:!0,...e},this.logger=t}register(e,t){var i,r;if(!e.name){const a=Ai(ie);if(this.config.throws)throw new Error(a);(i=this.logger)==null||i.error(a,e)}if(this.byName[e.name]){const a=_i(ie,e.name);if(this.config.throws)throw new Error(a);(r=this.logger)==null||r.error(a)}this.cache={},this.plugins=this.plugins.slice();let s=this.plugins.length;this.plugins.forEach((a,l)=>{var c;(c=a.deps)!=null&&c.includes(e.name)&&(s=Math.min(s,l))}),this.plugins.splice(s,0,e),this.byName[e.name]=e,f(e.initialize)&&e.initialize(t)}unregister(e){var i,r;const t=this.byName[e];if(!t){const a=Oi(ie,e);if(this.config.throws)throw new Error(a);(i=this.logger)==null||i.error(a)}const s=this.plugins.indexOf(t);if(s===-1){const a=Pi(ie,e);if(this.config.throws)throw new Error(a);(r=this.logger)==null||r.error(a)}this.cache={},delete this.byName[e],this.plugins=this.plugins.slice(),this.plugins.splice(s,1)}getPlugin(e){return this.byName[e]}getPlugins(e){const t=e??".";return this.cache[t]||(this.cache[t]=this.plugins.filter(s=>{var i,r;if((i=s.deps)!=null&&i.some(a=>!this.byName[a])){const a=s.deps.filter(l=>!this.byName[l]);return(r=this.logger)==null||r.error(Ci(ie,s.name,a)),!1}return t==="."?!0:As(s,t)})),this.cache[t]}processRawPlugins(e){e(this.plugins),this.cache={}}invoke(e,t=!0,...s){let i=e;if(!i)throw new Error(yi);const r=i.startsWith("!"),a=this.config.throws??i.endsWith("!");if(i=i.replace(/(^!|!$)/g,""),!i)throw new Error(bi);const l=i.split(".");l.pop();const c=l.join(".");return(t?this.getPlugins(i):[this.getPlugins(i)[0]]).map(h=>{var A;const v=nt(h,i);if(!f(v)||r)return v;try{return v.apply(nt(h,c),s)}catch(g){if(a)throw g;(A=this.logger)==null||A.error(ki(ie,i,h.name),g)}return null})}invokeSingle(e,...t){return this.invoke(e,!1,...t)[0]}invokeMultiple(e,...t){return this.invoke(e,!0,...t)}}const Pn=new xr({throws:!0},H),De="The request failed",Gr=[De],Fr="RS_JS_SDK",jr=n=>{let e;try{if(N(n))e=n;else if(n instanceof Error)e=n.message;else if(n instanceof ErrorEvent)e=n.message;else if(n instanceof Event){const t=n.target;if(t&&t.localName!=="script"||t!=null&&t.dataset&&(t.dataset.loader!==Fr||t.dataset.isnonnativesdk!=="true"))return"";e=`Error in loading a third-party script from URL ${t==null?void 0:t.src} with ID ${t==null?void 0:t.id}.`}else e=n.message?n.message:Y(n)}catch(t){e=`Unknown error: ${t.message}`}return e},Hr=n=>n.message?!Gr.some(e=>n.message.includes(e)):!0;class Vr{constructor(e,t){this.logger=e,this.pluginEngine=t,this.errorBuffer=new bn,this.attachEffect()}attachEffect(){if(o.reporting.isErrorReportingPluginLoaded.value===!0)for(;this.errorBuffer.size()>0;)this.errorBuffer.dequeue()}attachErrorListeners(){var e;"addEventListener"in globalThis?(globalThis.addEventListener("error",t=>{this.onError(t,void 0,void 0,void 0,"unhandledException")}),globalThis.addEventListener("unhandledrejection",t=>{this.onError(t,void 0,void 0,void 0,"unhandledPromiseRejection")})):(e=this.logger)==null||e.debug("Failed to attach global error listeners.")}init(e){if(this.pluginEngine)try{const t="errorReporting.init",s=this.pluginEngine.invokeSingle(t,o,this.pluginEngine,e,this.logger);s instanceof Promise&&s.then(i=>{this.errReportingClient=i}).catch(i=>{var r;(r=this.logger)==null||r.error(Ii(Oe),i)})}catch(t){this.onError(t,Oe)}}onError(e,t="",s="",i=!1,r="handled"){let a=jr(e);if(!a)return;a=Ps(`${t}${y}${s} ${a}`);let l=new Error(a);if(on(e)&&(l=Object.create(e,{message:{value:a}})),r==="handled")if(this.notifyError(l),this.logger){if(this.logger.error(a),i)throw l}else throw l;o.reporting.isErrorReportingEnabled.value&&o.reporting.isErrorReportingPluginLoaded.value}leaveBreadcrumb(e){if(this.pluginEngine)try{this.pluginEngine.invokeSingle("errorReporting.breadcrumb",this.pluginEngine,this.errReportingClient,e,this.logger)}catch(t){this.onError(t,Oe,"errorReporting.breadcrumb")}}notifyError(e){var t,s;if(this.errReportingClient&&Hr(e))try{(t=this.pluginEngine)==null||t.invokeSingle("errorReporting.notify",this.pluginEngine,this.errReportingClient,e,o,this.logger)}catch(i){(s=this.logger)==null||s.error(Ti(Oe),i)}}}const He=new Vr(H,Pn),Kr=n=>n.config.connectionMode!=="cloud"||n.config.useNativeSDKToSend===!0||n.config.useNativeSDK===!0,Qr=n=>n.config.connectionMode==="hybrid"||n.config.useNativeSDKToSend===!0,$t=n=>n.filter(Kr),Cn=["BeaconQueue","Bugsnag","CustomConsentManager","DeviceModeDestinations","DeviceModeTransformation","ErrorReporting","ExternalAnonymousId","GoogleLinker","KetchConsentManager","NativeDestinationQueue","OneTrustConsentManager","StorageEncryption","StorageEncryptionLegacy","StorageMigrator","XhrQueue"],zr={rudderAnalyticsRemotePlugins:{url:()=>Promise.resolve(window.RudderStackGlobals&&window.RudderStackGlobals.app&&window.RudderStackGlobals.app.pluginsCDNPath?""+window.RudderStackGlobals.app.pluginsCDNPath+"/rsa-plugins.js":"https://cdn.rudderlabs.com/v3/modern/plugins/rsa-plugins.js"),format:"esm",from:"vite"}},qr=async(n,e)=>{const t=typeof n=="function"?await n():n,s=document.createElement("script");s.type="text/javascript",s.onload=e,s.src=t,document.getElementsByTagName("head")[0].appendChild(s)};function kn(n,e){const t=Object.assign(n,e);for(const s of Object.keys(t))typeof t[s]=="object"&&typeof e[s]=="object"&&(t[s]=kn(t[s],e[s]));return t}const xt=n=>kn({},(globalThis.__federation_shared__||{}).default||{});async function Wr(n){const e=zr[n];if(e.inited)return e.lib;if(e.format==="var")return new Promise(t=>{const s=()=>{e.inited||(e.lib=window[n],e.lib.init(xt(e.from)),e.inited=!0),t(e.lib)};return qr(e.url,s)});if(["esm","systemjs"].includes(e.format))return new Promise((t,s)=>{(typeof e.url=="function"?e.url:()=>Promise.resolve(e.url))().then(r=>{ds(()=>import(r),[]).then(a=>{if(!e.inited){const l=xt(e.from);a.init(l),e.lib=a,e.lib.init(l),e.inited=!0}t(e.lib)}).catch(s)})})}function L(n,e){if(!(n!=null&&n.default)&&e){let t=Object.create(null);return t.default=n,t.__esModule=!0,t}return n}function w(n,e){return Wr(n).then(t=>t.get(e).then(s=>s()))}const Yr=n=>{switch(n){case"BeaconQueue":return()=>w("rudderAnalyticsRemotePlugins","./BeaconQueue").then(e=>L(e,!0));case"Bugsnag":return()=>w("rudderAnalyticsRemotePlugins","./Bugsnag").then(e=>L(e,!0));case"CustomConsentManager":return()=>w("rudderAnalyticsRemotePlugins","./CustomConsentManager").then(e=>L(e,!0));case"DeviceModeDestinations":return()=>w("rudderAnalyticsRemotePlugins","./DeviceModeDestinations").then(e=>L(e,!0));case"DeviceModeTransformation":return()=>w("rudderAnalyticsRemotePlugins","./DeviceModeTransformation").then(e=>L(e,!0));case"ErrorReporting":return()=>w("rudderAnalyticsRemotePlugins","./ErrorReporting").then(e=>L(e,!0));case"ExternalAnonymousId":return()=>w("rudderAnalyticsRemotePlugins","./ExternalAnonymousId").then(e=>L(e,!0));case"GoogleLinker":return()=>w("rudderAnalyticsRemotePlugins","./GoogleLinker").then(e=>L(e,!0));case"KetchConsentManager":return()=>w("rudderAnalyticsRemotePlugins","./KetchConsentManager").then(e=>L(e,!0));case"NativeDestinationQueue":return()=>w("rudderAnalyticsRemotePlugins","./NativeDestinationQueue").then(e=>L(e,!0));case"OneTrustConsentManager":return()=>w("rudderAnalyticsRemotePlugins","./OneTrustConsentManager").then(e=>L(e,!0));case"StorageEncryption":return()=>w("rudderAnalyticsRemotePlugins","./StorageEncryption").then(e=>L(e,!0));case"StorageEncryptionLegacy":return()=>w("rudderAnalyticsRemotePlugins","./StorageEncryptionLegacy").then(e=>L(e,!0));case"StorageMigrator":return()=>w("rudderAnalyticsRemotePlugins","./StorageMigrator").then(e=>L(e,!0));case"XhrQueue":return()=>w("rudderAnalyticsRemotePlugins","./XhrQueue").then(e=>L(e,!0));default:return}},ze=n=>{const e={};return n.forEach(t=>{if(Cn.includes(t)){const s=Yr(t);s&&(e[t]=s)}}),e},ct=()=>({}),Xr=()=>({}),Jr=n=>(ze==null?void 0:ze(n))||{},qe={...ct(),...Xr()},Zr=n=>({...Jr(n)});class eo{constructor(e,t,s){this.engine=e,this.errorHandler=t,this.logger=s,this.onError=this.onError.bind(this)}init(){o.lifecycle.status.value="pluginsLoading",Fe("pluginsCDNPath",o.lifecycle.pluginsCDNPath.value),this.setActivePlugins(),this.registerLocalPlugins(),this.registerRemotePlugins(),this.attachEffects()}attachEffects(){z(()=>{(o.plugins.activePlugins.value.length===0||o.plugins.loadedPlugins.value.length+o.plugins.failedPlugins.value.length===o.plugins.totalPluginsToLoad.value)&&M(()=>{o.plugins.ready.value=!0,o.lifecycle.status.value="pluginsReady"})})}getPluginsToLoadBasedOnConfig(){let e=o.plugins.pluginsToLoadFromConfig.value;if(!e)return[];const t=[{configurationStatus:()=>_(o.dataPlaneEvents.eventsQueuePluginName.value),configurationStatusStr:"Data plane events delivery is enabled",activePluginName:o.dataPlaneEvents.eventsQueuePluginName.value,supportedPlugins:Object.values(mr),shouldAddMissingPlugins:!0},{configurationStatus:()=>_(o.reporting.errorReportingProviderPluginName.value),configurationStatusStr:"Error reporting is enabled",activePluginName:o.reporting.errorReportingProviderPluginName.value,basePlugins:["ErrorReporting"],supportedPlugins:Object.values(ke)},{configurationStatus:()=>$t(o.nativeDestinations.configuredDestinations.value).length>0,configurationStatusStr:"Device mode destinations are connected to the source",supportedPlugins:["DeviceModeDestinations","NativeDestinationQueue"]},{configurationStatus:()=>$t(o.nativeDestinations.configuredDestinations.value).some(i=>i.shouldApplyDeviceModeTransformation),configurationStatusStr:"Device mode transformations are enabled for at least one destination",supportedPlugins:["DeviceModeTransformation"]},{configurationStatus:()=>_(o.consents.activeConsentManagerPluginName.value),configurationStatusStr:"Consent management is enabled",activePluginName:o.consents.activeConsentManagerPluginName.value,supportedPlugins:Object.values(lt)},{configurationStatus:()=>_(o.storage.encryptionPluginName.value),configurationStatusStr:"Storage encryption is enabled",activePluginName:o.storage.encryptionPluginName.value,supportedPlugins:Object.values(Ne)},{configurationStatus:()=>o.storage.migrate.value,configurationStatusStr:"Storage migration is enabled",supportedPlugins:["StorageMigrator"]}],s=!1;return t.forEach(i=>{i.configurationStatus()?(e=e.filter(i.activePluginName?r=>!(r!==i.activePluginName&&i.supportedPlugins.includes(r)):r=>_(r)),this.addMissingPlugins(i,s,e)):e=e.filter(i.basePlugins!==void 0?r=>!(i.basePlugins.includes(r)||i.supportedPlugins.includes(r)):r=>!i.supportedPlugins.includes(r))}),[...Object.keys(ct()),...e]}addMissingPlugins(e,t,s){var l;const i=e.shouldAddMissingPlugins||t;let r;e.activePluginName?r=[...e.basePlugins||[],e.activePluginName]:r=[...e.supportedPlugins];const a=r.filter(c=>!s.includes(c));a.length>0&&(i&&s.push(...a),(l=this.logger)==null||l.warn(fr(Tt,e.configurationStatusStr,a,i)))}setActivePlugins(){const e=this.getPluginsToLoadBasedOnConfig(),t=[...Object.keys(qe),...Cn],s=[],i=[];e.forEach(r=>{t.includes(r)?s.push(r):i.push(r)}),i.length>0&&this.onError(new Error(`Ignoring loading of unknown plugins: ${i.join(",")}. Mandatory plugins: ${Object.keys(ct()).join(",")}. Load option plugins: ${o.plugins.pluginsToLoadFromConfig.value.join(",")}`)),M(()=>{o.plugins.totalPluginsToLoad.value=e.length,o.plugins.activePlugins.value=s,o.plugins.failedPlugins.value=i})}registerLocalPlugins(){Object.values(qe).forEach(e=>{f(e)&&o.plugins.activePlugins.value.includes(e().name)&&this.register([e()])})}registerRemotePlugins(){const e=Zr(o.plugins.activePlugins.value);Promise.all(Object.keys(e).map(async t=>{await e[t]().then(s=>this.register([s.default()])).catch(s=>{o.plugins.failedPlugins.value=[...o.plugins.failedPlugins.value,t],this.onError(s,t)})})).catch(t=>{this.onError(t)})}invokeMultiple(e,...t){try{return this.engine.invokeMultiple(e,...t)}catch(s){return this.onError(s,e),[]}}invokeSingle(e,...t){try{return this.engine.invokeSingle(e,...t)}catch(s){return this.onError(s,e),null}}register(e){e.forEach(t=>{try{this.engine.register(t,o)}catch(s){o.plugins.failedPlugins.value=[...o.plugins.failedPlugins.value,t.name],this.onError(s)}})}unregisterLocalPlugins(){Object.values(qe).forEach(e=>{try{this.engine.unregister(e().name)}catch(t){this.onError(t)}})}onError(e,t){if(this.errorHandler)this.errorHandler.onError(e,Tt,t);else throw e}}const Gt=(n,e)=>{try{return JSON.parse(n||"")}catch(t){const s=Re(t,"Failed to parse response data");if(f(e))e(s);else throw s}},to={headers:{Accept:"application/json","Content-Type":"application/json;charset=UTF-8"},method:"GET"},Ft=(n,e,t)=>{const s=C(to,e||{});return t&&(s.headers=C(s.headers,{Authorization:t})),s.url=n,s},jt=(n,e=Fs,t)=>new Promise((s,i)=>{let r;if(n.sendRawData===!0)r=n.data;else if(r=Y(n.data,!1,[],t),F(r)){i({error:new Error(Ei),undefined:void 0,options:n});return}const a=new XMLHttpRequest,l=u=>{i({error:new Error(Ui(De,a.status,a.statusText,n.url)),xhr:a,options:n})},c=u=>{i({error:new Error(Bi(De,u,n.url)),xhr:a,options:n})};a.ontimeout=c,a.onerror=c,a.onload=()=>{a.status>=200&&a.status<400?s({response:a.responseText,xhr:a,options:n}):l()},a.open(n.method,n.url),n.withCredentials===!0&&(a.withCredentials=!0),a.timeout=e,Object.keys(n.headers).forEach(u=>{n.headers[u]&&a.setRequestHeader(u,n.headers[u])});try{a.send(r)}catch(u){i({error:Re(u,$i(De,n.url)),xhr:a,options:n})}});class St{constructor(e,t){S(this,"hasErrorHandler",!1);this.errorHandler=e,this.logger=t,this.hasErrorHandler=!!this.errorHandler,this.onError=this.onError.bind(this)}async getData(e){const{url:t,options:s,timeout:i,isRawResponse:r}=e;try{const a=await jt(Ft(t,s,this.basicAuthHeader),i,this.logger);return{data:r?a.response:Gt(a.response,this.onError),details:a}}catch(a){return this.onError(a.error??a),{data:void 0,details:a}}}getAsyncData(e){const{callback:t,url:s,options:i,timeout:r,isRawResponse:a}=e,l=!f(t);jt(Ft(s,i,this.basicAuthHeader),r,this.logger).then(c=>{l||t(a?c.response:Gt(c.response,this.onError),c)}).catch(c=>{this.onError(c.error??c),l||t(void 0,c)})}onError(e){var t;if(this.hasErrorHandler)(t=this.errorHandler)==null||t.onError(e,ws);else throw e}setAuthHeader(e,t=!1){const s=t?e:ks(`${e}:`);this.basicAuthHeader=`Basic ${s}`}resetAuthHeader(){this.basicAuthHeader=void 0}}const no=new St(He,H),$="cookieStorage",B="localStorage",G="sessionStorage",V="memoryStorage",se="none",so="rl_user_id",io="rl_trait",ro="rl_anonymous_id",oo="rl_group_id",ao="rl_group_trait",lo="rl_page_init_referrer",co="rl_page_init_referring_domain",uo="rl_session",go="rl_auth_token",re={userId:so,userTraits:io,anonymousId:ro,groupId:oo,groupTraits:ao,initialReferrer:lo,initialReferringDomain:co,sessionInfo:uo,authToken:go},ho="test_rudder_cookie",fo="test_rudder_ls",po="test_rudder_ss",vo="__tld__",Nn="clientDataInCookie",Dn="clientDataInLocalStorage",Eo="clientDataInMemory",Ln="clientDataInSessionStorage",wn=["userId","userTraits","anonymousId","groupId","groupTraits","initialReferrer","initialReferringDomain","sessionInfo","authToken"],oe={[$]:Nn,[B]:Dn,[V]:Eo,[G]:Ln},mo="Failed to encode the cookie data.",Ht=(n,e)=>{try{return encodeURIComponent(n)}catch(t){e==null||e.error(mo,t);return}},Vt=n=>{try{return decodeURIComponent(n)}catch{return}},yo=n=>{const e={},t=n.split(/\s*;\s*/);let s;return t[0]&&t.forEach(i=>{s=i.split("=");const r=s[0]?Vt(s[0]):void 0;r&&(e[r]=s[1]?Vt(s[1]):void 0)}),e},bo=(n,e,t,s)=>{const i={...t||{}};let r=`${Ht(n,s)}=${Ht(e,s)}`;F(e)&&(i.maxage=-1),i.maxage&&(i.expires=new Date(+new Date+i.maxage)),i.path&&(r+=`; path=${i.path}`),i.domain&&(r+=`; domain=${i.domain}`),i.expires&&(r+=`; expires=${i.expires.toUTCString()}`),i.samesite&&(r+=`; samesite=${i.samesite}`),i.secure&&(r+="; secure"),globalThis.document.cookie=r},ut=()=>{const n=globalThis.document.cookie;return yo(n)},So=n=>ut()[n],W=function(n,e,t,s){switch(arguments.length){case 4:case 3:case 2:return bo(n,e,t,s);case 1:return n?So(n):ut();default:return ut()}},Ro=(n,e)=>{const t=new URL(o.lifecycle.sourceConfigUrl.value),s=`${t.origin}${t.pathname}?view=ad`,i=new St(n,e);i.setAuthHeader(o.lifecycle.writeKey.value),i.getAsyncData({url:s,options:{method:"HEAD",headers:{"Content-Type":void 0}},isRawResponse:!0,callback:(r,a)=>{var l;o.capabilities.isAdBlocked.value=(a==null?void 0:a.error)!==void 0||((l=a==null?void 0:a.xhr)==null?void 0:l.responseURL)!==s}})},Io=()=>!j(globalThis.crypto)&&f(globalThis.crypto.getRandomValues),Kt=()=>!j(globalThis.navigator.userAgentData),To=()=>!j(globalThis.navigator.sendBeacon)&&f(globalThis.navigator.sendBeacon),Ao=()=>!!globalThis.navigator.userAgent.match(/Trident.*rv:11\./),_o=(n,e="none")=>{var t;e==="none"&&n(void 0),e==="default"&&n(navigator.userAgentData),e==="full"&&((t=navigator.userAgentData)==null||t.getHighEntropyValues(["architecture","bitness","brands","mobile","model","platform","platformVersion","uaFullVersion","fullVersionList","wow64"]).then(s=>{n(s)}).catch(()=>{n()}))},Oo=()=>{const n=globalThis.document.createElement("div");return n.setAttribute("data-a-b","c"),n.dataset?n.dataset.aB==="c":!1},dt={URL:()=>!f(globalThis.URL)||!f(globalThis.URLSearchParams),Promise:()=>!f(globalThis.Promise),"Number.isNaN":()=>!f(globalThis.Number.isNaN),"Number.isInteger":()=>!f(globalThis.Number.isInteger),"Array.from":()=>!f(globalThis.Array.from),"Array.prototype.find":()=>!f(globalThis.Array.prototype.find),"Array.prototype.includes":()=>!f(globalThis.Array.prototype.includes),"String.prototype.endsWith":()=>!f(globalThis.String.prototype.endsWith),"String.prototype.startsWith":()=>!f(globalThis.String.prototype.startsWith),"String.prototype.includes":()=>!f(globalThis.String.prototype.includes),"String.prototype.replaceAll":()=>!f(globalThis.String.prototype.replaceAll),"String.fromCodePoint":()=>!f(globalThis.String.fromCodePoint),"Object.entries":()=>!f(globalThis.Object.entries),"Object.values":()=>!f(globalThis.Object.values),"Object.assign":()=>!f(globalThis.Object.assign),"Object.fromEntries":()=>!f(globalThis.Object.fromEntries),"Element.prototype.dataset":()=>!Oo(),TextEncoder:()=>!f(globalThis.TextEncoder)||!f(globalThis.TextDecoder),requestAnimationFrame:()=>!f(globalThis.requestAnimationFrame)||!f(globalThis.cancelAnimationFrame),CustomEvent:()=>!f(globalThis.CustomEvent),"navigator.sendBeacon":()=>!f(globalThis.navigator.sendBeacon),ArrayBuffer:()=>!f(globalThis.Uint8Array),Set:()=>!f(globalThis.Set),atob:()=>!f(globalThis.atob)},Po=()=>{const n=Object.keys(dt);let e=!1;for(let t=0;t<n.length;t++){const s=dt[n[t]];if(f(s)&&s()){e=!0;break}}return e},Qt=()=>{let n={density:0,width:0,height:0,innerWidth:0,innerHeight:0};return n={width:globalThis.screen.width,height:globalThis.screen.height,density:globalThis.devicePixelRatio,innerWidth:globalThis.innerWidth,innerHeight:globalThis.innerHeight},n},Mn=n=>{const e=["QuotaExceededError","NS_ERROR_DOM_QUOTA_REACHED"],t=[22,1014],s=e.includes(n.name)||t.includes(n.code);return n instanceof DOMException&&s},ce=(n=B,e,t)=>{let s,i;try{switch(n){case V:return!0;case $:s=e,i=ho;break;case B:s=e??globalThis.localStorage,i=fo;break;case G:s=e??globalThis.sessionStorage,i=po;break;default:return!1}return s?(s.setItem(i,"true"),s.getItem(i)?(s.removeItem(i),!0):!1):!1}catch(r){const a=Ni(st,n);let l="unavailable";return Mn(r)&&(l="full"),t==null||t.warn(`${a}${l}.`,r),!1}},Co=n=>{const e=document.createElement("a");return e.href=n,e.hostname},ko=n=>{const e=typeof globalThis.URL!="function"?Co(n):new URL(n).hostname,t=(e==null?void 0:e.split("."))??[],s=t[t.length-1],i=[];if(t.length===4&&s&&s===parseInt(s,10).toString())return i;if(t.length<=1)return t[0]&&t[0].indexOf("localhost")!==-1?["localhost"]:i;for(let r=t.length-2;r>=0;r-=1)i.push(t.slice(r).join("."));return i},No=n=>{const e=ko(n);for(let t=0;t<e.length;t+=1){const s=e[t],i=vo,r={domain:`${s.indexOf("localhost")!==-1?"":"."}${s}`};if(W(i,1,r),W(i))return W(i,null,r),s}return""},Do=()=>{const n=`.${No(globalThis.location.href)}`;return{maxage:js,path:"/",domain:!n||n==="."?void 0:n,samesite:"Lax",enabled:!0}},Lo=()=>({enabled:!0}),wo=()=>({enabled:!0}),Mo=()=>({enabled:!0}),ae=class ae{constructor(e={},t){S(this,"isSupportAvailable",!0);S(this,"isEnabled",!0);S(this,"length",0);if(ae.globalSingleton)return ae.globalSingleton;this.options=Do(),this.logger=t,this.configure(e),ae.globalSingleton=this}configure(e){return this.options=C(this.options??{},e),e.sameDomainCookiesOnly&&delete this.options.domain,this.isSupportAvailable=ce($,this,this.logger),this.isEnabled=!!(this.options.enabled&&this.isSupportAvailable),this.options}setItem(e,t){return W(e,t,this.options,this.logger),this.length=Object.keys(W()).length,!0}getItem(e){const t=W(e);return D(t)?null:t}removeItem(e){const t=this.setItem(e,null);return this.length=Object.keys(W()).length,t}clear(){}key(e){return this.keys()[e]??null}keys(){return Object.keys(W())}};S(ae,"globalSingleton",null);let $e=ae;class Uo{constructor(e,t){S(this,"isEnabled",!0);S(this,"length",0);S(this,"data",{});this.options=Mo(),this.logger=t,this.configure(e??{})}configure(e){return this.options=C(this.options,e),this.isEnabled=!!this.options.enabled,this.options}setItem(e,t){return this.data[e]=t,this.length=Object.keys(this.data).length,t}getItem(e){return e in this.data?this.data[e]:null}removeItem(e){return e in this.data&&delete this.data[e],this.length=Object.keys(this.data).length,null}clear(){this.data={},this.length=0}key(e){return this.keys()[e]??null}keys(){return Object.keys(this.data)}}const gt=new Uo({},H);var Bo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function $o(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Un={exports:{}};(function(n,e){(function(t,s){n.exports=s()})(Bo,function(){function t(g){return g=JSON.stringify(g),!!/^\{[\s\S]*\}$/.test(g)}function s(g){return g===void 0||typeof g=="function"?g+"":JSON.stringify(g)}function i(g){if(typeof g=="string")try{return JSON.parse(g)}catch{return g}}function r(g){return{}.toString.call(g)==="[object Function]"}function a(g){return Object.prototype.toString.call(g)==="[object Array]"}function l(g){var p="_Is_Incognit",b="yes";try{g||(g=window.localStorage),g.setItem(p,b),g.removeItem(p)}catch{var E={};E._data={},E.setItem=function(k,Ke){return E._data[k]=String(Ke)},E.getItem=function(k){return E._data.hasOwnProperty(k)?E._data[k]:void 0},E.removeItem=function(k){return delete E._data[k]},E.clear=function(){return E._data={}},g=E}finally{g.getItem(p)===b&&g.removeItem(p)}return g}var c=l();function u(){if(!(this instanceof u))return new u}u.prototype={set:function(p,b){if(p&&!t(p))c.setItem(p,s(b));else if(t(p))for(var E in p)this.set(E,p[E]);return this},get:function(p){if(p===void 0){var b={};return this.forEach(function(Wn,Yn){return b[Wn]=Yn}),b}if(p.charAt(0)==="?")return this.has(p.substr(1));var E=arguments;if(E.length>1){for(var P={},k=0,Ke=E.length;k<Ke;k++){var qn=i(c.getItem(E[k]));this.has(E[k])&&(P[E[k]]=qn)}return P}return i(c.getItem(p))},clear:function(){return c.clear(),this},remove:function(p){var b=this.get(p);return c.removeItem(p),b},has:function(p){return{}.hasOwnProperty.call(this.get(),p)},keys:function(){var p=[];return this.forEach(function(b){p.push(b)}),p},forEach:function(p){for(var b=0,E=c.length;b<E;b++){var P=c.key(b);p(P,this.get(P))}return this},search:function(p){for(var b=this.keys(),E={},P=0,k=b.length;P<k;P++)b[P].indexOf(p)>-1&&(E[b[P]]=this.get(b[P]));return E},len:function(){return c.length}};var h=null;function v(g,p){var b=arguments,E=null;if(h||(h=u()),b.length===0)return h.get();if(b.length===1){if(typeof g=="string")return h.get(g);if(t(g))return h.set(g)}if(b.length===2&&typeof g=="string"){if(!p)return h.remove(g);if(p&&typeof p=="string")return h.set(g,p);p&&r(p)&&(E=null,E=p(g,h.get(g)),v.set(g,E))}if(b.length===2&&a(g)&&r(p))for(var P=0,k=g.length;P<k;P++)E=p(g[P],h.get(g[P])),v.set(g[P],E);return v}for(var A in u.prototype)v[A]=u.prototype[A];return v})})(Un);var xo=Un.exports;const Z=$o(xo);class Go{constructor(e={},t){S(this,"isSupportAvailable",!0);S(this,"isEnabled",!0);S(this,"length",0);this.options=Lo(),this.logger=t,this.configure(e)}configure(e){return this.options=C(this.options,e),this.isSupportAvailable=ce(B,this,this.logger),this.isEnabled=!!(this.options.enabled&&this.isSupportAvailable),this.options}setItem(e,t){Z.set(e,t),this.length=Z.len()}getItem(e){const t=Z.get(e);return D(t)?null:t}removeItem(e){Z.remove(e),this.length=Z.len()}clear(){Z.clear(),this.length=0}key(e){return this.keys()[e]??null}keys(){return Z.keys()}}const Bn=new Go({},H);class Fo{constructor(e={},t){S(this,"isSupportAvailable",!0);S(this,"isEnabled",!0);S(this,"length",0);S(this,"store",globalThis.sessionStorage);this.options=wo(),this.logger=t,this.configure(e)}configure(e){return this.options=C(this.options,e),this.isSupportAvailable=ce(G,this,this.logger),this.isEnabled=!!(this.options.enabled&&this.isSupportAvailable),this.options}setItem(e,t){this.store.setItem(e,t),this.length=this.store.length}getItem(e){const t=this.store.getItem(e);return D(t)?null:t}removeItem(e){this.store.removeItem(e),this.length=this.store.length}clear(){this.store.clear(),this.length=0}key(e){return this.store.key(e)}keys(){const e=[];for(let t=0;t<this.store.length;t+=1){const s=this.store.key(t);s!==null&&e.push(s)}return e}}const $n=new Fo({},H),x=n=>{switch(n){case B:return Bn;case G:return $n;case V:return gt;case $:return new $e({},H);default:return gt}},jo=n=>{const e=new $e({},H).configure(n);o.storage.cookie.value={maxage:e.maxage,path:e.path,domain:e.domain,samesite:e.samesite,expires:e.expires,secure:e.secure}},Ho=n=>{Bn.configure(n)},Vo=n=>{gt.configure(n)},Ko=n=>{$n.configure(n)},Qo=(n={},e={},t={},s={})=>{jo(n),Ho(e),Vo(t),Ko(s)};class zo{constructor(e,t,s){S(this,"hasErrorHandler",!1);this.id=e.id,this.name=e.name,this.isEncrypted=e.isEncrypted??!1,this.validKeys=e.validKeys??{},this.engine=t??x(B),this.noKeyValidation=Object.keys(this.validKeys).length===0,this.noCompoundKey=e.noCompoundKey,this.originalEngine=this.engine,this.errorHandler=e.errorHandler??He,this.hasErrorHandler=!!this.errorHandler,this.logger=e.logger??H,this.pluginsManager=s}createValidKey(e){const{name:t,id:s,validKeys:i,noKeyValidation:r,noCompoundKey:a}=this;if(r)return a?e:[t,s,e].join(".");let l;return Object.values(i).forEach(c=>{c===e&&(l=a?e:[t,s,e].join("."))}),l}swapQueueStoreToInMemoryEngine(){const{name:e,id:t,validKeys:s,noCompoundKey:i}=this,r=x(V);Object.keys(s).forEach(a=>{const l=this.get(s[a]),c=i?a:[e,t,a].join(".");r.setItem(c,l),this.remove(a)}),this.engine=r}set(e,t){var i;const s=this.createValidKey(e);if(s)try{this.engine.setItem(s,this.encrypt(Y(t,!1,[],this.logger)))}catch(r){Mn(r)?((i=this.logger)==null||i.warn(er(`Store ${this.id}`)),this.swapQueueStoreToInMemoryEngine(),this.set(e,t)):this.onError(Re(r,xi(e)))}}get(e){const t=this.createValidKey(e);try{if(!t)return null;const s=this.decrypt(this.engine.getItem(t));return j(s)?null:JSON.parse(s)}catch(s){return this.onError(new Error(`${Gi(e)}: ${s.message}`)),null}}remove(e){const t=this.createValidKey(e);t&&this.engine.removeItem(t)}getOriginalEngine(){return this.originalEngine}decrypt(e){return j(e)?null:this.crypto(e,"decrypt")}encrypt(e){return this.crypto(e,"encrypt")}crypto(e,t){if(!this.isEncrypted||!e||typeof e!="string"||Os(e)==="")return e;const i=`storage.${t}`,r=this.pluginsManager?this.pluginsManager.invokeSingle(i,e):e;return typeof r>"u"?e:r??""}onError(e){var t;if(this.hasErrorHandler)(t=this.errorHandler)==null||t.onError(e,`Store ${this.id}`);else throw e}}const qo=(n,e)=>{var s;let t;if(n.consents.preConsent.value.enabled)switch((s=n.consents.preConsent.value.storage)==null?void 0:s.strategy){case"none":t=se;break;case"session":e!=="sessionInfo"&&(t=se);break;case"anonymousId":e!=="anonymousId"&&(t=se);break}return t};class Wo{constructor(e,t,s){S(this,"stores",{});S(this,"isInitialized",!1);S(this,"hasErrorHandler",!1);this.errorHandler=t,this.logger=s,this.hasErrorHandler=!!this.errorHandler,this.pluginsManager=e,this.onError=this.onError.bind(this)}init(){var s;if(this.isInitialized)return;const e=o.loadOptions.value,t={cookieStorageOptions:{samesite:e.sameSiteCookie,secure:e.secureCookie,domain:e.setCookieDomain,sameDomainCookiesOnly:e.sameDomainCookiesOnly,enabled:!0},localStorageOptions:{enabled:!0},inMemoryStorageOptions:{enabled:!0},sessionStorageOptions:{enabled:!0}};Qo(pe(C(t.cookieStorageOptions??{},((s=o.storage.cookie)==null?void 0:s.value)??{})),pe(t.localStorageOptions),pe(t.inMemoryStorageOptions),pe(t.sessionStorageOptions)),this.initClientDataStores(),this.isInitialized=!0}initClientDataStores(){this.initializeStorageState(),[V,B,$,G].forEach(t=>{var s;(s=x(t))!=null&&s.isEnabled&&this.setStore({id:oe[t],name:oe[t],isEncrypted:!0,noCompoundKey:!0,type:t})})}initializeStorageState(){var a;let e=o.storage.type.value,t=(a=o.loadOptions.value.storage)==null?void 0:a.entries;const s=o.consents.postConsent.value.storage;(_(s==null?void 0:s.type)||_(s==null?void 0:s.entries))&&(e=s==null?void 0:s.type,t=s==null?void 0:s.entries);let i=!0,r={};wn.forEach(l=>{var p;const c=l,u=l,h=(p=t==null?void 0:t[c])==null?void 0:p.type,A=qo(o,l)??h??e??ot,g=this.getResolvedStorageTypeForEntry(A,l);g!==se&&(i=!1),r={...r,[l]:{type:g,key:re[u]}}}),M(()=>{o.storage.type.value=e,o.storage.entries.value=r,o.storage.trulyAnonymousTracking.value=i})}getResolvedStorageTypeForEntry(e,t){var i,r,a,l,c,u;let s=e;switch(e){case B:(i=x(B))!=null&&i.isEnabled||(s=V);break;case G:(r=x(G))!=null&&r.isEnabled||(s=V);break;case V:case se:break;case $:default:(a=x($))!=null&&a.isEnabled?s=$:(l=x(B))!=null&&l.isEnabled?s=B:(c=x(G))!=null&&c.isEnabled?s=G:s=V;break}return s!==e&&((u=this.logger)==null||u.warn(tr(At,t,e,s))),s}setStore(e){const t=x(e.type);return this.stores[e.id]=new zo(e,t,this.pluginsManager),this.stores[e.id]}getStore(e){return this.stores[e]}onError(e){var t;if(this.hasErrorHandler)(t=this.errorHandler)==null||t.onError(e,At);else throw e}}const Yo=n=>n.replace(/\/{2,}/g,"/"),de=n=>{if(!N(n))return!1;try{return f(globalThis.URL)&&new URL(n),vr.test(n)}catch{return!1}},Xo=n=>{if(!N(n)||n.trim().length===0)throw new Error(Li(n))},Jo=n=>{if(!de(n))throw new Error(wi(n))},Zo=(n,e)=>{Xo(n),Jo(e)},ea=n=>m(n)&&m(n.source)&&!j(n.source.id)&&m(n.source.config)&&Array.isArray(n.source.destinations),ta=n=>typeof n=="string"&&Sn.includes(n),na=n=>{const e=new URL(n),{host:t,protocol:s}=e,i=t.split(".");let r;return i.length>2?r=`${i[i.length-2]}.${i[i.length-1]}`:r=t,`${s}//${r}`},sa=n=>{const e=na(window.location.href),t=n.startsWith("/")?n.substring(1):n;return`${e}/${t}`},ia=n=>{const e=[];return n.forEach(t=>{t.enabled&&!t.deleted&&e.push({id:t.id,displayName:t.destinationDefinition.displayName,config:t.config,shouldApplyDeviceModeTransformation:t.shouldApplyDeviceModeTransformation||!1,propagateEventsUntransformedOnError:t.propagateEventsUntransformedOnError||!1,userFriendlyId:`${t.destinationDefinition.displayName.replaceAll(" ","-")}___${t.id}`})}),e},ge=n=>n!=null&&n.endsWith("/")?ge(n.substring(0,n.length-1)):n,ht=n=>{try{return new URL(n).host}catch{return null}},xn=n=>ht(n)??"",ra=n=>{const e={};try{const t=new URL(n),s="utm_";t.searchParams.forEach((i,r)=>{if(r.startsWith(s)){let a=r.substring(s.length);a==="campaign"&&(a="name"),e[a]=i}})}catch{}return e},oa=n=>{let e=n;try{const t=new URL(n);e=t.origin+t.pathname+t.search}catch{}return e},aa=()=>!!(window.chrome&&window.chrome.runtime&&window.chrome.runtime.id),We="none",Ye="immediate",la=n=>{var e,t;return((t=(e=n==null?void 0:n.statsCollection)==null?void 0:e.errors)==null?void 0:t.enabled)===!0},ca=n=>{var e,t;return(t=(e=n==null?void 0:n.statsCollection)==null?void 0:e.errors)==null?void 0:t.provider},ua=n=>{var e,t;return((t=(e=n==null?void 0:n.statsCollection)==null?void 0:e.metrics)==null?void 0:t.enabled)===!0},Ve={All:!0},da=n=>{const e={sendPageEvent:!1,trackConsent:!1,discardPreConsentEvents:!1};if(m(n)){const t=R(n);e.storage=t.storage,_(t.integrations)&&(e.integrations=m(t.integrations)?t.integrations:Ve),e.discardPreConsentEvents=t.discardPreConsentEvents===!0,e.sendPageEvent=t.sendPageEvent===!0,e.trackConsent=t.trackConsent===!0,Ge(t.consentManagement)&&(e.consentManagement=C(t.consentManagement,{enabled:o.consents.enabled.value}))}return e},zt=n=>Ge(n)||Array.isArray(n),ga=(n,e)=>{let{provider:t}=n;const s=t?lt[t]:void 0;return t&&!s&&(e==null||e.error(Ri(K,t,lt)),t=void 0),{provider:t,consentManagerPluginName:s}},Gn=(n,e)=>{let t,s=[],i=[],r=!1,a,l=(n==null?void 0:n.enabled)===!0;Ge(n)&&l&&({provider:a,consentManagerPluginName:t}=ga(n,e),zt(n.allowedConsentIds)&&(s=n.allowedConsentIds,r=!0),zt(n.deniedConsentIds)&&(i=n.deniedConsentIds,r=!0));const c={allowedConsentIds:s,deniedConsentIds:i};return l=l&&!!t,{provider:a,consentManagerPluginName:t,initialized:r,enabled:l,consentsData:c}},ha=()=>{const n=document.getElementsByTagName("script"),e=/(?:^|\/)rsa(\.min)?\.js$/;for(const t of n){const s=t.getAttribute("src");if(s&&e.test(s))return s}},fa=(n,e)=>{if(o.reporting.isErrorReportingEnabled.value=la(n.source.config)&&!aa(),o.reporting.isMetricsReportingEnabled.value=ua(n.source.config),o.reporting.isErrorReportingEnabled.value){const t=ca(n.source.config),s=t?ke[t]:void 0;!D(t)&&!s&&(e==null||e.warn(Ki(K,t,ke,at))),o.reporting.errorReportingProviderPluginName.value=s??ke[at]}},pa=n=>{var u;const{useServerSideCookies:e,dataServiceEndpoint:t,storage:s}=o.loadOptions.value;let i=s==null?void 0:s.type;_(i)&&!ta(i)&&(n==null||n.warn(Vi(K,i,ot)),i=ot);let r=(u=s==null?void 0:s.encryption)==null?void 0:u.version;const a=r&&Ne[r];!D(r)&&D(a)?(n==null||n.warn(Qi(K,r,Ne,te)),r=te):D(r)&&(r=te);const l=s==null?void 0:s.migrate,c=l&&r===te;l===!0&&c!==l&&(n==null||n.warn(zi(K,r,te))),M(()=>{o.storage.type.value=i;let h=(s==null?void 0:s.cookie)??{};if(e){o.serverCookies.isEnabledServerSideCookies.value=e;const v=sa(t??yr);if(de(v)){o.serverCookies.dataServiceUrl.value=ge(v);const A=ht(window.location.href),g=ht(v);A!==g&&(h={...h,samesite:"None",secure:!0})}else o.serverCookies.isEnabledServerSideCookies.value=!1}o.storage.cookie.value=h,o.storage.encryptionPluginName.value=Ne[r],o.storage.migrate.value=c})},va=n=>{var v,A,g,p;const{provider:e,consentManagerPluginName:t,initialized:s,enabled:i,consentsData:r}=Gn(o.loadOptions.value.consentManagement,n),a=o.loadOptions.value.preConsent;let l=((v=a==null?void 0:a.storage)==null?void 0:v.strategy)??We;const c=["none","session","anonymousId"];_(l)&&!c.includes(l)&&(l=We,n==null||n.warn(gr(K,(A=a==null?void 0:a.storage)==null?void 0:A.strategy,We)));let u=((g=a==null?void 0:a.events)==null?void 0:g.delivery)??Ye;const h=["immediate","buffer"];_(u)&&!h.includes(u)&&(u=Ye,n==null||n.warn(hr(K,(p=a==null?void 0:a.events)==null?void 0:p.delivery,Ye))),M(()=>{var b;o.consents.activeConsentManagerPluginName.value=t,o.consents.initialized.value=s,o.consents.enabled.value=i,o.consents.data.value=r,o.consents.provider.value=e,o.consents.preConsent.value={enabled:((b=o.loadOptions.value.preConsent)==null?void 0:b.enabled)===!0&&s===!1&&i===!0,storage:{strategy:l},events:{delivery:u}}})},Ea=n=>{var s;let e=o.consents.resolutionStrategy.value,t;m(n.consentManagementMetadata)&&(o.consents.provider.value&&(e=((s=n.consentManagementMetadata.providers.find(i=>i.provider===o.consents.provider.value))==null?void 0:s.resolutionStrategy)??o.consents.resolutionStrategy.value),t=n.consentManagementMetadata),o.consents.provider.value==="custom"&&(e=void 0),M(()=>{o.consents.metadata.value=R(t),o.consents.resolutionStrategy.value=e})},ma=n=>{if(o.dataPlaneEvents.deliveryEnabled.value){const e="XhrQueue";let t=e;o.loadOptions.value.useBeacon&&(o.capabilities.isBeaconAvailable.value?t="BeaconQueue":(t=e,n==null||n.warn(Wi(K)))),M(()=>{o.dataPlaneEvents.eventsQueuePluginName.value=t})}},ya=(n,e,t,s,i)=>{const r=new URLSearchParams({p:gn,v:ye,build:Se,writeKey:e,lockIntegrationsVersion:t.toString(),lockPluginsVersion:s.toString()});let a=On,l=r,c="/sourceConfig/",u="";if(de(n)){const h=new URL(n);ge(h.pathname).endsWith("/sourceConfig")||(h.pathname=`${ge(h.pathname)}/sourceConfig/`),h.pathname=Yo(h.pathname),r.forEach((v,A)=>{h.searchParams.get(A)===null&&h.searchParams.set(A,v)}),a=h.origin,c=h.pathname,l=h.searchParams,u=h.hash}else i==null||i.warn(ur(K,n));return`${a}${c}?${l}${u}`},Fn=(n,e,t,s,i,r)=>{let a="";if(r){if(!de(r))throw new Error(Si(n));return ge(r)}const l=ha();return a=l?l.split("/").slice(0,-1).concat(e).join("/"):t,i&&(a=a.replace(`/${bt}/${Se}/${e}`,`/${s}/${Se}/${e}`)),a},ba=(n,e,t)=>Fn("integrations",Rn,An,n,e,t),Sa=(n,e,t)=>Fn("plugins",In,_n,n,e,t);class Ra{constructor(e,t,s){S(this,"hasErrorHandler",!1);this.errorHandler=t,this.logger=s,this.httpClient=e,this.hasErrorHandler=!!this.errorHandler,this.onError=this.onError.bind(this),this.processConfig=this.processConfig.bind(this)}attachEffects(){z(()=>{var e;(e=this.logger)==null||e.setMinLogLevel(o.lifecycle.logLevel.value)})}init(){this.attachEffects(),Zo(o.lifecycle.writeKey.value,o.lifecycle.dataPlaneUrl.value);const{logLevel:e,configUrl:t,lockIntegrationsVersion:s,lockPluginsVersion:i,destSDKBaseURL:r,pluginsSDKBaseURL:a}=o.loadOptions.value;o.lifecycle.activeDataplaneUrl.value=ge(o.lifecycle.dataPlaneUrl.value);const l=ba(ye,s,r),c=Sa(ye,i,a);pa(this.logger),va(this.logger),ma(this.logger),M(()=>{o.lifecycle.integrationsCDNPath.value=l,o.lifecycle.pluginsCDNPath.value=c,e&&(o.lifecycle.logLevel.value=e),o.lifecycle.sourceConfigUrl.value=ya(t,o.lifecycle.writeKey.value,s,i,this.logger)}),this.getConfig()}onError(e,t,s){var i;if(this.hasErrorHandler)(i=this.errorHandler)==null||i.onError(e,K,t,s);else throw e}processConfig(e,t){var r;if(!e){this.onError(Di(t==null?void 0:t.error));return}let s;try{N(e)?s=JSON.parse(e):s=e}catch(a){this.onError(a,Ut,!0);return}if(!ea(s)){this.onError(new Error(Ut),void 0,!0);return}if(s.source.enabled===!1){(r=this.logger)==null||r.error(vi);return}fa(s,this.logger);const i=s.source.destinations.length>0?ia(s.source.destinations):[];M(()=>{o.source.value={config:s.source.config,id:s.source.id,workspaceId:s.source.workspaceId},o.nativeDestinations.configuredDestinations.value=i,o.plugins.pluginsToLoadFromConfig.value=o.loadOptions.value.plugins??[],Ea(s),o.lifecycle.status.value="configured"})}getConfig(){const e=o.loadOptions.value.getSourceConfig;if(e){if(!f(e))throw new Error(pi);const t=e();t instanceof Promise?t.then(s=>this.processConfig(s)).catch(s=>{this.onError(s,"SourceConfig")}):this.processConfig(t)}else this.httpClient.getAsyncData({url:o.lifecycle.sourceConfigUrl.value,options:{headers:{"Content-Type":void 0}},callback:this.processConfig})}}const Ia=()=>{const n=new Date().toString().match(/([A-Z]+[+-]\d+)/);return n&&n[1]?n[1]:"NA"},jn=()=>(document==null?void 0:document.referrer)||"$direct",Ta=()=>{const n=document.getElementsByTagName("link");let e="";for(let t=0;n[t];t+=1){const s=n[t];if(s.getAttribute("rel")==="canonical"&&!e){e=s.getAttribute("href")??"";break}}return e},Aa=()=>{if(D(globalThis.navigator))return null;let{userAgent:n}=globalThis.navigator;const{brave:e}=globalThis.navigator;if(e&&Object.getPrototypeOf(e).isBrave){const t=n.match(/(chrome)\/([\w.]+)/i);t&&(n=`${n} Brave/${t[2]}`)}return n},_a=()=>D(globalThis.navigator)?null:globalThis.navigator.language??globalThis.navigator.browserLanguage,Hn=()=>{const n=Ta();let e=globalThis.location.pathname;const{href:t}=globalThis.location;let s=t;const{search:i}=globalThis.location;if(n)try{const c=new URL(n);c.search===""?s=n+i:s=n,e=c.pathname}catch{}const r=oa(s),{title:a}=document,l=jn();return{path:e,referrer:l,referring_domain:xn(l),search:i,title:a,url:r,tab_url:t}},Oa=`https://polyfill-fastly.io/v3/polyfill.min.js?version=3.111.0&features=${Object.keys(dt).join("%2C")}`,Pa=10*1e3,qt="rudderstackPolyfill";class Ca{constructor(e,t){this.logger=t,this.errorHandler=e,this.externalSrcLoader=new fn(this.errorHandler,this.logger),this.onError=this.onError.bind(this),this.onReady=this.onReady.bind(this)}init(){try{this.prepareBrowserCapabilities(),this.attachWindowListeners()}catch(e){this.onError(e)}}detectBrowserCapabilities(){M(()=>{o.capabilities.storage.isCookieStorageAvailable.value=ce($,x($),this.logger),o.capabilities.storage.isLocalStorageAvailable.value=ce(B,void 0,this.logger),o.capabilities.storage.isSessionStorageAvailable.value=ce(G,void 0,this.logger),o.capabilities.isBeaconAvailable.value=To(),o.capabilities.isUaCHAvailable.value=Kt(),o.capabilities.isCryptoAvailable.value=Io(),o.capabilities.isIE11.value=Ao(),o.capabilities.isOnline.value=globalThis.navigator.onLine,o.context.userAgent.value=Aa(),o.context.locale.value=_a(),o.context.screen.value=Qt(),o.context.timezone.value=Ia(),Kt()&&_o(e=>{o.context["ua-ch"].value=e},o.loadOptions.value.uaChTrackLevel)}),z(()=>{o.loadOptions.value.sendAdblockPage===!0&&o.lifecycle.sourceConfigUrl.value!==void 0&&Ro(this.errorHandler,this.logger)})}prepareBrowserCapabilities(){var i;o.capabilities.isLegacyDOM.value=Po();const e=o.loadOptions.value.polyfillURL;let t=Oa;if(ue(e)&&(de(e)?t=e:(i=this.logger)==null||i.warn(pr(st,e))),o.loadOptions.value.polyfillIfRequired&&o.capabilities.isLegacyDOM.value&&de(t)){const r=t!==o.loadOptions.value.polyfillURL;if(r){const a=`RS_polyfillCallback_${o.lifecycle.writeKey.value}`,l=()=>{this.onReady(),delete globalThis[a]};globalThis[a]=l,t=`${t}&callback=${a}`}this.externalSrcLoader.loadJSFile({url:t,id:qt,async:!0,timeout:Pa,callback:a=>{a?r||this.onReady():this.onError(new Error(dr(qt,t)))}})}else this.onReady()}attachWindowListeners(){globalThis.addEventListener("offline",()=>{o.capabilities.isOnline.value=!1}),globalThis.addEventListener("online",()=>{o.capabilities.isOnline.value=!0}),globalThis.addEventListener("resize",Qs(()=>{o.context.screen.value=Qt()},this))}onReady(){this.detectBrowserCapabilities(),o.lifecycle.status.value="browserCapabilitiesReady"}onError(e){if(this.errorHandler)this.errorHandler.onError(e,st);else throw e}}function ka(n){return crypto.getRandomValues(new Uint8Array(n))}var Wt=4096,Le=[],X=0,Xe;for(;X<256;X++)Le[X]=(X+256).toString(16).substring(1);function Na(){(!Xe||X+16>Wt)&&(Xe=ka(Wt),X=0);for(var n=0,e,t="";n<16;n++)e=Xe[X+n],n==6?t+=Le[e&15|64]:n==8?t+=Le[e&63|128]:t+=Le[e],n&1&&n>1&&n<11&&(t+="-");return X+=16,t}var ne=256,we=[],Ce;for(;ne--;)we[ne]=(ne+256).toString(16).substring(1);function Da(){var n=0,e,t="";if(!Ce||ne+16>256){for(Ce=Array(n=256);n--;)Ce[n]=256*Math.random()|0;n=ne=0}for(;n<16;n++)e=Ce[ne+n],n==6?t+=we[e&15|64]:n==8?t+=we[e&63|128]:t+=we[e],n&1&&n>1&&n<11&&(t+="-");return ne++,t}const La=()=>!j(globalThis.crypto)&&f(globalThis.crypto.getRandomValues),Vn=()=>La()?Na():Da(),wa=()=>new Date().toISOString(),Ma="web",Ua=["integrations","anonymousId","originalTimestamp"],Yt=["library","consentManagement","userAgent","ua-ch","screen"],Je=["id","anonymous_id","user_id","sent_at","timestamp","received_at","original_timestamp","event","event_text","channel","context_ip","context_request_ip","context_passed_ip","group_id","previous_id"],Kn=n=>typeof n=="number"&&!Number.isNaN(n),Ba=(n,e)=>e.toString().length>=n,Qn=n=>Kn(n)&&n>=0&&Number.isInteger(n),Xt=10,Jt=n=>{const e=Date.now();return!n||e>n},$a=()=>Date.now(),xa=(n,e)=>!n||!Qn(n)||!Ba(Xt,n)?(e==null||e.warn(Zi(ve,n,Xt)),!1):!0,Ga=n=>{const e=Date.now(),t=n||be;return{id:e,expiresAt:e+t,timeout:t,sessionStart:void 0,autoTrack:!0}},Fa=(n,e)=>({id:xa(n,e)?n:$a(),sessionStart:void 0,manualTrack:!0}),Ee=n=>n===$||n===B||n===G||n===V,ft=()=>Vn(),ja=n=>{const e=Hn(),t={};return Object.keys(e).forEach(s=>{t[s]=(n==null?void 0:n[s])||e[s]}),t.initial_referrer=(n==null?void 0:n.initial_referrer)||o.session.initialReferrer.value,t.initial_referring_domain=(n==null?void 0:n.initial_referring_domain)||o.session.initialReferringDomain.value,t},Ha=(n,e)=>{const t=(e==null?void 0:e.page)||{},s=n,i=Hn();return Object.keys(i).forEach(r=>{D(s[r])&&(s[r]=t[r]||i[r])}),D(s.initial_referrer)&&(s.initial_referrer=t.initial_referrer||o.session.initialReferrer.value),D(s.initial_referring_domain)&&(s.initial_referring_domain=t.initial_referring_domain||o.session.initialReferringDomain.value),s},Ze=(n,e,t)=>{m(n)&&Object.keys(n).forEach(s=>{(Je.includes(s)||Je.includes(s.toLowerCase()))&&(t==null||t.warn(qi(dn,s,e,Je)))})},Va=(n,e)=>{const{properties:t,traits:s,context:i}=n,{traits:r}=i;Ze(t,"properties",e),Ze(s,"traits",e),Ze(r,"context.traits",e)},Ka=(n,e)=>{e.anonymousId&&N(e.anonymousId)&&(n.anonymousId=e.anonymousId),m(e.integrations)&&(n.integrations=e.integrations),e.originalTimestamp&&N(e.originalTimestamp)&&(n.originalTimestamp=e.originalTimestamp)},Qa=(n,e,t)=>{let s=n;return Object.keys(e).forEach(i=>{if(!Ua.includes(i)&&!Yt.includes(i)){if(i!=="context")s=C(s,{[i]:e[i]});else if(!D(e[i])&&m(e[i])){const r={};Object.keys(e[i]).forEach(a=>{Yt.includes(a)||(r[a]=e[i][a])}),s=C(s,{...r})}}}),s},za=()=>{var n;return o.loadOptions.value.useGlobalIntegrationsConfigInEvents&&(m((n=o.consents.postConsent.value)==null?void 0:n.integrations)||m(o.nativeDestinations.loadOnlyIntegrations.value))},qa=(n,e)=>{m(e)&&(Ka(n,e),n.context=Qa(n.context,e))},Wa=n=>{var t;let e;return za()?e=R(((t=o.consents.postConsent.value)==null?void 0:t.integrations)??o.nativeDestinations.loadOnlyIntegrations.value):m(n)?e=n:e=Ve,e},fe=(n,e,t,s)=>{var a,l,c;const i={channel:Ma,context:{traits:R(o.session.userTraits.value),sessionId:o.session.sessionInfo.value.id||void 0,sessionStart:o.session.sessionInfo.value.sessionStart||void 0,...o.consents.enabled.value&&{consentManagement:{deniedConsentIds:R(o.consents.data.value.deniedConsentIds),allowedConsentIds:R(o.consents.data.value.allowedConsentIds),provider:o.consents.provider.value,resolutionStrategy:o.consents.resolutionStrategy.value}},"ua-ch":o.context["ua-ch"].value,app:o.context.app.value,library:o.context.library.value,userAgent:o.context.userAgent.value,os:o.context.os.value,locale:o.context.locale.value,screen:o.context.screen.value,campaign:ra(globalThis.location.href),page:ja(t),timezone:o.context.timezone.value},originalTimestamp:wa(),integrations:Ve,messageId:Vn(),userId:n.userId||o.session.userId.value};Ee((a=o.storage.entries.value.anonymousId)==null?void 0:a.type)?i.anonymousId=o.session.anonymousId.value:i.anonymousId=ft(),o.storage.trulyAnonymousTracking.value&&(i.context.trulyAnonymousTracking=!0),n.type==="identify"&&(i.context.traits=((l=o.storage.entries.value.userTraits)==null?void 0:l.type)!==se?R(o.session.userTraits.value):n.context.traits),n.type==="group"&&((n.groupId||o.session.groupId.value)&&(i.groupId=n.groupId||o.session.groupId.value),(n.traits||o.session.groupTraits.value)&&(i.traits=((c=o.storage.entries.value.groupTraits)==null?void 0:c.type)!==se?R(o.session.groupTraits.value):n.traits));const r=C(n,i);return r.event===void 0&&(r.event=null),r.properties===void 0&&(r.properties=null),qa(r,e),Va(r,s),r.integrations=Wa(r.integrations),r};class Ya{constructor(e){this.logger=e}generatePageEvent(e,t,s,i){let r=s??{};return r.name=t,r.category=e,r=Ha(r,i),fe({properties:r,name:t,category:e,type:"page"},i,r,this.logger)}generateTrackEvent(e,t,s){return fe({properties:t,event:e,type:"track"},s,void 0,this.logger)}generateIdentifyEvent(e,t,s){return fe({userId:e,type:"identify",context:{traits:t}},s,void 0,this.logger)}generateAliasEvent(e,t,s){const r=fe({previousId:t,type:"alias"},s,void 0,this.logger);return r.userId=e??r.userId,r}generateGroupEvent(e,t,s){const i={type:"group"};return e&&(i.groupId=e),t&&(i.traits=t),fe(i,s,void 0,this.logger)}create(e){let t;switch(e.type){case"page":t=this.generatePageEvent(e.category,e.name,e.properties,e.options);break;case"track":t=this.generateTrackEvent(e.name,e.properties,e.options);break;case"identify":t=this.generateIdentifyEvent(e.userId,e.traits,e.options);break;case"alias":t=this.generateAliasEvent(e.to,e.from,e.options);break;case"group":t=this.generateGroupEvent(e.groupId,e.traits,e.options);break}return t}}class Xa{constructor(e,t,s,i){this.eventRepository=e,this.userSessionManager=t,this.errorHandler=s,this.logger=i,this.eventFactory=new Ya(this.logger),this.onError=this.onError.bind(this)}init(){this.eventRepository.init()}resume(){this.eventRepository.resume()}addEvent(e){this.userSessionManager.refreshSession();const t=this.eventFactory.create(e);t?this.eventRepository.enqueue(t,e.callback):this.onError(new Error(mi))}onError(e,t,s){if(this.errorHandler)this.errorHandler.onError(e,dn,t,s);else throw e}}class Ja{constructor(e,t,s,i,r){this.storeManager=i,this.pluginsManager=s,this.logger=t,this.errorHandler=e,this.httpClient=r,this.onError=this.onError.bind(this),this.serverSideCookieDebounceFuncs={}}init(){this.syncStorageDataToState(),this.registerEffects()}syncStorageDataToState(){this.migrateStorageIfNeeded(),this.migrateDataFromPreviousStorage(),this.setUserId(this.getUserId()),this.setUserTraits(this.getUserTraits()),this.setGroupId(this.getGroupId()),this.setGroupTraits(this.getGroupTraits());const{externalAnonymousIdCookieName:e,anonymousIdOptions:t}=o.loadOptions.value;let s;ue(e)&&typeof e=="string"&&(s=this.getExternalAnonymousIdByCookieName(e)),this.setAnonymousId(s??this.getAnonymousId(t)),this.setAuthToken(this.getAuthToken()),this.setInitialReferrerInfo(),this.configureSessionTracking()}configureSessionTracking(){let e=this.getSessionInfo();if(this.isPersistenceEnabledForStorageEntry("sessionInfo")){const t=this.getConfiguredSessionTrackingInfo(),s=e??Ir;e={...s,...t,autoTrack:t.autoTrack&&s.manualTrack!==!0}}o.session.sessionInfo.value=this.isPersistenceEnabledForStorageEntry("sessionInfo")?e:I.sessionInfo,o.session.sessionInfo.value.autoTrack&&this.startOrRenewAutoTracking(o.session.sessionInfo.value)}setInitialReferrerInfo(){const e=this.getInitialReferrer(),t=this.getInitialReferringDomain();if(e&&t)this.setInitialReferrer(e),this.setInitialReferringDomain(t);else{const s=e||jn();this.setInitialReferrer(s),this.setInitialReferringDomain(xn(s))}}isPersistenceEnabledForStorageEntry(e){var t;return Ee((t=o.storage.entries.value[e])==null?void 0:t.type)}migrateDataFromPreviousStorage(){const e=o.storage.entries.value,t=[$,B,G];Object.keys(e).forEach(s=>{var l,c;const i=s,r=(l=e[i])==null?void 0:l.type,a=(c=this.storeManager)==null?void 0:c.getStore(oe[r]);a&&t.forEach(u=>{var v;const h=(v=this.storeManager)==null?void 0:v.getStore(oe[u]);if(h&&u!==r){const A=h.get(re[i]);Ts(A)&&a.set(re[i],A),h.remove(re[i])}})})}migrateStorageIfNeeded(){if(!o.storage.migrate.value)return;const e=[Nn,Dn,Ln],t=[];e.forEach(s=>{var r;const i=(r=this.storeManager)==null?void 0:r.getStore(s);i&&t.push(i)}),Object.keys(re).forEach(s=>{const i=re[s];t.forEach(r=>{var l;const a=(l=this.pluginsManager)==null?void 0:l.invokeSingle("storage.migrate",i,r.engine,this.errorHandler,this.logger);j(a)||r.set(i,a)})})}getConfiguredSessionTrackingInfo(){var i,r,a,l,c;let e=((i=o.loadOptions.value.sessions)==null?void 0:i.autoTrack)!==!1;if(!e)return{autoTrack:e};let t;const s=(r=o.loadOptions.value.sessions)==null?void 0:r.timeout;return Qn(s)?t=s:((a=this.logger)==null||a.warn(Yi(ve,s,be)),t=be),t===0&&((l=this.logger)==null||l.warn(Xi(ve)),e=!1),t>0&&t<Dt&&((c=this.logger)==null||c.warn(Ji(ve,t,Dt))),{timeout:t,autoTrack:e}}onError(e,t){if(this.errorHandler)this.errorHandler.onError(e,ve,t);else throw e}getEncryptedCookieData(e,t){const s=[];return e.forEach(i=>{const r=t==null?void 0:t.encrypt(Y(i.value,!1,[],this.logger));ue(r)&&s.push({name:i.name,value:r})}),s}makeRequestToSetCookie(e,t){var s,i,r,a,l,c,u,h;(h=this.httpClient)==null||h.getAsyncData({url:o.serverCookies.dataServiceUrl.value,options:{method:"POST",data:Y({reqType:"setCookies",workspaceId:(s=o.source.value)==null?void 0:s.workspaceId,data:{options:{maxAge:(i=o.storage.cookie.value)==null?void 0:i.maxage,path:(r=o.storage.cookie.value)==null?void 0:r.path,domain:(a=o.storage.cookie.value)==null?void 0:a.domain,sameSite:(l=o.storage.cookie.value)==null?void 0:l.samesite,secure:(c=o.storage.cookie.value)==null?void 0:c.secure,expires:(u=o.storage.cookie.value)==null?void 0:u.expires},cookies:e}}),sendRawData:!0,withCredentials:!0},isRawResponse:!0,callback:t})}setServerSideCookies(e,t,s){try{const i=this.getEncryptedCookieData(e,s);i.length>0&&this.makeRequestToSetCookie(i,(r,a)=>{var l,c,u;((l=a==null?void 0:a.xhr)==null?void 0:l.status)===200?e.forEach(h=>{var p;const v=s==null?void 0:s.get(h.name),A=Y(h.value,!1,[]);Y(v,!1,[])!==A&&((p=this.logger)==null||p.error(ji(h.name)),t&&t(h.name,h.value))}):((u=this.logger)==null||u.error(Fi((c=a==null?void 0:a.xhr)==null?void 0:c.status)),e.forEach(h=>{t&&t(h.name,h.value)}))})}catch(i){this.onError(i,Hi),e.forEach(r=>{t&&t(r.name,r.value)})}}syncValueToStorage(e,t){var r,a,l;const s=o.storage.entries.value,i=(r=s[e])==null?void 0:r.type;if(Ee(i)){const c=(a=this.storeManager)==null?void 0:a.getStore(oe[i]),u=(l=s[e])==null?void 0:l.key;t&&(N(t)||Ge(t))?o.serverCookies.isEnabledServerSideCookies.value&&i===$?(this.serverSideCookieDebounceFuncs[e]&&globalThis.clearTimeout(this.serverSideCookieDebounceFuncs[e]),this.serverSideCookieDebounceFuncs[e]=globalThis.setTimeout(()=>{this.setServerSideCookies([{name:u,value:t}],(h,v)=>{c==null||c.set(h,v)},c)},Rr)):c==null||c.set(u,t):c==null||c.remove(u)}}registerEffects(){wn.forEach(e=>{z(()=>{this.syncValueToStorage(e,o.session[e].value)})})}setAnonymousId(e,t){var i;let s=e;this.isPersistenceEnabledForStorageEntry("anonymousId")?(!s&&t&&(s=(i=this.pluginsManager)==null?void 0:i.invokeSingle("userSession.anonymousIdGoogleLinker",t)),s=s||ft()):s=I.anonymousId,o.session.anonymousId.value=s}getAnonymousId(e){var s,i;const t=(s=o.storage.entries.value.anonymousId)==null?void 0:s.type;if(Ee(t)){let r=this.getEntryValue("anonymousId");!r&&e&&(r=(i=this.pluginsManager)==null?void 0:i.invokeSingle("storage.getAnonymousId",x,e)),o.session.anonymousId.value=r||ft()}return o.session.anonymousId.value}getEntryValue(e){var i,r,a;const t=o.storage.entries.value,s=(i=t[e])==null?void 0:i.type;if(Ee(s)){const l=(r=this.storeManager)==null?void 0:r.getStore(oe[s]),c=(a=t[e])==null?void 0:a.key;return(l==null?void 0:l.get(c))??null}return null}getExternalAnonymousIdByCookieName(e){const t=x($);return t!=null&&t.isEnabled?t.getItem(e)??null:null}getUserId(){return this.getEntryValue("userId")}getUserTraits(){return this.getEntryValue("userTraits")}getGroupId(){return this.getEntryValue("groupId")}getGroupTraits(){return this.getEntryValue("groupTraits")}getInitialReferrer(){return this.getEntryValue("initialReferrer")}getInitialReferringDomain(){return this.getEntryValue("initialReferringDomain")}getSessionInfo(){return this.getEntryValue("sessionInfo")}getAuthToken(){return this.getEntryValue("authToken")}getSessionId(){const e=this.getSessionInfo()??I.sessionInfo;return e.autoTrack&&!Jt(e.expiresAt)||e.manualTrack?e.id??null:null}refreshSession(){let e=this.getSessionInfo()??I.sessionInfo;(e.autoTrack||e.manualTrack)&&(e.autoTrack&&(this.startOrRenewAutoTracking(e),e=o.session.sessionInfo.value),e.sessionStart===void 0?e={...e,sessionStart:!0}:e.sessionStart&&(e={...e,sessionStart:!1})),o.session.sessionInfo.value=e,o.lifecycle.status.value!=="readyExecuted"&&this.syncValueToStorage("sessionInfo",e)}reset(e,t){const{session:s}=o,{manualTrack:i,autoTrack:r}=s.sessionInfo.value;M(()=>{s.userId.value=I.userId,s.userTraits.value=I.userTraits,s.groupId.value=I.groupId,s.groupTraits.value=I.groupTraits,s.authToken.value=I.authToken,e&&this.setAnonymousId(),!t&&(r?(s.sessionInfo.value=I.sessionInfo,this.startOrRenewAutoTracking(s.sessionInfo.value)):i&&this.startManualTrackingInternal())})}setUserId(e){o.session.userId.value=this.isPersistenceEnabledForStorageEntry("userId")&&e?e:I.userId}setUserTraits(e){o.session.userTraits.value=this.isPersistenceEnabledForStorageEntry("userTraits")&&e?C(o.session.userTraits.value??I.userTraits,e):I.userTraits}setGroupId(e){o.session.groupId.value=this.isPersistenceEnabledForStorageEntry("groupId")&&e?e:I.groupId}setGroupTraits(e){o.session.groupTraits.value=this.isPersistenceEnabledForStorageEntry("groupTraits")&&e?C(o.session.groupTraits.value??I.groupTraits,e):I.groupTraits}setInitialReferrer(e){o.session.initialReferrer.value=this.isPersistenceEnabledForStorageEntry("initialReferrer")&&e?e:I.initialReferrer}setInitialReferringDomain(e){o.session.initialReferringDomain.value=this.isPersistenceEnabledForStorageEntry("initialReferringDomain")&&e?e:I.initialReferringDomain}startOrRenewAutoTracking(e){if(Jt(e.expiresAt))o.session.sessionInfo.value=Ga(e.timeout);else{const t=Date.now(),s=e.timeout;o.session.sessionInfo.value=C(e,{expiresAt:t+s})}}start(e){o.session.sessionInfo.value=Fa(e,this.logger)}startManualTrackingInternal(){this.start(Date.now())}end(){o.session.sessionInfo.value=I.sessionInfo}setAuthToken(e){o.session.authToken.value=this.isPersistenceEnabledForStorageEntry("authToken")&&e?e:I.authToken}}const Za=["BeaconQueue","Bugsnag","CustomConsentManager","DeviceModeDestinations","DeviceModeTransformation","ErrorReporting","ExternalAnonymousId","GoogleLinker","KetchConsentManager","NativeDestinationQueue","OneTrustConsentManager","StorageEncryption","StorageEncryptionLegacy","StorageMigrator","XhrQueue"],el=(n,e)=>{var a,l,c,u;const t=R(e);return N(t.setCookieDomain)||delete t.setCookieDomain,["Strict","Lax","None"].includes(t.sameSiteCookie)||delete t.sameSiteCookie,t.secureCookie=t.secureCookie===!0,["none","default","full"].includes(t.uaChTrackLevel)||delete t.uaChTrackLevel,m(t.integrations)||delete t.integrations,t.plugins=t.plugins??Za,t.useGlobalIntegrationsConfigInEvents=t.useGlobalIntegrationsConfigInEvents===!0,t.bufferDataPlaneEventsUntilReady=t.bufferDataPlaneEventsUntilReady===!0,t.sendAdblockPage=t.sendAdblockPage===!0,t.useServerSideCookies=t.useServerSideCookies===!0,t.dataServiceEndpoint&&typeof t.dataServiceEndpoint!="string"&&delete t.dataServiceEndpoint,m(t.sendAdblockPageOptions)||delete t.sendAdblockPageOptions,_(t.loadIntegration)?t.loadIntegration=t.loadIntegration===!0:delete t.loadIntegration,m(t.storage)?(t.storage=ee(t.storage),t.storage.migrate=((a=t.storage)==null?void 0:a.migrate)===!0):delete t.storage,m(t.beaconQueueOptions)?t.beaconQueueOptions=ee(t.beaconQueueOptions):delete t.beaconQueueOptions,m(t.destinationsQueueOptions)?t.destinationsQueueOptions=ee(t.destinationsQueueOptions):delete t.destinationsQueueOptions,m(t.queueOptions)?t.queueOptions=ee(t.queueOptions):delete t.queueOptions,t.lockIntegrationsVersion=t.lockIntegrationsVersion===!0,t.lockPluginsVersion=t.lockPluginsVersion===!0,Kn(t.dataPlaneEventsBufferTimeout)||delete t.dataPlaneEventsBufferTimeout,m((l=t.storage)==null?void 0:l.cookie)?t.storage.cookie=ee((u=t.storage)==null?void 0:u.cookie):(c=t.storage)==null||delete c.cookie,m(t.preConsent)?t.preConsent=ee(t.preConsent):delete t.preConsent,C(n,t)},Zt="dataplaneEventsQueue",en="destinationsEventsQueue",tl="transformEvent",nl=(n,e)=>Object.keys(n).filter(t=>n[t]!==!0||!e[t]).reduce((t,s)=>{const i=R(t);return i[s]=n[s],i},{}),sl=(n,e)=>{const t=R(n),s=n.integrations??Ve,i=e.nativeDestinations.integrationsConfig.value,r=nl(s,i);return t.integrations=C(i,r),t},il=n=>{var e,t,s;return n.consents.preConsent.value.enabled&&((e=n.consents.preConsent.value.events)==null?void 0:e.delivery)==="buffer"&&(((t=n.consents.preConsent.value.storage)==null?void 0:t.strategy)==="session"||((s=n.consents.preConsent.value.storage)==null?void 0:s.strategy)==="none")};class rl{constructor(e,t,s,i){this.pluginsManager=e,this.errorHandler=s,this.logger=i,this.httpClient=new St(s,i),this.storeManager=t,this.onError=this.onError.bind(this)}init(){try{this.dataplaneEventsQueue=this.pluginsManager.invokeSingle(`${Zt}.init`,o,this.httpClient,this.storeManager,this.errorHandler,this.logger)}catch(s){this.onError(s,or)}try{this.dmtEventsQueue=this.pluginsManager.invokeSingle(`${tl}.init`,o,this.pluginsManager,this.httpClient,this.storeManager,this.errorHandler,this.logger)}catch(s){this.onError(s,ar)}try{this.destinationsEventsQueue=this.pluginsManager.invokeSingle(`${en}.init`,o,this.pluginsManager,this.storeManager,this.dmtEventsQueue,this.errorHandler,this.logger)}catch(s){this.onError(s,rr)}z(()=>{var s,i;o.nativeDestinations.clientDestinationsReady.value===!0&&((s=this.destinationsEventsQueue)==null||s.start(),(i=this.dmtEventsQueue)==null||i.start())});const e=il(o);let t;z(()=>{var r,a;const s=o.loadOptions.value.bufferDataPlaneEventsUntilReady===!0&&o.nativeDestinations.clientDestinationsReady.value===!1;(o.nativeDestinations.activeDestinations.value.some(l=>Qr(l))===!1||s===!1)&&!e&&((r=this.dataplaneEventsQueue)==null?void 0:r.scheduleTimeoutActive)!==!0&&(globalThis.clearTimeout(t),(a=this.dataplaneEventsQueue)==null||a.start())}),o.loadOptions.value.bufferDataPlaneEventsUntilReady===!0&&(t=globalThis.setTimeout(()=>{var s,i;((s=this.dataplaneEventsQueue)==null?void 0:s.scheduleTimeoutActive)!==!0&&((i=this.dataplaneEventsQueue)==null||i.start())},o.loadOptions.value.dataPlaneEventsBufferTimeout))}resume(){var e,t,s,i;((e=this.dataplaneEventsQueue)==null?void 0:e.scheduleTimeoutActive)!==!0&&(o.consents.postConsent.value.discardPreConsentEvents&&((t=this.dataplaneEventsQueue)==null||t.clear(),(s=this.destinationsEventsQueue)==null||s.clear()),(i=this.dataplaneEventsQueue)==null||i.start())}enqueue(e,t){let s;try{s=sl(e,o),this.pluginsManager.invokeSingle(`${Zt}.enqueue`,o,this.dataplaneEventsQueue,s,this.errorHandler,this.logger)}catch(i){this.onError(i,cr)}try{const i=R(e);this.pluginsManager.invokeSingle(`${en}.enqueue`,o,this.destinationsEventsQueue,i,this.errorHandler,this.logger)}catch(i){this.onError(i,lr)}try{t==null||t(s)}catch(i){this.onError(i,ir)}}onError(e,t,s){if(this.errorHandler)this.errorHandler.onError(e,Ds,t,s);else throw e}}const tn=n=>{const e=new CustomEvent(n,{detail:{analyticsInstance:globalThis.rudderanalytics},bubbles:!0,cancelable:!0,composed:!0});globalThis.document.dispatchEvent(e)};class nn{constructor(){this.preloadBuffer=new bn,this.initialized=!1,this.errorHandler=He,this.logger=H,this.externalSrcLoader=new fn(this.errorHandler,this.logger),this.capabilitiesManager=new Ca(this.errorHandler,this.logger),this.httpClient=no}load(e,t,s={}){var a;if(o.lifecycle.status.value)return;let i=R(t),r=R(s);an(t)&&(r=t,i=void 0),M(()=>{o.lifecycle.writeKey.value=e,o.lifecycle.dataPlaneUrl.value=i,o.loadOptions.value=el(o.loadOptions.value,r),o.lifecycle.status.value="mounted"}),o.loadOptions.value.logLevel&&((a=this.logger)==null||a.setMinLogLevel(o.loadOptions.value.logLevel)),Fe("state",o,e),this.startLifecycle()}startLifecycle(){z(()=>{try{switch(o.lifecycle.status.value){case"mounted":this.onMounted();break;case"browserCapabilitiesReady":this.onBrowserCapabilitiesReady();break;case"configured":this.onConfigured();break;case"pluginsLoading":break;case"pluginsReady":this.onPluginsReady();break;case"initialized":this.onInitialized();break;case"loaded":this.onLoaded();break;case"destinationsLoading":break;case"destinationsReady":this.onDestinationsReady();break;case"ready":this.onReady();break;case"readyExecuted":default:break}}catch(e){const t="Failed to load the SDK";this.errorHandler.onError(Re(e,t),Qe)}})}onBrowserCapabilitiesReady(){Ys(this),this.prepareInternalServices(),this.loadConfig()}onLoaded(){this.processBufferedEvents(),o.consents.preConsent.value.enabled===!0?o.lifecycle.status.value="ready":this.loadDestinations()}onMounted(){this.capabilitiesManager.init()}enqueuePreloadBufferEvents(e){Array.isArray(e)&&e.forEach(t=>this.preloadBuffer.enqueue(R(t)))}processDataInPreloadBuffer(){for(;this.preloadBuffer.size()>0;){const e=this.preloadBuffer.dequeue();e&&Xs([...e],this)}}prepareInternalServices(){this.pluginsManager=new eo(Pn,this.errorHandler,this.logger),this.storeManager=new Wo(this.pluginsManager,this.errorHandler,this.logger),this.configManager=new Ra(this.httpClient,this.errorHandler,this.logger),this.userSessionManager=new Ja(this.errorHandler,this.logger,this.pluginsManager,this.storeManager,this.httpClient),this.eventRepository=new rl(this.pluginsManager,this.storeManager,this.errorHandler,this.logger),this.eventManager=new Xa(this.eventRepository,this.userSessionManager,this.errorHandler,this.logger)}loadConfig(){var e;o.lifecycle.writeKey.value&&this.httpClient.setAuthHeader(o.lifecycle.writeKey.value),(e=this.configManager)==null||e.init()}onPluginsReady(){var e,t,s,i,r;this.errorHandler.init(this.externalSrcLoader),(e=this.storeManager)==null||e.init(),(t=this.userSessionManager)==null||t.init(),o.consents.enabled.value&&!o.consents.initialized.value&&((s=this.pluginsManager)==null||s.invokeSingle("consentManager.init",o,this.logger),o.consents.preConsent.value.enabled===!1&&((i=this.pluginsManager)==null||i.invokeSingle("consentManager.updateConsentsInfo",o,this.storeManager,this.logger))),(r=this.eventManager)==null||r.init(),o.lifecycle.status.value="initialized"}onConfigured(){var e;(e=this.pluginsManager)==null||e.init()}onInitialized(){this.processDataInPreloadBuffer(),f(o.loadOptions.value.onLoaded)&&o.loadOptions.value.onLoaded(globalThis.rudderanalytics),M(()=>{o.lifecycle.loaded.value=!0,o.lifecycle.status.value="loaded"}),this.initialized=!0,tn("RSA_Initialised")}onReady(){o.lifecycle.status.value="readyExecuted",o.eventBuffer.readyCallbacksArray.value.forEach(e=>{try{e()}catch(t){this.errorHandler.onError(t,Qe,Bt)}}),tn("RSA_Ready")}processBufferedEvents(){let e=o.eventBuffer.toBeProcessedArray.value;for(;e.length>0;){const t=e.shift();if(o.eventBuffer.toBeProcessedArray.value=e,t){const s=t[0];f(this[s])&&this[s](...t.slice(1),!0)}e=o.eventBuffer.toBeProcessedArray.value}}loadDestinations(){var t,s;if(o.nativeDestinations.clientDestinationsReady.value)return;(t=this.pluginsManager)==null||t.invokeSingle("nativeDestinations.setActiveDestinations",o,this.pluginsManager,this.errorHandler,this.logger);const e=o.nativeDestinations.activeDestinations.value.length;if(e===0){o.lifecycle.status.value="destinationsReady";return}o.lifecycle.status.value="destinationsLoading",(s=this.pluginsManager)==null||s.invokeSingle("nativeDestinations.load",o,this.externalSrcLoader,this.errorHandler,this.logger),z(()=>{(e===0||o.nativeDestinations.initializedDestinations.value.length+o.nativeDestinations.failedDestinations.value.length===e)&&M(()=>{o.lifecycle.status.value="destinationsReady",o.nativeDestinations.clientDestinationsReady.value=!0})})}onDestinationsReady(){o.lifecycle.status.value!=="ready"&&(o.lifecycle.status.value="ready")}ready(e,t=!1){const s="ready";if(!o.lifecycle.loaded.value){o.eventBuffer.toBeProcessedArray.value=[...o.eventBuffer.toBeProcessedArray.value,[s,e]];return}if(this.errorHandler.leaveBreadcrumb(`New ${s} invocation`),!f(e)){this.logger.error(Mi(Ns));return}if(o.lifecycle.status.value==="readyExecuted")try{e()}catch(i){this.errorHandler.onError(i,Qe,Bt)}else o.eventBuffer.readyCallbacksArray.value=[...o.eventBuffer.readyCallbacksArray.value,e]}page(e,t=!1){var i;const s="page";if(!o.lifecycle.loaded.value){o.eventBuffer.toBeProcessedArray.value=[...o.eventBuffer.toBeProcessedArray.value,[s,e]];return}this.errorHandler.leaveBreadcrumb(`New ${s} event`),o.metrics.triggered.value+=1,(i=this.eventManager)==null||i.addEvent({type:"page",category:e.category,name:e.name,properties:e.properties,options:e.options,callback:e.callback}),o.capabilities.isAdBlocked.value===!0&&e.category!==Pt&&this.page(Ue(Pt,Us,{path:Bs},o.loadOptions.value.sendAdblockPageOptions))}track(e,t=!1){var i;const s="track";if(!o.lifecycle.loaded.value){o.eventBuffer.toBeProcessedArray.value=[...o.eventBuffer.toBeProcessedArray.value,[s,e]];return}this.errorHandler.leaveBreadcrumb(`New ${s} event`),o.metrics.triggered.value+=1,(i=this.eventManager)==null||i.addEvent({type:s,name:e.name||void 0,properties:e.properties,options:e.options,callback:e.callback})}identify(e,t=!1){var r,a,l;const s="identify";if(!o.lifecycle.loaded.value){o.eventBuffer.toBeProcessedArray.value=[...o.eventBuffer.toBeProcessedArray.value,[s,e]];return}this.errorHandler.leaveBreadcrumb(`New ${s} event`),o.metrics.triggered.value+=1,!!(e.userId&&o.session.userId.value&&e.userId!==o.session.userId.value)&&this.reset(),F(e.userId)||(r=this.userSessionManager)==null||r.setUserId(e.userId),(a=this.userSessionManager)==null||a.setUserTraits(e.traits),(l=this.eventManager)==null||l.addEvent({type:s,userId:e.userId,traits:e.traits,options:e.options,callback:e.callback})}alias(e,t=!1){var r,a,l;const s="alias";if(!o.lifecycle.loaded.value){o.eventBuffer.toBeProcessedArray.value=[...o.eventBuffer.toBeProcessedArray.value,[s,e]];return}this.errorHandler.leaveBreadcrumb(`New ${s} event`),o.metrics.triggered.value+=1;const i=e.from??((r=this.userSessionManager)==null?void 0:r.getUserId())??((a=this.userSessionManager)==null?void 0:a.getAnonymousId());(l=this.eventManager)==null||l.addEvent({type:s,to:e.to,from:i,options:e.options,callback:e.callback})}group(e,t=!1){var i,r,a;const s="group";if(!o.lifecycle.loaded.value){o.eventBuffer.toBeProcessedArray.value=[...o.eventBuffer.toBeProcessedArray.value,[s,e]];return}this.errorHandler.leaveBreadcrumb(`New ${s} event`),o.metrics.triggered.value+=1,F(e.groupId)||(i=this.userSessionManager)==null||i.setGroupId(e.groupId),(r=this.userSessionManager)==null||r.setGroupTraits(e.traits),(a=this.eventManager)==null||a.addEvent({type:s,groupId:e.groupId,traits:e.traits,options:e.options,callback:e.callback})}reset(e,t=!1){var i;const s="reset";if(!o.lifecycle.loaded.value){o.eventBuffer.toBeProcessedArray.value=[...o.eventBuffer.toBeProcessedArray.value,[s,e]];return}this.errorHandler.leaveBreadcrumb(`New ${s} invocation, resetAnonymousId: ${e}`),(i=this.userSessionManager)==null||i.reset(e)}getAnonymousId(e){var t;return(t=this.userSessionManager)==null?void 0:t.getAnonymousId(e)}setAnonymousId(e,t,s=!1){var r;const i="setAnonymousId";if(!o.lifecycle.loaded.value){o.eventBuffer.toBeProcessedArray.value=[...o.eventBuffer.toBeProcessedArray.value,[i,e,t]];return}this.errorHandler.leaveBreadcrumb(`New ${i} invocation`),(r=this.userSessionManager)==null||r.setAnonymousId(e,t)}getUserId(){return o.session.userId.value}getUserTraits(){return o.session.userTraits.value}getGroupId(){return o.session.groupId.value}getGroupTraits(){return o.session.groupTraits.value}startSession(e,t=!1){var i;const s="startSession";if(!o.lifecycle.loaded.value){o.eventBuffer.toBeProcessedArray.value=[...o.eventBuffer.toBeProcessedArray.value,[s,e]];return}this.errorHandler.leaveBreadcrumb(`New ${s} invocation`),(i=this.userSessionManager)==null||i.start(e)}endSession(e=!1){var s;const t="endSession";if(!o.lifecycle.loaded.value){o.eventBuffer.toBeProcessedArray.value=[...o.eventBuffer.toBeProcessedArray.value,[t]];return}this.errorHandler.leaveBreadcrumb(`New ${t} invocation`),(s=this.userSessionManager)==null||s.end()}getSessionId(){var t;return((t=this.userSessionManager)==null?void 0:t.getSessionId())??null}consent(e,t=!1){var i,r,a,l;const s="consent";if(!o.lifecycle.loaded.value){o.eventBuffer.toBeProcessedArray.value=[...o.eventBuffer.toBeProcessedArray.value,[s,e]];return}this.errorHandler.leaveBreadcrumb("New consent invocation"),M(()=>{o.consents.preConsent.value={...o.consents.preConsent.value,enabled:!1},o.consents.postConsent.value=da(e);const{initialized:c,consentsData:u}=Gn(o.consents.postConsent.value.consentManagement,this.logger);o.consents.initialized.value=c||o.consents.initialized.value,o.consents.data.value=u}),o.consents.enabled.value&&!o.consents.initialized.value&&((i=this.pluginsManager)==null||i.invokeSingle("consentManager.updateConsentsInfo",o,this.storeManager,this.logger)),(r=this.storeManager)==null||r.initializeStorageState(),(a=this.userSessionManager)==null||a.syncStorageDataToState(),(l=this.eventManager)==null||l.resume(),this.loadDestinations(),this.sendTrackingEvents(t)}sendTrackingEvents(e){if(o.consents.postConsent.value.trackConsent){const t=mt($s);e?o.eventBuffer.toBeProcessedArray.value=[...o.eventBuffer.toBeProcessedArray.value,["track",t]]:this.track(t)}if(o.consents.postConsent.value.sendPageEvent){const t=Ue();e?o.eventBuffer.toBeProcessedArray.value=[...o.eventBuffer.toBeProcessedArray.value,["page",t]]:this.page(t)}}setAuthToken(e){var t;(t=this.userSessionManager)==null||t.setAuthToken(e)}}const le=class le{constructor(){S(this,"analyticsInstances",{});S(this,"defaultAnalyticsKey","");S(this,"logger",H);if(le.globalSingleton)return le.globalSingleton;He.attachErrorListeners(),this.setDefaultInstanceKey=this.setDefaultInstanceKey.bind(this),this.getAnalyticsInstance=this.getAnalyticsInstance.bind(this),this.load=this.load.bind(this),this.ready=this.ready.bind(this),this.triggerBufferedLoadEvent=this.triggerBufferedLoadEvent.bind(this),this.page=this.page.bind(this),this.track=this.track.bind(this),this.identify=this.identify.bind(this),this.alias=this.alias.bind(this),this.group=this.group.bind(this),this.reset=this.reset.bind(this),this.getAnonymousId=this.getAnonymousId.bind(this),this.setAnonymousId=this.setAnonymousId.bind(this),this.getUserId=this.getUserId.bind(this),this.getUserTraits=this.getUserTraits.bind(this),this.getGroupId=this.getGroupId.bind(this),this.getGroupTraits=this.getGroupTraits.bind(this),this.startSession=this.startSession.bind(this),this.endSession=this.endSession.bind(this),this.getSessionId=this.getSessionId.bind(this),this.setAuthToken=this.setAuthToken.bind(this),this.consent=this.consent.bind(this),le.globalSingleton=this,this.triggerBufferedLoadEvent(),globalThis.rudderanalytics=this}setDefaultInstanceKey(e){e&&(this.defaultAnalyticsKey=e)}getAnalyticsInstance(e){const t=e??this.defaultAnalyticsKey;return!!this.analyticsInstances[t]||(this.analyticsInstances[t]=new nn),this.analyticsInstances[t]}load(e,t,s){if(!N(e)){this.logger.error(nr(_t,e));return}this.analyticsInstances[e]||(this.setDefaultInstanceKey(e),this.analyticsInstances[e]=new nn,this.getAnalyticsInstance(e).load(e,t,s))}triggerBufferedLoadEvent(){const e=Array.isArray(globalThis.rudderanalytics)?globalThis.rudderanalytics:[];Ws(e);const t=qs(e);Fe(it,R(e)),t.length>0&&(t.shift(),this.load.apply(null,t))}ready(e){this.getAnalyticsInstance().ready(e)}page(e,t,s,i,r){this.getAnalyticsInstance().page(Ue(e,t,s,i,r))}track(e,t,s,i){this.getAnalyticsInstance().track(mt(e,t,s,i))}identify(e,t,s,i){this.getAnalyticsInstance().identify(ln(e,t,s,i))}alias(e,t,s,i){this.getAnalyticsInstance().alias(cn(e,t,s,i))}group(e,t,s,i){if(arguments.length===0){this.logger.error(sr(_t));return}this.getAnalyticsInstance().group(un(e,t,s,i))}reset(e){this.getAnalyticsInstance().reset(e)}getAnonymousId(e){return this.getAnalyticsInstance().getAnonymousId(e)}setAnonymousId(e,t){this.getAnalyticsInstance().setAnonymousId(e,t)}getUserId(){return this.getAnalyticsInstance().getUserId()}getUserTraits(){return this.getAnalyticsInstance().getUserTraits()}getGroupId(){return this.getAnalyticsInstance().getGroupId()}getGroupTraits(){return this.getAnalyticsInstance().getGroupTraits()}startSession(e){return this.getAnalyticsInstance().startSession(e)}endSession(){return this.getAnalyticsInstance().endSession()}getSessionId(){return this.getAnalyticsInstance().getSessionId()}setAuthToken(e){return this.getAnalyticsInstance().setAuthToken(e)}consent(e){return this.getAnalyticsInstance().consent(e)}};S(le,"globalSingleton",null);let pt=le;function zn(n=0){if(n>5)return!1;setTimeout(()=>{if(window.htmx)return!0;zn(n+1)},500)}function ol(){const n=document.querySelector('[name="fields[anonymous_id]"]');n!==null?(n.value=he.getAnonymousId(),console.log("RudderStack Field Update complete - ",he.getAnonymousId())):console.log("anonymousIdField is null")}const he=new pt;he.load("2Fivwkm2WzdbgiuTksdgWz729mz","https://conversionwbv.dataplane.rudderstack.com",{storage:{encryption:{version:"legacy"}}});he.ready(()=>{zn(),he.getAnonymousId(),window.addEventListener("onBeforeFormieSubmit",()=>{ol()})});he.page();function al(){let n=null,e=null;document.addEventListener("afterBlitzInjectAll",function(){n=document.getElementById("socialShare"),e=document.getElementById("referrerSelectInput"),n&&s()});function t(i,r){const a=new Date(new Date().getTime()+31536e6);tt.set(i,r,{expires:a})}function s(){n.addEventListener("submit",function(i){i.preventDefault();const r=document.querySelector("#jobSearch input"),a=r?Array.from(r):[],l=`${window.location.origin}${window.location.pathname}`,c=new URL(l);a.filter(u=>u.value!=="").forEach(u=>c.searchParams.append(u.name,u.value)),t("social-role",e.value),c.searchParams.append("r",e.value),navigator.clipboard.writeText(c.href).then(()=>{const u=document.createElement("div");u.classList.add("clipboard"),u.textContent="Copied to clipboard",document.body.appendChild(u),setTimeout(()=>{document.body.removeChild(u)},2e3)}).catch(u=>{console.error("Failed to copy URL: ",u)})})}}al();function ll(){const n=document.querySelector("#jobSearch");if(!n)return;const e=n.querySelector(".city-container"),t=n.querySelector("#city"),s=n.querySelector("#state"),i=n.querySelector("#zip"),r=n.querySelector(".jobs-search-btn");let a=!1,l=!1;const c=document.createElement("div");c.classList.add("tool-tip"),c.textContent="When searching a job by location, please enter a state or a valid zip code";const u=document.createElement("button");u.textContent="✕",u.setAttribute("type","button"),c.appendChild(u);function h(){const p=t.value,b=s.value,E=i.value;p&&!b&&!E?v():A()}function v(){r.setAttribute("disabled",""),!a&&!l&&g()}function A(){r.removeAttribute("disabled"),a&&g()}function g(){a=!a,a?e.appendChild(c):e.removeChild(c)}s.addEventListener("input",h),i.addEventListener("input",h),t.addEventListener("input",h),u.addEventListener("click",()=>{g(),l=!0})}ll();
//# sourceMappingURL=site.js.map
