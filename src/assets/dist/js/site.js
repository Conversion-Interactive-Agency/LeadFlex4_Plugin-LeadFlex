(function(){var es=Object.defineProperty;var ts=(n,e,t)=>e in n?es(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var S=(n,e,t)=>(ts(n,typeof e!="symbol"?e+"":e,t),t);function ns(){const n=document.querySelector("#jobSearch");if(!n)return;const e=n.querySelector(".city-container"),t=n.querySelector("#city"),s=n.querySelector("#state"),i=n.querySelector("#zip"),r=n.querySelector(".jobs-search-btn");let a=!1,l=!1;const c=document.createElement("div");c.classList.add("tool-tip"),c.textContent="When searching a job by location, please enter a state or a valid zip code";const u=document.createElement("button");u.textContent="âœ•",u.setAttribute("type","button"),c.appendChild(u);function h(){const p=t.value,m=s.value,E=i.value;p&&!m&&!E?v():T()}function v(){r.setAttribute("disabled",""),!a&&!l&&g()}function T(){r.removeAttribute("disabled"),a&&g()}function g(){a=!a,a?e.appendChild(c):e.removeChild(c)}s.addEventListener("input",h),i.addEventListener("input",h),t.addEventListener("input",h),u.addEventListener("click",()=>{g(),l=!0})}ns();function ss(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var xe={exports:{}};xe.exports=vt;xe.exports.isMobile=vt;xe.exports.default=vt;const is=/(android|bb\d+|meego).+mobile|armv7l|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|samsungbrowser.*mobile|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,rs=/CrOS/,os=/android|ipad|playbook|silk/i;function vt(n){n||(n={});let e=n.ua;if(!e&&typeof navigator<"u"&&(e=navigator.userAgent),e&&e.headers&&typeof e.headers["user-agent"]=="string"&&(e=e.headers["user-agent"]),typeof e!="string")return!1;let t=is.test(e)&&!rs.test(e)||!!n.tablet&&os.test(e);return!t&&n.tablet&&n.featureDetect&&navigator&&navigator.maxTouchPoints>1&&e.indexOf("Macintosh")!==-1&&e.indexOf("Safari")!==-1&&(t=!0),t}var as=xe.exports;const ls=ss(as);/*! js-cookie v3.0.5 | MIT */function Ae(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)n[s]=t[s]}return n}var cs={read:function(n){return n[0]==='"'&&(n=n.slice(1,-1)),n.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(n){return encodeURIComponent(n).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function et(n,e){function t(i,r,a){if(!(typeof document>"u")){a=Ae({},e,a),typeof a.expires=="number"&&(a.expires=new Date(Date.now()+a.expires*864e5)),a.expires&&(a.expires=a.expires.toUTCString()),i=encodeURIComponent(i).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var l="";for(var c in a)a[c]&&(l+="; "+c,a[c]!==!0&&(l+="="+a[c].split(";")[0]));return document.cookie=i+"="+n.write(r,i)+l}}function s(i){if(!(typeof document>"u"||arguments.length&&!i)){for(var r=document.cookie?document.cookie.split("; "):[],a={},l=0;l<r.length;l++){var c=r[l].split("="),u=c.slice(1).join("=");try{var h=decodeURIComponent(c[0]);if(a[h]=n.read(u,h),i===h)break}catch{}}return i?a[i]:a}}return Object.create({set:t,get:s,remove:function(i,r){t(i,"",Ae({},r,{expires:-1}))},withAttributes:function(i){return et(this.converter,Ae({},this.attributes,i))},withConverter:function(i){return et(Ae({},this.converter,i),this.attributes)}},{attributes:{value:Object.freeze(e)},converter:{value:Object.freeze(n)}})}var tt=et(cs,{path:"/"});function us(){const n="exitModal",e=document.querySelector(`#${n}`),t=!!e,s=ls(),i=!!tt.get(`modal.${n}`);function r(){new bootstrap.Modal(`#${n}`).show(),tt.set(`modal.${n}`,"1",{expires:1})}function a(){s?setTimeout(r,6e3):document.addEventListener("mouseleave",r,{once:!0})}function l(){a(),u()}function c(v=0){setTimeout(()=>{typeof window.bootstrap<"u"?l():v<10&&c(v+1)},500)}t&&!i&&c();function u(){const g=e.dataset.referrer+"_eb";h(g)}function h(v){const T=e.dataset.utmSource,g=new URL("#quickApp",location);g.searchParams.set("utm_source",T),g.searchParams.set("utm_campaign",v),g.searchParams.set("utm_medium","eb"),g.searchParams.set("r",v),document.getElementById("exitbannerLink").href=g.href}}us();function ds(){const n=document.querySelector('[data-component="lead-assist"]');if(!n)return;const e=n.getElementsByClassName("collapsible");for(let s=0;s<e.length;s++)e[s].addEventListener("click",function(){t(this)});function t(s){s.classList.toggle("active");const i=s.nextElementSibling;i&&i.classList.toggle("block")}(function(s,i,r){let a;const l=s.getElementsByTagName(i)[0];s.getElementById(r)||(a=s.createElement(i),a.id=r,a.src="https://connect.facebook.net/en_US/sdk/xfbml.customerchat.js",l.parentNode.insertBefore(a,l))})(document,"script","facebook-jssdk")}ds();function gs(){const n=document.getElementById("nav"),e=document.getElementById("mobile-icon"),t=document.querySelector("#mobile-icon > svg > use");function s(){n.classList.toggle("block"),n.classList.toggle("active"),t.setAttribute("xlink:href","#close"),e.title="Close Menu",!n.classList.contains("block")&&!n.classList.contains("active")&&(t.setAttribute("xlink:href","#solid-bars"),e.title="Open Menu")}e==null||e.addEventListener("click",s)}gs();const hs="modulepreload",fs=function(n){return"/"+n},Rt={},ps=function(e,t,s){if(!t||t.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(t.map(r=>{if(r=fs(r),r in Rt)return;Rt[r]=!0;const a=r.endsWith(".css"),l=a?'[rel="stylesheet"]':"";if(!!s)for(let h=i.length-1;h>=0;h--){const v=i[h];if(v.href===r&&(!a||v.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${r}"]${l}`))return;const u=document.createElement("link");if(u.rel=a?"stylesheet":hs,a||(u.as="script",u.crossOrigin=""),u.href=r,document.head.appendChild(u),a)return new Promise((h,v)=>{u.addEventListener("load",h),u.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>e()).catch(r=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=r,window.dispatchEvent(a),!a.defaultPrevented)throw r})};function O(n){return n!=null&&typeof n=="object"&&n["@@functional/placeholder"]===!0}function Q(n){return function e(t){return arguments.length===0||O(t)?e:n.apply(this,arguments)}}function W(n){return function e(t,s){switch(arguments.length){case 0:return e;case 1:return O(t)?e:Q(function(i){return n(t,i)});default:return O(t)&&O(s)?e:O(t)?Q(function(i){return n(i,s)}):O(s)?Q(function(i){return n(t,i)}):n(t,s)}}}function Et(n){return function e(t,s,i){switch(arguments.length){case 0:return e;case 1:return O(t)?e:W(function(r,a){return n(t,r,a)});case 2:return O(t)&&O(s)?e:O(t)?W(function(r,a){return n(r,s,a)}):O(s)?W(function(r,a){return n(t,r,a)}):Q(function(r){return n(t,s,r)});default:return O(t)&&O(s)&&O(i)?e:O(t)&&O(s)?W(function(r,a){return n(r,a,i)}):O(t)&&O(i)?W(function(r,a){return n(r,s,a)}):O(s)&&O(i)?W(function(r,a){return n(t,r,a)}):O(t)?Q(function(r){return n(r,s,i)}):O(s)?Q(function(r){return n(t,r,i)}):O(i)?Q(function(r){return n(t,s,r)}):n(t,s,i)}}}function _e(n,e){return Object.prototype.hasOwnProperty.call(e,n)}var vs=Q(function(e){return e===null?"Null":e===void 0?"Undefined":Object.prototype.toString.call(e).slice(8,-1)});function It(n){return Object.prototype.toString.call(n)==="[object Object]"}const Es=Number.isInteger||function(e){return e<<0===e};function ms(n){return Object.prototype.toString.call(n)==="[object String]"}function ys(n,e){var t=n<0?e.length+n:n;return ms(e)?e.charAt(t):e[t]}function bs(n){return new RegExp(n.source,n.flags?n.flags:(n.global?"g":"")+(n.ignoreCase?"i":"")+(n.multiline?"m":"")+(n.sticky?"y":"")+(n.unicode?"u":"")+(n.dotAll?"s":""))}function on(n,e,t){if(t||(t=new Rs),Ss(n))return n;var s=function(r){var a=t.get(n);if(a)return a;t.set(n,r);for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(r[l]=on(n[l],!0,t));return r};switch(vs(n)){case"Object":return s(Object.create(Object.getPrototypeOf(n)));case"Array":return s(Array(n.length));case"Date":return new Date(n.valueOf());case"RegExp":return bs(n);case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":return n.slice();default:return n}}function Ss(n){var e=typeof n;return n==null||e!="object"&&e!="function"}var Rs=function(){function n(){this.map={},this.length=0}return n.prototype.set=function(e,t){var s=this.hash(e),i=this.map[s];i||(this.map[s]=i=[]),i.push([e,t]),this.length+=1},n.prototype.hash=function(e){var t=[];for(var s in e)t.push(Object.prototype.toString.call(e[s]));return t.join()},n.prototype.get=function(e){if(this.length<=180){for(var t in this.map)for(var a=this.map[t],s=0;s<a.length;s+=1){var i=a[s];if(i[0]===e)return i[1]}return}var r=this.hash(e),a=this.map[r];if(a)for(var s=0;s<a.length;s+=1){var i=a[s];if(i[0]===e)return i[1]}},n}(),R=Q(function(e){return e!=null&&typeof e.clone=="function"?e.clone():on(e)});function Is(n,e){for(var t=e,s=0;s<n.length;s+=1){if(t==null)return;var i=n[s];Es(i)?t=ys(i,t):t=t[i]}return t}var Ts=Et(function(e,t,s){var i={},r;t=t||{},s=s||{};for(r in t)_e(r,t)&&(i[r]=_e(r,s)?e(r,t[r],s[r]):t[r]);for(r in s)_e(r,s)&&!_e(r,i)&&(i[r]=s[r]);return i}),As=Et(function n(e,t,s){return Ts(function(i,r,a){return It(r)&&It(a)?n(e,r,a):e(i,r,a)},t,s)}),_s=Et(function(e,t,s){return As(function(i,r,a){return e(r,a)},t,s)}),Os=W(Is),an=W(function(e,t){var s={};for(var i in t)e(t[i],i,t)&&(s[i]=t[i]);return s});const f=n=>typeof n=="function"&&!!(n.constructor&&n.call&&n.apply),N=n=>typeof n=="string",F=n=>n===null,L=n=>typeof n>"u",H=n=>F(n)||L(n),_=n=>!L(n),de=n=>!H(n),Ps=n=>de(n)&&n!=="",ln=n=>n instanceof Error,nt=(n,e)=>{const t=e.split(".");return Os(t,n)},ks=(n,e)=>!!nt(n,e),cn=n=>!F(n)&&typeof n=="object"&&!Array.isArray(n),y=n=>!F(n)&&Object.prototype.toString.call(n)==="[object Object]",Cs=(n,e)=>{if(!Array.isArray(n)||!Array.isArray(e))return R(e);const t=R(n);return e.forEach((s,i)=>{t[i]=Array.isArray(s)||cn(s)?k(t[i],s):s}),t},k=(n,e)=>_s(Cs,n,e),Ge=n=>y(n)&&Object.keys(n).length>0,pe=n=>{const e=an(_,n);return Object.keys(e).forEach(t=>{const s=e[t];y(s)&&(e[t]=pe(s))}),e},te=n=>{const e=an(de,n);return Object.keys(e).forEach(t=>{const s=e[t];y(s)&&(e[t]=te(s))}),e},Ns=n=>n.replace(/^\s+|\s+$/gm,""),Ls=n=>n.replace(/ {2,}/g," "),Tt=n=>n.replace(/^\.+/,""),Me=n=>{let e=n;if(!N(n)&&!H(n))try{e=JSON.stringify(n)}catch{e=null}return e},Ds=n=>{const e=Array.from(n,t=>String.fromCodePoint(t)).join("");return globalThis.btoa(e)},ws=n=>Ds(new TextEncoder().encode(n)),Ue=(n,e,t,s,i)=>{const r={category:n,name:e,properties:t,options:s};return f(i)&&(r.callback=i),f(s)&&(r.category=n,r.name=e,r.properties=t,delete r.options,r.callback=s),f(t)&&(r.category=n,r.name=e,delete r.properties,delete r.options,r.callback=t),f(e)&&(r.category=n,delete r.name,delete r.properties,delete r.options,r.callback=e),f(n)&&(delete r.category,delete r.name,delete r.properties,delete r.options,r.callback=n),y(n)?(delete r.name,delete r.category,r.properties=n,r.options=e):y(e)&&(delete r.name,r.properties=e,r.options=f(t)?null:t),N(n)&&!N(e)&&(delete r.category,r.name=n),_(r.category)||delete r.category,_(r.name)||delete r.name,r.properties=r.properties?R(r.properties):{},_(r.options)?r.options=R(r.options):delete r.options,r.properties=k(y(r.properties)?r.properties:{},{name:N(r.name)?r.name:null,category:N(r.category)?r.category:null}),r},mt=(n,e,t,s)=>{const i={name:n,properties:e,options:t};return f(s)&&(i.callback=s),f(t)&&(i.properties=e,delete i.options,i.callback=t),f(e)&&(delete i.properties,delete i.options,i.callback=e),i.properties=de(i.properties)?R(i.properties):{},_(i.options)?i.options=R(i.options):delete i.options,i},un=(n,e,t,s)=>{const i={userId:n,traits:e,options:t};return f(s)&&(i.callback=s),f(t)&&(i.userId=n,i.traits=e,delete i.options,i.callback=t),f(e)&&(i.userId=n,delete i.traits,delete i.options,i.callback=e),(y(n)||F(n))&&(i.userId=null,i.traits=n,i.options=e),_(i.userId)?i.userId=Me(i.userId):delete i.userId,y(i.traits)?i.traits=R(i.traits):delete i.traits,_(i.options)?i.options=R(i.options):delete i.options,i},dn=(n,e,t,s)=>{const i={to:n,from:e,options:t};return f(s)&&(i.callback=s),f(t)&&(i.to=n,i.from=e,delete i.options,i.callback=t),f(e)?(i.to=n,delete i.from,delete i.options,i.callback=e):(y(e)||F(e))&&(i.to=n,delete i.from,i.options=e),f(n)?(delete i.to,delete i.from,delete i.options,i.callback=n):(y(n)||F(n))&&(delete i.to,delete i.from,i.options=n),_(i.to)?i.to=Me(i.to):delete i.to,_(i.from)?i.from=Me(i.from):delete i.from,_(i.options)?i.options=R(i.options):delete i.options,i},gn=(n,e,t,s)=>{const i={groupId:n,traits:e,options:t};return f(s)&&(i.callback=s),f(t)&&(i.groupId=n,i.traits=e,delete i.options,i.callback=t),f(e)&&(i.groupId=n,delete i.traits,delete i.options,i.callback=e),f(n)?(i.groupId=null,delete i.traits,delete i.options,i.callback=n):(y(n)||F(n))&&(i.groupId=null,i.traits=n,i.options=f(e)?null:e),_(i.groupId)?i.groupId=Me(i.groupId):delete i.groupId,i.traits=y(i.traits)?R(i.traits):{},_(i.options)?i.options=R(i.options):delete i.options,i},st="CapabilitiesManager",j="ConfigManager",hn="EventManager",At="PluginsManager",ve="UserSessionManager",Oe="ErrorHandler",re="PluginEngine",_t="StoreManager",Ms="readyApi",Us="EventRepository",Bs="ExternalSrcLoader",$s="HttpClient",Ot="RudderStackApplication",Qe="AnalyticsCore",Pt="RudderLabs JavaScript SDK",ye="3.6.1",xs="com.rudderlabs.javascript",fn="npm",kt="RudderJS-Initiated",Gs="ad-block page request",Fs="/ad-blocked",it="preloadedEventsBuffer",js="Consent Management Interaction",Hs="ajs_trait_",Vs="ajs_prop_",Ct="ajs_aid",Nt="ajs_uid",Lt="ajs_event",Ks=10*1e3,Qs=31536e3*1e3,be=30*60*1e3,Dt=10*1e3,zs=10*1e3,qs=250,pn=(n="app")=>{globalThis.RudderStackGlobals||(globalThis.RudderStackGlobals={}),globalThis.RudderStackGlobals[n]||(globalThis.RudderStackGlobals[n]={})},Fe=(n,e,t="app")=>{pn(t),globalThis.RudderStackGlobals[t][n]=e},Ws=(n,e="app")=>(pn(e),globalThis.RudderStackGlobals[e][n]);function Ys(n,e,t=qs){let s;return(...i)=>{globalThis.clearTimeout(s),s=globalThis.setTimeout(()=>{n.apply(e,i)},t)}}const wt=(n,e)=>{const t={};return n.forEach((s,i)=>{if(i.startsWith(e)){const r=i.substring(e.length);t[r]=n.get(i)}}),t},Xs=(n=[])=>{const e={trait:Hs,properties:Vs},t=new URLSearchParams(globalThis.location.search);t.get(Lt)&&n.unshift(["track",t.get(Lt),wt(t,e.properties)]),t.get(Nt)&&n.unshift(["identify",t.get(Nt),wt(t,e.trait)]),t.get(Ct)&&n.unshift(["setAnonymousId",t.get(Ct)])},Js=n=>{const e="load";let t=[],s=0;for(;s<n.length;){if(n[s]&&n[s][0]===e){t=R(n[s]),n.splice(s,1);break}s+=1}return t},Zs=n=>{const e="consent",t=n.filter(i=>i[0]===e),s=n.filter(i=>i[0]!==e);n.splice(0,n.length,...t,...s)},ei=n=>{const e=Ws(it)||[];Xs(e),e.length>0&&(n.enqueuePreloadBufferEvents(e),Fe(it,[]))},ti=(n,e)=>{const t=n.shift();let s;if(f(e[t])){switch(t){case"page":s=Ue(...n);break;case"track":s=mt(...n);break;case"identify":s=un(...n);break;case"alias":s=dn(...n);break;case"group":s=gn(...n);break;default:e[t](...n);break}s&&e[t](s)}},ni=10*1e3,b=":: ",si=n=>`A script with the id "${n}" is already loaded. Skipping the loading of this script to prevent conflicts.`,Mt=(n,e)=>`Failed to load the script with the id "${n}" from URL "${e}".`,ii=(n,e,t)=>`A timeout of ${t} ms occurred while trying to load the script with id "${n}" from URL "${e}".`,ri=(n,e)=>`${n}${b}A circular reference has been detected in the object and the property "${e}" has been dropped from the output.`,oi="Failed to convert the value to a JSON string.",ai="JSONStringify",li=(n,e,t)=>{const s=[];return function(i,r){if(!(e!=null&&e.includes(i))&&!(n&&H(r))){if(typeof r!="object"||F(r))return r;for(;s.length>0&&s[s.length-1]!==this;)s.pop();return s.includes(r)?(t==null||t.warn(ri(ai,i)),"[Circular Reference]"):(s.push(r),r)}}},X=(n,e,t,s)=>{try{return JSON.stringify(n,li(e,t,s))}catch(i){return s==null||s.warn(oi,i),null}},Re=(n,e)=>{let t=n;return ln(n)?t.message=`${e}: ${n.message}`:t=new Error(`${e}: ${X(n)}`),t},ci="RS_JS_SDK",ui=(n,e,t=!0,s=null,i=null,r={})=>{const a=document.createElement("script");return a.type="text/javascript",a.onload=s,a.onerror=i,a.src=n,a.id=e,a.async=t,Object.keys(r).forEach(l=>{a.setAttribute(l,r[l])}),a.setAttribute("data-loader",ci),a},di=n=>{var r,a,l,c;const e=document.getElementsByTagName("head");if(e.length>0){(a=e[0])==null||a.insertBefore(n,(r=e[0])==null?void 0:r.firstChild);return}const t=document.getElementsByTagName("script");if(t.length>0&&((l=t[0])!=null&&l.parentNode)){(c=t[0])==null||c.parentNode.insertBefore(n,t[0]);return}const s=document.createElement("head");s.appendChild(n);const i=document.getElementsByTagName("html")[0];i==null||i.insertBefore(s,i.firstChild)},gi=(n,e,t,s=!0,i)=>new Promise((r,a)=>{document.getElementById(e)&&a(new Error(si(e)));try{let c;di(ui(n,e,s,()=>{globalThis.clearTimeout(c),r(e)},()=>{globalThis.clearTimeout(c),a(new Error(Mt(e,n)))},i)),c=globalThis.setTimeout(()=>{a(new Error(ii(e,n,t)))},t)}catch(c){a(Re(c,Mt(e,n)))}});class vn{constructor(e,t,s=ni){S(this,"hasErrorHandler",!1);this.errorHandler=e,this.logger=t,this.timeout=s,this.hasErrorHandler=!!this.errorHandler,this.onError=this.onError.bind(this)}loadJSFile(e){const{url:t,id:s,timeout:i,async:r,callback:a,extraAttributes:l}=e,c=!f(a);gi(t,s,i||this.timeout,r,l).then(u=>{c||a(u)}).catch(u=>{this.onError(u),c||a()})}onError(e){var t;if(this.hasErrorHandler)(t=this.errorHandler)==null||t.onError(e,Bs);else throw e}}var hi=Symbol.for("preact-signals");function je(){if(Z>1)Z--;else{for(var n,e=!1;me!==void 0;){var t=me;for(me=void 0,rt++;t!==void 0;){var s=t.o;if(t.o=void 0,t.f&=-3,!(8&t.f)&&mn(t))try{t.c()}catch(i){e||(n=i,e=!0)}t=s}}if(rt=0,Z--,e)throw n}}function M(n){if(Z>0)return n();Z++;try{return n()}finally{je()}}var A=void 0,me=void 0,Z=0,rt=0,Be=0;function En(n){if(A!==void 0){var e=n.n;if(e===void 0||e.t!==A)return e={i:0,S:n,p:A.s,n:void 0,t:A,e:void 0,x:void 0,r:e},A.s!==void 0&&(A.s.n=e),A.s=e,n.n=e,32&A.f&&n.S(e),e;if(e.i===-1)return e.i=0,e.n!==void 0&&(e.n.p=e.p,e.p!==void 0&&(e.p.n=e.n),e.p=A.s,e.n=void 0,A.s.n=e,A.s=e),e}}function U(n){this.v=n,this.i=0,this.n=void 0,this.t=void 0}U.prototype.brand=hi;U.prototype.h=function(){return!0};U.prototype.S=function(n){this.t!==n&&n.e===void 0&&(n.x=this.t,this.t!==void 0&&(this.t.e=n),this.t=n)};U.prototype.U=function(n){if(this.t!==void 0){var e=n.e,t=n.x;e!==void 0&&(e.x=t,n.e=void 0),t!==void 0&&(t.e=e,n.x=void 0),n===this.t&&(this.t=t)}};U.prototype.subscribe=function(n){var e=this;return q(function(){var t=e.value,s=A;A=void 0;try{n(t)}finally{A=s}})};U.prototype.valueOf=function(){return this.value};U.prototype.toString=function(){return this.value+""};U.prototype.toJSON=function(){return this.value};U.prototype.peek=function(){var n=A;A=void 0;try{return this.value}finally{A=n}};Object.defineProperty(U.prototype,"value",{get:function(){var n=En(this);return n!==void 0&&(n.i=this.i),this.v},set:function(n){if(n!==this.v){if(rt>100)throw new Error("Cycle detected");this.v=n,this.i++,Be++,Z++;try{for(var e=this.t;e!==void 0;e=e.x)e.t.N()}finally{je()}}}});function d(n){return new U(n)}function mn(n){for(var e=n.s;e!==void 0;e=e.n)if(e.S.i!==e.i||!e.S.h()||e.S.i!==e.i)return!0;return!1}function yn(n){for(var e=n.s;e!==void 0;e=e.n){var t=e.S.n;if(t!==void 0&&(e.r=t),e.S.n=e,e.i=-1,e.n===void 0){n.s=e;break}}}function bn(n){for(var e=n.s,t=void 0;e!==void 0;){var s=e.p;e.i===-1?(e.S.U(e),s!==void 0&&(s.n=e.n),e.n!==void 0&&(e.n.p=s)):t=e,e.S.n=e.r,e.r!==void 0&&(e.r=void 0),e=s}n.s=t}function Ie(n){U.call(this,void 0),this.x=n,this.s=void 0,this.g=Be-1,this.f=4}(Ie.prototype=new U).h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===Be))return!0;if(this.g=Be,this.f|=1,this.i>0&&!mn(this))return this.f&=-2,!0;var n=A;try{yn(this),A=this;var e=this.x();(16&this.f||this.v!==e||this.i===0)&&(this.v=e,this.f&=-17,this.i++)}catch(t){this.v=t,this.f|=16,this.i++}return A=n,bn(this),this.f&=-2,!0};Ie.prototype.S=function(n){if(this.t===void 0){this.f|=36;for(var e=this.s;e!==void 0;e=e.n)e.S.S(e)}U.prototype.S.call(this,n)};Ie.prototype.U=function(n){if(this.t!==void 0&&(U.prototype.U.call(this,n),this.t===void 0)){this.f&=-33;for(var e=this.s;e!==void 0;e=e.n)e.S.U(e)}};Ie.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var n=this.t;n!==void 0;n=n.x)n.t.N()}};Object.defineProperty(Ie.prototype,"value",{get:function(){if(1&this.f)throw new Error("Cycle detected");var n=En(this);if(this.h(),n!==void 0&&(n.i=this.i),16&this.f)throw this.v;return this.v}});function Sn(n){var e=n.u;if(n.u=void 0,typeof e=="function"){Z++;var t=A;A=void 0;try{e()}catch(s){throw n.f&=-2,n.f|=8,yt(n),s}finally{A=t,je()}}}function yt(n){for(var e=n.s;e!==void 0;e=e.n)e.S.U(e);n.x=void 0,n.s=void 0,Sn(n)}function fi(n){if(A!==this)throw new Error("Out-of-order effect");bn(this),A=n,this.f&=-2,8&this.f&&yt(this),je()}function Te(n){this.x=n,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32}Te.prototype.c=function(){var n=this.S();try{if(8&this.f||this.x===void 0)return;var e=this.x();typeof e=="function"&&(this.u=e)}finally{n()}};Te.prototype.S=function(){if(1&this.f)throw new Error("Cycle detected");this.f|=1,this.f&=-9,Sn(this),yn(this),Z++;var n=A;return A=this,fi.bind(this,n)};Te.prototype.N=function(){2&this.f||(this.f|=2,this.o=me,me=this)};Te.prototype.d=function(){this.f|=8,1&this.f||yt(this)};function q(n){var e=new Te(n);try{e.c()}catch(t){throw e.d(),t}return e.d.bind(e)}class Rn{constructor(){this.items=[]}enqueue(e){this.items.push(e)}dequeue(){return this.items.length===0?null:this.items.shift()}isEmpty(){return this.items.length===0}size(){return this.items.length}clear(){this.items=[]}}const Pe={LOG:0,INFO:1,DEBUG:2,WARN:3,ERROR:4,NONE:5},Ut="ERROR",pi="RS SDK",vi="font-weight: bold; background: black; color: white;",Ei="font-weight: normal;";class mi{constructor(e=Ut,t="",s=console){this.minLogLevel=Pe[e],this.scope=t,this.logProvider=s}log(...e){this.outputLog("LOG",e)}info(...e){this.outputLog("INFO",e)}debug(...e){this.outputLog("DEBUG",e)}warn(...e){this.outputLog("WARN",e)}error(...e){this.outputLog("ERROR",e)}outputLog(e,t){var s,i;this.minLogLevel<=Pe[e]&&((i=(s=this.logProvider)[e.toLowerCase()])==null||i.call(s,...this.formatLogData(t)))}setScope(e){this.scope=e||this.scope}setMinLogLevel(e){this.minLogLevel=Pe[e],L(this.minLogLevel)&&(this.minLogLevel=Pe[Ut])}formatLogData(e){if(Array.isArray(e)&&e.length>0){let t=`%c ${pi}`;this.scope&&(t=`${t} - ${this.scope}`);const s=N(e[0])?e[0].trim():"";t=`${t} %c ${s}`;const i=[t,vi,Ei];return N(e[0])||i.push(e[0]),i.push(...e.slice(1)),i}return e}}const V=new mi,In=["localStorage","memoryStorage","cookieStorage","sessionStorage","none"],ot="cookieStorage",yi='"getSourceConfig" must be a function. Please make sure that it is defined and returns a valid source configuration object.',Bt="Unable to process/parse source configuration response.",bi="The source is disabled. Please enable the source in the dashboard to send events.",Si="Failed to prepare data for the request.",Ri="Failed to generate the event object.",Ii="Failed to invoke plugin because the extension point name is missing.",Ti="Failed to invoke plugin because the extension point name is invalid.",Ai=n=>`Failed to load the SDK as the base URL for ${n} is not valid.`,_i=(n,e,t)=>`${n}${b}The consent manager "${e}" is not supported. Please choose one of the following supported consent managers: "${Object.keys(t)}".`,Oi=n=>`${n}${b}Failed to initialize the error reporting plugin.`,Pi=n=>`${n}${b}Failed to notify the error.`,ki=n=>`${n}${b}Plugin name is missing.`,Ci=(n,e)=>`${n}${b}Plugin "${e}" already exists.`,Ni=(n,e)=>`${n}${b}Plugin "${e}" not found.`,Li=(n,e)=>`${n}${b}Plugin "${e}" not found in plugins but found in byName. This indicates a bug in the plugin engine. Please report this issue to the development team.`,Di=(n,e,t)=>`${n}${b}Plugin "${e}" could not be loaded because some of its dependencies "${t}" do not exist.`,wi=(n,e,t)=>`${n}${b}Failed to invoke the "${e}" extension point of plugin "${t}".`,Mi=(n,e)=>`${n}${b}The "${e}" storage type is `,Ui=n=>`Failed to fetch the source config. Reason: ${n}`,Bi=n=>`The write key "${n}" is invalid. It must be a non-empty string. Please check that the write key is correct and try again.`,$i=n=>`The data plane URL "${n}" is invalid. It must be a valid URL string. Please check that the data plane URL is correct and try again.`,xi=n=>`${n}${b}The callback is not a function.`,Gi=(n,e,t,s)=>`${n} with status: ${e}, ${t} for URL: ${s}.`,Fi=(n,e,t)=>`${n} due to timeout or no connection (${e?e.type:""}) for URL: ${t}.`,ji=(n,e)=>`${n} for URL: ${e}`,Hi=n=>`Failed to save the value for "${n}" to storage`,Vi=n=>`Failed to retrieve or parse data for "${n}" from storage`,Ki=n=>`The server responded with status ${n} while setting the cookies. As a fallback, the cookies will be set client side.`,Qi=n=>`The server failed to set the ${n} cookie. As a fallback, the cookies will be set client side.`,zi="Failed to set/remove cookies via server. As a fallback, the cookies will be managed client side.",qi=(n,e,t)=>`${n}${b}The storage type "${e}" is not supported. Please choose one of the following supported types: "${In}". The default type "${t}" will be used instead.`,Wi=(n,e,t,s)=>`${n}${b}The error reporting provider "${e}" is not supported. Please choose one of the following supported providers: "${Object.keys(t)}". The default provider "${s}" will be used instead.`,Yi=(n,e,t,s)=>`${n}${b}The storage encryption version "${e}" is not supported. Please choose one of the following supported versions: "${Object.keys(t)}". The default version "${s}" will be used instead.`,Xi=(n,e,t)=>`${n}${b}The storage data migration has been disabled because the configured storage encryption version (${e}) is not the latest (${t}). To enable storage data migration, please update the storage encryption version to the latest version.`,Ji=(n,e,t)=>`${n}${b}The provided cookie domain (${e}) does not match the current webpage's domain (${t}). Hence, the cookies will be set client-side.`,Zi=(n,e,t,s)=>`${n}${b}The "${e}" property defined under "${t}" is a reserved keyword. Please choose a different property name to avoid conflicts with reserved keywords (${s}).`,er=n=>`${n}${b}The Beacon API is not supported by your browser. The events will be sent using XHR instead.`,tr=(n,e,t)=>`${n}${b}The session timeout value "${e}" is not a number. The default timeout of ${t} ms will be used instead.`,nr=n=>`${n}${b}The session timeout value is 0, which disables the automatic session tracking feature. If you want to enable session tracking, please provide a positive integer value for the timeout.`,sr=(n,e,t)=>`${n}${b}The session timeout value ${e} ms is less than the recommended minimum of ${t} ms. Please consider increasing the timeout value to ensure optimal performance and reliability.`,ir=(n,e,t)=>`${n}${b}The provided session ID (${e}) is either invalid, not a positive integer, or not at least "${t}" digits long. A new session ID will be auto-generated instead.`,rr=n=>`${n}${b}The storage is either full or unavailable, so the data will not be persisted. Switching to in-memory storage.`,or=(n,e,t,s)=>`${n}${b}The storage type "${t}" is not available for entry "${e}". The SDK will initialize the entry with "${s}" storage type instead.`,ar=(n,e)=>`${n}${b}The write key "${e}" is not a string. Please check that the write key is correct and try again.`,lr=n=>`${n}${b}The group() method must be called with at least one argument.`,$t="Failed to invoke the ready callback",cr="API Callback Invocation Failed",ur="NativeDestinationQueuePlugin initialization failed",dr="XhrQueuePlugin initialization failed",gr="DeviceModeTransformationPlugin initialization failed",hr="NativeDestinationQueuePlugin event enqueue failed",fr="XhrQueuePlugin event enqueue failed",pr=(n,e)=>`${n}${b}The provided source config URL "${e}" is invalid. Using the default source config URL instead.`,vr=(n,e)=>`Failed to load the polyfill script with ID "${n}" from URL ${e}.`,Er=(n,e,t)=>`${n}${b}The pre-consent storage strategy "${e}" is not supported. Please choose one of the following supported strategies: "none, session, anonymousId". The default strategy "${t}" will be used instead.`,mr=(n,e,t)=>`${n}${b}The pre-consent events delivery type "${e}" is not supported. Please choose one of the following supported types: "immediate, buffer". The default type "${t}" will be used instead.`,yr=(n,e,t,s)=>{const i=t.length===1,r=i?` '${t[0]}' plugin was`:` ['${t.join("', '")}'] plugins were`,a=`${n}${b}${e}, but${r} not configured to load.`;return s?`${a} So, ${i?"the plugin":"those plugins"} will be loaded automatically.`:`${a} Ignore if this was intentional. Otherwise, consider adding ${i?"it":"them"} to the 'plugins' load API option.`},br=(n,e)=>`${n}${b}The provided polyfill URL "${e}" is invalid. The default polyfill URL will be used instead.`,Tn="js-integrations",An="plugins",Sr=new RegExp("^(https?:\\/\\/)(((([a-zA-Z\\d]([a-zA-Z\\d-]*[a-zA-Z\\d])*)\\.)+[a-zA-Z]{2,}|localhost|((25[0-5]|2[0-4][0-9]|[0-1]?[0-9]?[0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[0-1]?[0-9]?[0-9]?)))(\\:\\d+)?(\\/[-a-zA-Z\\d%_.~+]*)*(\\?[;&a-zA-Z\\d%_.~+=-]*)?(\\#[-a-zA-Z\\d_]*)?$"),Se="modern",_n="https://cdn.rudderlabs.com",bt="v3",On=`${_n}/${bt}/${Se}/${Tn}`,Pn=`${_n}/${bt}/${Se}/${An}`,kn="https://api.rudderstack.com",at="bugsnag",ne="v3",Rr="xhr",lt={oneTrust:"OneTrustConsentManager",ketch:"KetchConsentManager",custom:"CustomConsentManager"},Ce={[at]:"Bugsnag"},Ne={[ne]:"StorageEncryption",legacy:"StorageEncryptionLegacy"},Ir={[Rr]:"XhrQueue",beacon:"BeaconQueue"},Tr="rsaRequest",Ar={logLevel:"ERROR",configUrl:kn,loadIntegration:!0,sessions:{autoTrack:!0,timeout:be},sameSiteCookie:"Lax",polyfillIfRequired:!0,integrations:{All:!0},useBeacon:!1,beaconQueueOptions:{},destinationsQueueOptions:{},queueOptions:{},lockIntegrationsVersion:!1,lockPluginsVersion:!1,uaChTrackLevel:"none",plugins:[],useGlobalIntegrationsConfigInEvents:!1,bufferDataPlaneEventsUntilReady:!1,dataPlaneEventsBufferTimeout:zs,storage:{encryption:{version:ne},migrate:!0},sendAdblockPageOptions:{},useServerSideCookies:!1},_r=d(R(Ar)),I={userId:"",userTraits:{},anonymousId:"",groupId:"",groupTraits:{},initialReferrer:"",initialReferringDomain:"",sessionInfo:{},authToken:null},Or=10,Pr={autoTrack:!0,timeout:be},kr={userId:d(I.userId),userTraits:d(I.userTraits),anonymousId:d(I.anonymousId),groupId:d(I.groupId),groupTraits:d(I.groupTraits),initialReferrer:d(I.initialReferrer),initialReferringDomain:d(I.initialReferringDomain),sessionInfo:d(I.sessionInfo),authToken:d(I.authToken)},Cr={isOnline:d(!0),storage:{isLocalStorageAvailable:d(!1),isCookieStorageAvailable:d(!1),isSessionStorageAvailable:d(!1)},isBeaconAvailable:d(!1),isLegacyDOM:d(!1),isUaCHAvailable:d(!1),isCryptoAvailable:d(!1),isIE11:d(!1),isAdBlocked:d(!1)},Nr={isErrorReportingEnabled:d(!1),isMetricsReportingEnabled:d(!1),errorReportingProviderPluginName:d(void 0),isErrorReportingPluginLoaded:d(!1)},Lr=d(void 0),Dr={activeDataplaneUrl:d(void 0),integrationsCDNPath:d(On),pluginsCDNPath:d(Pn),sourceConfigUrl:d(void 0),status:d(void 0),initialized:d(!1),logLevel:d("ERROR"),loaded:d(!1),readyCallbacks:d([]),writeKey:d(void 0),dataPlaneUrl:d(void 0)},wr={enabled:d(!1),initialized:d(!1),data:d({}),activeConsentManagerPluginName:d(void 0),preConsent:d({enabled:!1}),postConsent:d({}),resolutionStrategy:d("and"),provider:d(void 0),metadata:d(void 0)},Mr={retries:d(0),dropped:d(0),sent:d(0),queued:d(0),triggered:d(0)},Ur={app:d({name:Pt,namespace:xs,version:ye,installType:fn}),traits:d(null),library:d({name:Pt,version:ye,snippetVersion:globalThis.RudderSnippetVersion}),userAgent:d(""),device:d(null),network:d(null),os:d({name:"",version:""}),locale:d(null),screen:d({density:0,width:0,height:0,innerWidth:0,innerHeight:0}),"ua-ch":d(void 0),timezone:d(void 0)},Br={configuredDestinations:d([]),activeDestinations:d([]),loadOnlyIntegrations:d({}),failedDestinations:d([]),loadIntegration:d(!0),initializedDestinations:d([]),clientDestinationsReady:d(!1),integrationsConfig:d({})},$r={toBeProcessedArray:d([]),readyCallbacksArray:d([])},xr={ready:d(!1),loadedPlugins:d([]),failedPlugins:d([]),pluginsToLoadFromConfig:d([]),activePlugins:d([]),totalPluginsToLoad:d(0)},Gr={encryptionPluginName:d(void 0),migrate:d(!1),type:d(void 0),cookie:d(void 0),entries:d({}),trulyAnonymousTracking:d(!1)},Fr={isEnabledServerSideCookies:d(!1),dataServiceUrl:d(void 0)},jr={eventsQueuePluginName:d(void 0),deliveryEnabled:d(!0)},Hr={capabilities:Cr,consents:wr,context:Ur,eventBuffer:$r,lifecycle:Dr,loadOptions:_r,metrics:Mr,nativeDestinations:Br,plugins:xr,reporting:Nr,session:kr,source:Lr,storage:Gr,serverCookies:Fr,dataPlaneEvents:jr},o={...R(Hr)};class Vr{constructor(e={},t){S(this,"plugins",[]);S(this,"byName",{});S(this,"cache",{});S(this,"config",{throws:!0});this.config={throws:!0,...e},this.logger=t}register(e,t){var i,r;if(!e.name){const a=ki(re);if(this.config.throws)throw new Error(a);(i=this.logger)==null||i.error(a,e)}if(this.byName[e.name]){const a=Ci(re,e.name);if(this.config.throws)throw new Error(a);(r=this.logger)==null||r.error(a)}this.cache={},this.plugins=this.plugins.slice();let s=this.plugins.length;this.plugins.forEach((a,l)=>{var c;(c=a.deps)!=null&&c.includes(e.name)&&(s=Math.min(s,l))}),this.plugins.splice(s,0,e),this.byName[e.name]=e,f(e.initialize)&&e.initialize(t)}unregister(e){var i,r;const t=this.byName[e];if(!t){const a=Ni(re,e);if(this.config.throws)throw new Error(a);(i=this.logger)==null||i.error(a)}const s=this.plugins.indexOf(t);if(s===-1){const a=Li(re,e);if(this.config.throws)throw new Error(a);(r=this.logger)==null||r.error(a)}this.cache={},delete this.byName[e],this.plugins=this.plugins.slice(),this.plugins.splice(s,1)}getPlugin(e){return this.byName[e]}getPlugins(e){const t=e??".";return this.cache[t]||(this.cache[t]=this.plugins.filter(s=>{var i,r;if((i=s.deps)!=null&&i.some(a=>!this.byName[a])){const a=s.deps.filter(l=>!this.byName[l]);return(r=this.logger)==null||r.error(Di(re,s.name,a)),!1}return t==="."?!0:ks(s,t)})),this.cache[t]}processRawPlugins(e){e(this.plugins),this.cache={}}invoke(e,t=!0,...s){let i=e;if(!i)throw new Error(Ii);const r=i.startsWith("!"),a=this.config.throws??i.endsWith("!");if(i=i.replace(/(^!|!$)/g,""),!i)throw new Error(Ti);const l=i.split(".");l.pop();const c=l.join(".");return(t?this.getPlugins(i):[this.getPlugins(i)[0]]).map(h=>{var T;const v=nt(h,i);if(!f(v)||r)return v;try{return v.apply(nt(h,c),s)}catch(g){if(a)throw g;(T=this.logger)==null||T.error(wi(re,i,h.name),g)}return null})}invokeSingle(e,...t){return this.invoke(e,!1,...t)[0]}invokeMultiple(e,...t){return this.invoke(e,!0,...t)}}const Cn=new Vr({throws:!0},V),Le="The request failed",Kr=[Le],Qr="RS_JS_SDK",zr=n=>{let e;try{if(N(n))e=n;else if(n instanceof Error)e=n.message;else if(n instanceof ErrorEvent)e=n.message;else if(n instanceof Event){const t=n.target;if(t&&t.localName!=="script"||t!=null&&t.dataset&&(t.dataset.loader!==Qr||t.dataset.isnonnativesdk!=="true"))return"";e=`Error in loading a third-party script from URL ${t==null?void 0:t.src} with ID ${t==null?void 0:t.id}.`}else e=n.message?n.message:X(n)}catch(t){e=`Unknown error: ${t.message}`}return e},qr=n=>n.message?!Kr.some(e=>n.message.includes(e)):!0;class Wr{constructor(e,t){this.logger=e,this.pluginEngine=t,this.errorBuffer=new Rn,this.attachEffect()}attachEffect(){if(o.reporting.isErrorReportingPluginLoaded.value===!0)for(;this.errorBuffer.size()>0;)this.errorBuffer.dequeue()}attachErrorListeners(){var e;"addEventListener"in globalThis?(globalThis.addEventListener("error",t=>{this.onError(t,void 0,void 0,void 0,"unhandledException")}),globalThis.addEventListener("unhandledrejection",t=>{this.onError(t,void 0,void 0,void 0,"unhandledPromiseRejection")})):(e=this.logger)==null||e.debug("Failed to attach global error listeners.")}init(e){if(this.pluginEngine)try{const t="errorReporting.init",s=this.pluginEngine.invokeSingle(t,o,this.pluginEngine,e,this.logger);s instanceof Promise&&s.then(i=>{this.errReportingClient=i}).catch(i=>{var r;(r=this.logger)==null||r.error(Oi(Oe),i)})}catch(t){this.onError(t,Oe)}}onError(e,t="",s="",i=!1,r="handled"){let a=zr(e);if(!a)return;a=Ls(`${t}${b}${s} ${a}`);let l=new Error(a);if(ln(e)&&(l=Object.create(e,{message:{value:a}})),r==="handled")if(this.notifyError(l),this.logger){if(this.logger.error(a),i)throw l}else throw l;o.reporting.isErrorReportingEnabled.value&&o.reporting.isErrorReportingPluginLoaded.value}leaveBreadcrumb(e){if(this.pluginEngine)try{this.pluginEngine.invokeSingle("errorReporting.breadcrumb",this.pluginEngine,this.errReportingClient,e,this.logger)}catch(t){this.onError(t,Oe,"errorReporting.breadcrumb")}}notifyError(e){var t,s;if(this.errReportingClient&&qr(e))try{(t=this.pluginEngine)==null||t.invokeSingle("errorReporting.notify",this.pluginEngine,this.errReportingClient,e,o,this.logger)}catch(i){(s=this.logger)==null||s.error(Pi(Oe),i)}}}const He=new Wr(V,Cn),Yr=n=>n.config.connectionMode!=="cloud"||n.config.useNativeSDKToSend===!0||n.config.useNativeSDK===!0,Xr=n=>n.config.connectionMode==="hybrid"||n.config.useNativeSDKToSend===!0,xt=n=>n.filter(Yr),Nn=["BeaconQueue","Bugsnag","CustomConsentManager","DeviceModeDestinations","DeviceModeTransformation","ErrorReporting","ExternalAnonymousId","GoogleLinker","KetchConsentManager","NativeDestinationQueue","OneTrustConsentManager","StorageEncryption","StorageEncryptionLegacy","StorageMigrator","XhrQueue"],Jr={rudderAnalyticsRemotePlugins:{url:()=>Promise.resolve(window.RudderStackGlobals&&window.RudderStackGlobals.app&&window.RudderStackGlobals.app.pluginsCDNPath?""+window.RudderStackGlobals.app.pluginsCDNPath+"/rsa-plugins.js":"https://cdn.rudderlabs.com/v3/modern/plugins/rsa-plugins.js"),format:"esm",from:"vite"}},Zr=async(n,e)=>{const t=typeof n=="function"?await n():n,s=document.createElement("script");s.type="text/javascript",s.onload=e,s.src=t,document.getElementsByTagName("head")[0].appendChild(s)};function Ln(n,e){const t=Object.assign(n,e);for(const s of Object.keys(t))typeof t[s]=="object"&&typeof e[s]=="object"&&(t[s]=Ln(t[s],e[s]));return t}const Gt=n=>Ln({},(globalThis.__federation_shared__||{}).default||{});async function eo(n){const e=Jr[n];if(e.inited)return e.lib;if(e.format==="var")return new Promise(t=>{const s=()=>{e.inited||(e.lib=window[n],e.lib.init(Gt(e.from)),e.inited=!0),t(e.lib)};return Zr(e.url,s)});if(["esm","systemjs"].includes(e.format))return new Promise((t,s)=>{(typeof e.url=="function"?e.url:()=>Promise.resolve(e.url))().then(r=>{ps(()=>import(r),[]).then(a=>{if(!e.inited){const l=Gt(e.from);a.init(l),e.lib=a,e.lib.init(l),e.inited=!0}t(e.lib)}).catch(s)})})}function D(n,e){if(!(n!=null&&n.default)&&e){let t=Object.create(null);return t.default=n,t.__esModule=!0,t}return n}function w(n,e){return eo(n).then(t=>t.get(e).then(s=>s()))}const to=n=>{switch(n){case"BeaconQueue":return()=>w("rudderAnalyticsRemotePlugins","./BeaconQueue").then(e=>D(e,!0));case"Bugsnag":return()=>w("rudderAnalyticsRemotePlugins","./Bugsnag").then(e=>D(e,!0));case"CustomConsentManager":return()=>w("rudderAnalyticsRemotePlugins","./CustomConsentManager").then(e=>D(e,!0));case"DeviceModeDestinations":return()=>w("rudderAnalyticsRemotePlugins","./DeviceModeDestinations").then(e=>D(e,!0));case"DeviceModeTransformation":return()=>w("rudderAnalyticsRemotePlugins","./DeviceModeTransformation").then(e=>D(e,!0));case"ErrorReporting":return()=>w("rudderAnalyticsRemotePlugins","./ErrorReporting").then(e=>D(e,!0));case"ExternalAnonymousId":return()=>w("rudderAnalyticsRemotePlugins","./ExternalAnonymousId").then(e=>D(e,!0));case"GoogleLinker":return()=>w("rudderAnalyticsRemotePlugins","./GoogleLinker").then(e=>D(e,!0));case"KetchConsentManager":return()=>w("rudderAnalyticsRemotePlugins","./KetchConsentManager").then(e=>D(e,!0));case"NativeDestinationQueue":return()=>w("rudderAnalyticsRemotePlugins","./NativeDestinationQueue").then(e=>D(e,!0));case"OneTrustConsentManager":return()=>w("rudderAnalyticsRemotePlugins","./OneTrustConsentManager").then(e=>D(e,!0));case"StorageEncryption":return()=>w("rudderAnalyticsRemotePlugins","./StorageEncryption").then(e=>D(e,!0));case"StorageEncryptionLegacy":return()=>w("rudderAnalyticsRemotePlugins","./StorageEncryptionLegacy").then(e=>D(e,!0));case"StorageMigrator":return()=>w("rudderAnalyticsRemotePlugins","./StorageMigrator").then(e=>D(e,!0));case"XhrQueue":return()=>w("rudderAnalyticsRemotePlugins","./XhrQueue").then(e=>D(e,!0));default:return}},ze=n=>{const e={};return n.forEach(t=>{if(Nn.includes(t)){const s=to(t);s&&(e[t]=s)}}),e},ct=()=>({}),no=()=>({}),so=n=>(ze==null?void 0:ze(n))||{},qe={...ct(),...no()},io=n=>({...so(n)});class ro{constructor(e,t,s){this.engine=e,this.errorHandler=t,this.logger=s,this.onError=this.onError.bind(this)}init(){o.lifecycle.status.value="pluginsLoading",Fe("pluginsCDNPath",o.lifecycle.pluginsCDNPath.value),this.setActivePlugins(),this.registerLocalPlugins(),this.registerRemotePlugins(),this.attachEffects()}attachEffects(){q(()=>{(o.plugins.activePlugins.value.length===0||o.plugins.loadedPlugins.value.length+o.plugins.failedPlugins.value.length===o.plugins.totalPluginsToLoad.value)&&M(()=>{o.plugins.ready.value=!0,o.lifecycle.status.value="pluginsReady"})})}getPluginsToLoadBasedOnConfig(){let e=o.plugins.pluginsToLoadFromConfig.value;if(!e)return[];const t=[{configurationStatus:()=>_(o.dataPlaneEvents.eventsQueuePluginName.value),configurationStatusStr:"Data plane events delivery is enabled",activePluginName:o.dataPlaneEvents.eventsQueuePluginName.value,supportedPlugins:Object.values(Ir),shouldAddMissingPlugins:!0},{configurationStatus:()=>_(o.reporting.errorReportingProviderPluginName.value),configurationStatusStr:"Error reporting is enabled",activePluginName:o.reporting.errorReportingProviderPluginName.value,basePlugins:["ErrorReporting"],supportedPlugins:Object.values(Ce)},{configurationStatus:()=>xt(o.nativeDestinations.configuredDestinations.value).length>0,configurationStatusStr:"Device mode destinations are connected to the source",supportedPlugins:["DeviceModeDestinations","NativeDestinationQueue"]},{configurationStatus:()=>xt(o.nativeDestinations.configuredDestinations.value).some(i=>i.shouldApplyDeviceModeTransformation),configurationStatusStr:"Device mode transformations are enabled for at least one destination",supportedPlugins:["DeviceModeTransformation"]},{configurationStatus:()=>_(o.consents.activeConsentManagerPluginName.value),configurationStatusStr:"Consent management is enabled",activePluginName:o.consents.activeConsentManagerPluginName.value,supportedPlugins:Object.values(lt)},{configurationStatus:()=>_(o.storage.encryptionPluginName.value),configurationStatusStr:"Storage encryption is enabled",activePluginName:o.storage.encryptionPluginName.value,supportedPlugins:Object.values(Ne)},{configurationStatus:()=>o.storage.migrate.value,configurationStatusStr:"Storage migration is enabled",supportedPlugins:["StorageMigrator"]}],s=!1;return t.forEach(i=>{i.configurationStatus()?(e=e.filter(i.activePluginName?r=>!(r!==i.activePluginName&&i.supportedPlugins.includes(r)):r=>_(r)),this.addMissingPlugins(i,s,e)):e=e.filter(i.basePlugins!==void 0?r=>!(i.basePlugins.includes(r)||i.supportedPlugins.includes(r)):r=>!i.supportedPlugins.includes(r))}),[...Object.keys(ct()),...e]}addMissingPlugins(e,t,s){var l;const i=e.shouldAddMissingPlugins||t;let r;e.activePluginName?r=[...e.basePlugins||[],e.activePluginName]:r=[...e.supportedPlugins];const a=r.filter(c=>!s.includes(c));a.length>0&&(i&&s.push(...a),(l=this.logger)==null||l.warn(yr(At,e.configurationStatusStr,a,i)))}setActivePlugins(){const e=this.getPluginsToLoadBasedOnConfig(),t=[...Object.keys(qe),...Nn],s=[],i=[];e.forEach(r=>{t.includes(r)?s.push(r):i.push(r)}),i.length>0&&this.onError(new Error(`Ignoring loading of unknown plugins: ${i.join(",")}. Mandatory plugins: ${Object.keys(ct()).join(",")}. Load option plugins: ${o.plugins.pluginsToLoadFromConfig.value.join(",")}`)),M(()=>{o.plugins.totalPluginsToLoad.value=e.length,o.plugins.activePlugins.value=s,o.plugins.failedPlugins.value=i})}registerLocalPlugins(){Object.values(qe).forEach(e=>{f(e)&&o.plugins.activePlugins.value.includes(e().name)&&this.register([e()])})}registerRemotePlugins(){const e=io(o.plugins.activePlugins.value);Promise.all(Object.keys(e).map(async t=>{await e[t]().then(s=>this.register([s.default()])).catch(s=>{o.plugins.failedPlugins.value=[...o.plugins.failedPlugins.value,t],this.onError(s,t)})})).catch(t=>{this.onError(t)})}invokeMultiple(e,...t){try{return this.engine.invokeMultiple(e,...t)}catch(s){return this.onError(s,e),[]}}invokeSingle(e,...t){try{return this.engine.invokeSingle(e,...t)}catch(s){return this.onError(s,e),null}}register(e){e.forEach(t=>{try{this.engine.register(t,o)}catch(s){o.plugins.failedPlugins.value=[...o.plugins.failedPlugins.value,t.name],this.onError(s)}})}unregisterLocalPlugins(){Object.values(qe).forEach(e=>{try{this.engine.unregister(e().name)}catch(t){this.onError(t)}})}onError(e,t){if(this.errorHandler)this.errorHandler.onError(e,At,t);else throw e}}const Ft=(n,e)=>{try{return JSON.parse(n||"")}catch(t){const s=Re(t,"Failed to parse response data");if(f(e))e(s);else throw s}},oo={headers:{Accept:"application/json","Content-Type":"application/json;charset=UTF-8"},method:"GET"},jt=(n,e,t)=>{const s=k(oo,e||{});return t&&(s.headers=k(s.headers,{Authorization:t})),s.url=n,s},Ht=(n,e=Ks,t)=>new Promise((s,i)=>{let r;if(n.sendRawData===!0)r=n.data;else if(r=X(n.data,!1,[],t),F(r)){i({error:new Error(Si),undefined:void 0,options:n});return}const a=new XMLHttpRequest,l=u=>{i({error:new Error(Gi(Le,a.status,a.statusText,n.url)),xhr:a,options:n})},c=u=>{i({error:new Error(Fi(Le,u,n.url)),xhr:a,options:n})};a.ontimeout=c,a.onerror=c,a.onload=()=>{a.status>=200&&a.status<400?s({response:a.responseText,xhr:a,options:n}):l()},a.open(n.method,n.url),n.withCredentials===!0&&(a.withCredentials=!0),a.timeout=e,Object.keys(n.headers).forEach(u=>{n.headers[u]&&a.setRequestHeader(u,n.headers[u])});try{a.send(r)}catch(u){i({error:Re(u,ji(Le,n.url)),xhr:a,options:n})}});class St{constructor(e,t){S(this,"hasErrorHandler",!1);this.errorHandler=e,this.logger=t,this.hasErrorHandler=!!this.errorHandler,this.onError=this.onError.bind(this)}async getData(e){const{url:t,options:s,timeout:i,isRawResponse:r}=e;try{const a=await Ht(jt(t,s,this.basicAuthHeader),i,this.logger);return{data:r?a.response:Ft(a.response,this.onError),details:a}}catch(a){return this.onError(a.error??a),{data:void 0,details:a}}}getAsyncData(e){const{callback:t,url:s,options:i,timeout:r,isRawResponse:a}=e,l=!f(t);Ht(jt(s,i,this.basicAuthHeader),r,this.logger).then(c=>{l||t(a?c.response:Ft(c.response,this.onError),c)}).catch(c=>{this.onError(c.error??c),l||t(void 0,c)})}onError(e){var t;if(this.hasErrorHandler)(t=this.errorHandler)==null||t.onError(e,$s);else throw e}setAuthHeader(e,t=!1){const s=t?e:ws(`${e}:`);this.basicAuthHeader=`Basic ${s}`}resetAuthHeader(){this.basicAuthHeader=void 0}}const ao=new St(He,V),$="cookieStorage",B="localStorage",G="sessionStorage",K="memoryStorage",ie="none",lo="rl_user_id",co="rl_trait",uo="rl_anonymous_id",go="rl_group_id",ho="rl_group_trait",fo="rl_page_init_referrer",po="rl_page_init_referring_domain",vo="rl_session",Eo="rl_auth_token",oe={userId:lo,userTraits:co,anonymousId:uo,groupId:go,groupTraits:ho,initialReferrer:fo,initialReferringDomain:po,sessionInfo:vo,authToken:Eo},mo="test_rudder_cookie",yo="test_rudder_ls",bo="test_rudder_ss",So="__tld__",Dn="clientDataInCookie",wn="clientDataInLocalStorage",Ro="clientDataInMemory",Mn="clientDataInSessionStorage",Un=["userId","userTraits","anonymousId","groupId","groupTraits","initialReferrer","initialReferringDomain","sessionInfo","authToken"],ae={[$]:Dn,[B]:wn,[K]:Ro,[G]:Mn},Io="Failed to encode the cookie data.",Vt=(n,e)=>{try{return encodeURIComponent(n)}catch(t){e==null||e.error(Io,t);return}},Kt=n=>{try{return decodeURIComponent(n)}catch{return}},To=n=>{const e={},t=n.split(/\s*;\s*/);let s;return t[0]&&t.forEach(i=>{s=i.split("=");const r=s[0]?Kt(s[0]):void 0;r&&(e[r]=s[1]?Kt(s[1]):void 0)}),e},Ao=(n,e,t,s)=>{const i={...t||{}};let r=`${Vt(n,s)}=${Vt(e,s)}`;F(e)&&(i.maxage=-1),i.maxage&&(i.expires=new Date(+new Date+i.maxage)),i.path&&(r+=`; path=${i.path}`),i.domain&&(r+=`; domain=${i.domain}`),i.expires&&(r+=`; expires=${i.expires.toUTCString()}`),i.samesite&&(r+=`; samesite=${i.samesite}`),i.secure&&(r+="; secure"),globalThis.document.cookie=r},ut=()=>{const n=globalThis.document.cookie;return To(n)},_o=n=>ut()[n],Y=function(n,e,t,s){switch(arguments.length){case 4:case 3:case 2:return Ao(n,e,t,s);case 1:return n?_o(n):ut();default:return ut()}},Oo=(n,e)=>{const t=new URL(o.lifecycle.sourceConfigUrl.value),s=`${t.origin}${t.pathname}?view=ad`,i=new St(n,e);i.setAuthHeader(o.lifecycle.writeKey.value),i.getAsyncData({url:s,options:{method:"HEAD",headers:{"Content-Type":void 0}},isRawResponse:!0,callback:(r,a)=>{var l;o.capabilities.isAdBlocked.value=(a==null?void 0:a.error)!==void 0||((l=a==null?void 0:a.xhr)==null?void 0:l.responseURL)!==s}})},Po=()=>!H(globalThis.crypto)&&f(globalThis.crypto.getRandomValues),Qt=()=>!H(globalThis.navigator.userAgentData),ko=()=>!H(globalThis.navigator.sendBeacon)&&f(globalThis.navigator.sendBeacon),Co=()=>!!globalThis.navigator.userAgent.match(/Trident.*rv:11\./),No=(n,e="none")=>{var t;e==="none"&&n(void 0),e==="default"&&n(navigator.userAgentData),e==="full"&&((t=navigator.userAgentData)==null||t.getHighEntropyValues(["architecture","bitness","brands","mobile","model","platform","platformVersion","uaFullVersion","fullVersionList","wow64"]).then(s=>{n(s)}).catch(()=>{n()}))},Lo=()=>{const n=globalThis.document.createElement("div");return n.setAttribute("data-a-b","c"),n.dataset?n.dataset.aB==="c":!1},dt={URL:()=>!f(globalThis.URL)||!f(globalThis.URLSearchParams),Promise:()=>!f(globalThis.Promise),"Number.isNaN":()=>!f(globalThis.Number.isNaN),"Number.isInteger":()=>!f(globalThis.Number.isInteger),"Array.from":()=>!f(globalThis.Array.from),"Array.prototype.find":()=>!f(globalThis.Array.prototype.find),"Array.prototype.includes":()=>!f(globalThis.Array.prototype.includes),"String.prototype.endsWith":()=>!f(globalThis.String.prototype.endsWith),"String.prototype.startsWith":()=>!f(globalThis.String.prototype.startsWith),"String.prototype.includes":()=>!f(globalThis.String.prototype.includes),"String.prototype.replaceAll":()=>!f(globalThis.String.prototype.replaceAll),"String.fromCodePoint":()=>!f(globalThis.String.fromCodePoint),"Object.entries":()=>!f(globalThis.Object.entries),"Object.values":()=>!f(globalThis.Object.values),"Object.assign":()=>!f(globalThis.Object.assign),"Object.fromEntries":()=>!f(globalThis.Object.fromEntries),"Element.prototype.dataset":()=>!Lo(),TextEncoder:()=>!f(globalThis.TextEncoder)||!f(globalThis.TextDecoder),requestAnimationFrame:()=>!f(globalThis.requestAnimationFrame)||!f(globalThis.cancelAnimationFrame),CustomEvent:()=>!f(globalThis.CustomEvent),"navigator.sendBeacon":()=>!f(globalThis.navigator.sendBeacon),ArrayBuffer:()=>!f(globalThis.Uint8Array),Set:()=>!f(globalThis.Set),atob:()=>!f(globalThis.atob)},Do=()=>{const n=Object.keys(dt);let e=!1;for(let t=0;t<n.length;t++){const s=dt[n[t]];if(f(s)&&s()){e=!0;break}}return e},zt=()=>{let n={density:0,width:0,height:0,innerWidth:0,innerHeight:0};return n={width:globalThis.screen.width,height:globalThis.screen.height,density:globalThis.devicePixelRatio,innerWidth:globalThis.innerWidth,innerHeight:globalThis.innerHeight},n},Bn=n=>{const e=["QuotaExceededError","NS_ERROR_DOM_QUOTA_REACHED"],t=[22,1014],s=e.includes(n.name)||t.includes(n.code);return n instanceof DOMException&&s},ue=(n=B,e,t)=>{let s,i;try{switch(n){case K:return!0;case $:s=e,i=mo;break;case B:s=e??globalThis.localStorage,i=yo;break;case G:s=e??globalThis.sessionStorage,i=bo;break;default:return!1}return s?(s.setItem(i,"true"),s.getItem(i)?(s.removeItem(i),!0):!1):!1}catch(r){const a=Mi(st,n);let l="unavailable";return Bn(r)&&(l="full"),t==null||t.warn(`${a}${l}.`,r),!1}},wo=n=>{const e=document.createElement("a");return e.href=n,e.hostname},Mo=n=>{const e=typeof globalThis.URL!="function"?wo(n):new URL(n).hostname,t=(e==null?void 0:e.split("."))??[],s=t[t.length-1],i=[];if(t.length===4&&s&&s===parseInt(s,10).toString())return i;if(t.length<=1)return t[0]&&t[0].indexOf("localhost")!==-1?["localhost"]:i;for(let r=t.length-2;r>=0;r-=1)i.push(t.slice(r).join("."));return i},Uo=n=>{const e=Mo(n);for(let t=0;t<e.length;t+=1){const s=e[t],i=So,r={domain:`${s.indexOf("localhost")!==-1?"":"."}${s}`};if(Y(i,1,r),Y(i))return Y(i,null,r),s}return""},Bo=()=>{const n=`.${Uo(globalThis.location.href)}`;return{maxage:Qs,path:"/",domain:!n||n==="."?void 0:n,samesite:"Lax",enabled:!0}},$o=()=>({enabled:!0}),xo=()=>({enabled:!0}),Go=()=>({enabled:!0}),le=class le{constructor(e={},t){S(this,"isSupportAvailable",!0);S(this,"isEnabled",!0);S(this,"length",0);if(le.globalSingleton)return le.globalSingleton;this.options=Bo(),this.logger=t,this.configure(e),le.globalSingleton=this}configure(e){return this.options=k(this.options??{},e),e.sameDomainCookiesOnly&&delete this.options.domain,this.isSupportAvailable=ue($,this,this.logger),this.isEnabled=!!(this.options.enabled&&this.isSupportAvailable),this.options}setItem(e,t){return Y(e,t,this.options,this.logger),this.length=Object.keys(Y()).length,!0}getItem(e){const t=Y(e);return L(t)?null:t}removeItem(e){const t=this.setItem(e,null);return this.length=Object.keys(Y()).length,t}clear(){}key(e){return this.keys()[e]??null}keys(){return Object.keys(Y())}};S(le,"globalSingleton",null);let $e=le;class Fo{constructor(e,t){S(this,"isEnabled",!0);S(this,"length",0);S(this,"data",{});this.options=Go(),this.logger=t,this.configure(e??{})}configure(e){return this.options=k(this.options,e),this.isEnabled=!!this.options.enabled,this.options}setItem(e,t){return this.data[e]=t,this.length=Object.keys(this.data).length,t}getItem(e){return e in this.data?this.data[e]:null}removeItem(e){return e in this.data&&delete this.data[e],this.length=Object.keys(this.data).length,null}clear(){this.data={},this.length=0}key(e){return this.keys()[e]??null}keys(){return Object.keys(this.data)}}const gt=new Fo({},V);var jo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ho(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var $n={exports:{}};(function(n,e){(function(t,s){n.exports=s()})(jo,function(){function t(g){return g=JSON.stringify(g),!!/^\{[\s\S]*\}$/.test(g)}function s(g){return g===void 0||typeof g=="function"?g+"":JSON.stringify(g)}function i(g){if(typeof g=="string")try{return JSON.parse(g)}catch{return g}}function r(g){return{}.toString.call(g)==="[object Function]"}function a(g){return Object.prototype.toString.call(g)==="[object Array]"}function l(g){var p="_Is_Incognit",m="yes";try{g||(g=window.localStorage),g.setItem(p,m),g.removeItem(p)}catch{var E={};E._data={},E.setItem=function(C,Ke){return E._data[C]=String(Ke)},E.getItem=function(C){return E._data.hasOwnProperty(C)?E._data[C]:void 0},E.removeItem=function(C){return delete E._data[C]},E.clear=function(){return E._data={}},g=E}finally{g.getItem(p)===m&&g.removeItem(p)}return g}var c=l();function u(){if(!(this instanceof u))return new u}u.prototype={set:function(p,m){if(p&&!t(p))c.setItem(p,s(m));else if(t(p))for(var E in p)this.set(E,p[E]);return this},get:function(p){if(p===void 0){var m={};return this.forEach(function(Jn,Zn){return m[Jn]=Zn}),m}if(p.charAt(0)==="?")return this.has(p.substr(1));var E=arguments;if(E.length>1){for(var P={},C=0,Ke=E.length;C<Ke;C++){var Xn=i(c.getItem(E[C]));this.has(E[C])&&(P[E[C]]=Xn)}return P}return i(c.getItem(p))},clear:function(){return c.clear(),this},remove:function(p){var m=this.get(p);return c.removeItem(p),m},has:function(p){return{}.hasOwnProperty.call(this.get(),p)},keys:function(){var p=[];return this.forEach(function(m){p.push(m)}),p},forEach:function(p){for(var m=0,E=c.length;m<E;m++){var P=c.key(m);p(P,this.get(P))}return this},search:function(p){for(var m=this.keys(),E={},P=0,C=m.length;P<C;P++)m[P].indexOf(p)>-1&&(E[m[P]]=this.get(m[P]));return E},len:function(){return c.length}};var h=null;function v(g,p){var m=arguments,E=null;if(h||(h=u()),m.length===0)return h.get();if(m.length===1){if(typeof g=="string")return h.get(g);if(t(g))return h.set(g)}if(m.length===2&&typeof g=="string"){if(!p)return h.remove(g);if(p&&typeof p=="string")return h.set(g,p);p&&r(p)&&(E=null,E=p(g,h.get(g)),v.set(g,E))}if(m.length===2&&a(g)&&r(p))for(var P=0,C=g.length;P<C;P++)E=p(g[P],h.get(g[P])),v.set(g[P],E);return v}for(var T in u.prototype)v[T]=u.prototype[T];return v})})($n);var Vo=$n.exports;const ee=Ho(Vo);class Ko{constructor(e={},t){S(this,"isSupportAvailable",!0);S(this,"isEnabled",!0);S(this,"length",0);this.options=$o(),this.logger=t,this.configure(e)}configure(e){return this.options=k(this.options,e),this.isSupportAvailable=ue(B,this,this.logger),this.isEnabled=!!(this.options.enabled&&this.isSupportAvailable),this.options}setItem(e,t){ee.set(e,t),this.length=ee.len()}getItem(e){const t=ee.get(e);return L(t)?null:t}removeItem(e){ee.remove(e),this.length=ee.len()}clear(){ee.clear(),this.length=0}key(e){return this.keys()[e]??null}keys(){return ee.keys()}}const xn=new Ko({},V);class Qo{constructor(e={},t){S(this,"isSupportAvailable",!0);S(this,"isEnabled",!0);S(this,"length",0);S(this,"store",globalThis.sessionStorage);this.options=xo(),this.logger=t,this.configure(e)}configure(e){return this.options=k(this.options,e),this.isSupportAvailable=ue(G,this,this.logger),this.isEnabled=!!(this.options.enabled&&this.isSupportAvailable),this.options}setItem(e,t){this.store.setItem(e,t),this.length=this.store.length}getItem(e){const t=this.store.getItem(e);return L(t)?null:t}removeItem(e){this.store.removeItem(e),this.length=this.store.length}clear(){this.store.clear(),this.length=0}key(e){return this.store.key(e)}keys(){const e=[];for(let t=0;t<this.store.length;t+=1){const s=this.store.key(t);s!==null&&e.push(s)}return e}}const Gn=new Qo({},V),x=n=>{switch(n){case B:return xn;case G:return Gn;case K:return gt;case $:return new $e({},V);default:return gt}},zo=n=>{const e=new $e({},V).configure(n);o.storage.cookie.value={maxage:e.maxage,path:e.path,domain:e.domain,samesite:e.samesite,expires:e.expires,secure:e.secure}},qo=n=>{xn.configure(n)},Wo=n=>{gt.configure(n)},Yo=n=>{Gn.configure(n)},Xo=(n={},e={},t={},s={})=>{zo(n),qo(e),Wo(t),Yo(s)};class Jo{constructor(e,t,s){S(this,"hasErrorHandler",!1);this.id=e.id,this.name=e.name,this.isEncrypted=e.isEncrypted??!1,this.validKeys=e.validKeys??{},this.engine=t??x(B),this.noKeyValidation=Object.keys(this.validKeys).length===0,this.noCompoundKey=e.noCompoundKey,this.originalEngine=this.engine,this.errorHandler=e.errorHandler??He,this.hasErrorHandler=!!this.errorHandler,this.logger=e.logger??V,this.pluginsManager=s}createValidKey(e){const{name:t,id:s,validKeys:i,noKeyValidation:r,noCompoundKey:a}=this;if(r)return a?e:[t,s,e].join(".");let l;return Object.values(i).forEach(c=>{c===e&&(l=a?e:[t,s,e].join("."))}),l}swapQueueStoreToInMemoryEngine(){const{name:e,id:t,validKeys:s,noCompoundKey:i}=this,r=x(K);Object.keys(s).forEach(a=>{const l=this.get(s[a]),c=i?a:[e,t,a].join(".");r.setItem(c,l),this.remove(a)}),this.engine=r}set(e,t){var i;const s=this.createValidKey(e);if(s)try{this.engine.setItem(s,this.encrypt(X(t,!1,[],this.logger)))}catch(r){Bn(r)?((i=this.logger)==null||i.warn(rr(`Store ${this.id}`)),this.swapQueueStoreToInMemoryEngine(),this.set(e,t)):this.onError(Re(r,Hi(e)))}}get(e){const t=this.createValidKey(e);try{if(!t)return null;const s=this.decrypt(this.engine.getItem(t));return H(s)?null:JSON.parse(s)}catch(s){return this.onError(new Error(`${Vi(e)}: ${s.message}`)),null}}remove(e){const t=this.createValidKey(e);t&&this.engine.removeItem(t)}getOriginalEngine(){return this.originalEngine}decrypt(e){return H(e)?null:this.crypto(e,"decrypt")}encrypt(e){return this.crypto(e,"encrypt")}crypto(e,t){if(!this.isEncrypted||!e||typeof e!="string"||Ns(e)==="")return e;const i=`storage.${t}`,r=this.pluginsManager?this.pluginsManager.invokeSingle(i,e):e;return typeof r>"u"?e:r??""}onError(e){var t;if(this.hasErrorHandler)(t=this.errorHandler)==null||t.onError(e,`Store ${this.id}`);else throw e}}const Zo=(n,e)=>{var s;let t;if(n.consents.preConsent.value.enabled)switch((s=n.consents.preConsent.value.storage)==null?void 0:s.strategy){case"none":t=ie;break;case"session":e!=="sessionInfo"&&(t=ie);break;case"anonymousId":e!=="anonymousId"&&(t=ie);break}return t};class ea{constructor(e,t,s){S(this,"stores",{});S(this,"isInitialized",!1);S(this,"hasErrorHandler",!1);this.errorHandler=t,this.logger=s,this.hasErrorHandler=!!this.errorHandler,this.pluginsManager=e,this.onError=this.onError.bind(this)}init(){var s;if(this.isInitialized)return;const e=o.loadOptions.value,t={cookieStorageOptions:{samesite:e.sameSiteCookie,secure:e.secureCookie,domain:e.setCookieDomain,sameDomainCookiesOnly:e.sameDomainCookiesOnly,enabled:!0},localStorageOptions:{enabled:!0},inMemoryStorageOptions:{enabled:!0},sessionStorageOptions:{enabled:!0}};Xo(pe(k(t.cookieStorageOptions??{},((s=o.storage.cookie)==null?void 0:s.value)??{})),pe(t.localStorageOptions),pe(t.inMemoryStorageOptions),pe(t.sessionStorageOptions)),this.initClientDataStores(),this.isInitialized=!0}initClientDataStores(){this.initializeStorageState(),[K,B,$,G].forEach(t=>{var s;(s=x(t))!=null&&s.isEnabled&&this.setStore({id:ae[t],name:ae[t],isEncrypted:!0,noCompoundKey:!0,type:t})})}initializeStorageState(){var a;let e=o.storage.type.value,t=(a=o.loadOptions.value.storage)==null?void 0:a.entries;const s=o.consents.postConsent.value.storage;(_(s==null?void 0:s.type)||_(s==null?void 0:s.entries))&&(e=s==null?void 0:s.type,t=s==null?void 0:s.entries);let i=!0,r={};Un.forEach(l=>{var p;const c=l,u=l,h=(p=t==null?void 0:t[c])==null?void 0:p.type,T=Zo(o,l)??h??e??ot,g=this.getResolvedStorageTypeForEntry(T,l);g!==ie&&(i=!1),r={...r,[l]:{type:g,key:oe[u]}}}),M(()=>{o.storage.type.value=e,o.storage.entries.value=r,o.storage.trulyAnonymousTracking.value=i})}getResolvedStorageTypeForEntry(e,t){var i,r,a,l,c,u;let s=e;switch(e){case B:(i=x(B))!=null&&i.isEnabled||(s=K);break;case G:(r=x(G))!=null&&r.isEnabled||(s=K);break;case K:case ie:break;case $:default:(a=x($))!=null&&a.isEnabled?s=$:(l=x(B))!=null&&l.isEnabled?s=B:(c=x(G))!=null&&c.isEnabled?s=G:s=K;break}return s!==e&&((u=this.logger)==null||u.warn(or(_t,t,e,s))),s}setStore(e){const t=x(e.type);return this.stores[e.id]=new Jo(e,t,this.pluginsManager),this.stores[e.id]}getStore(e){return this.stores[e]}onError(e){var t;if(this.hasErrorHandler)(t=this.errorHandler)==null||t.onError(e,_t);else throw e}}const ta=n=>n.replace(/\/{2,}/g,"/"),ge=n=>{if(!N(n))return!1;try{return f(globalThis.URL)&&new URL(n),Sr.test(n)}catch{return!1}},na=n=>{if(!N(n)||n.trim().length===0)throw new Error(Bi(n))},sa=n=>{if(!ge(n))throw new Error($i(n))},ia=(n,e)=>{na(n),sa(e)},ra=n=>y(n)&&y(n.source)&&!H(n.source.id)&&y(n.source.config)&&Array.isArray(n.source.destinations),oa=n=>typeof n=="string"&&In.includes(n),Fn=n=>{const e=new URL(n),{host:t,protocol:s}=e,i=t.split(".");let r;return i.length>2?r=`${i[i.length-2]}.${i[i.length-1]}`:r=t,{topDomain:r,protocol:s}},aa=n=>{const{topDomain:e,protocol:t}=Fn(n);return`${t}//${e}`},la=(n,e)=>{const t=e?window.location.origin:aa(window.location.href),s=n.startsWith("/")?n.substring(1):n;return`${t}/${s}`},ca=n=>{const{topDomain:e}=Fn(window.location.href);return e===n},ua=n=>{const e=[];return n.forEach(t=>{t.enabled&&!t.deleted&&e.push({id:t.id,displayName:t.destinationDefinition.displayName,config:t.config,shouldApplyDeviceModeTransformation:t.shouldApplyDeviceModeTransformation||!1,propagateEventsUntransformedOnError:t.propagateEventsUntransformedOnError||!1,userFriendlyId:`${t.destinationDefinition.displayName.replaceAll(" ","-")}___${t.id}`})}),e},he=n=>n!=null&&n.endsWith("/")?he(n.substring(0,n.length-1)):n,ht=n=>{try{return new URL(n).host}catch{return null}},jn=n=>ht(n)??"",da=n=>{const e={};try{const t=new URL(n),s="utm_";t.searchParams.forEach((i,r)=>{if(r.startsWith(s)){let a=r.substring(s.length);a==="campaign"&&(a="name"),e[a]=i}})}catch{}return e},ga=n=>{let e=n;try{const t=new URL(n);e=t.origin+t.pathname+t.search}catch{}return e},ha=()=>!!(window.chrome&&window.chrome.runtime&&window.chrome.runtime.id),We="none",Ye="immediate",fa=n=>{var e,t;return((t=(e=n==null?void 0:n.statsCollection)==null?void 0:e.errors)==null?void 0:t.enabled)===!0},pa=n=>{var e,t;return(t=(e=n==null?void 0:n.statsCollection)==null?void 0:e.errors)==null?void 0:t.provider},va=n=>{var e,t;return((t=(e=n==null?void 0:n.statsCollection)==null?void 0:e.metrics)==null?void 0:t.enabled)===!0},Ve={All:!0},Ea=n=>{const e={sendPageEvent:!1,trackConsent:!1,discardPreConsentEvents:!1};if(y(n)){const t=R(n);e.storage=t.storage,_(t.integrations)&&(e.integrations=y(t.integrations)?t.integrations:Ve),e.discardPreConsentEvents=t.discardPreConsentEvents===!0,e.sendPageEvent=t.sendPageEvent===!0,e.trackConsent=t.trackConsent===!0,Ge(t.consentManagement)&&(e.consentManagement=k(t.consentManagement,{enabled:o.consents.enabled.value}))}return e},qt=n=>Ge(n)||Array.isArray(n),ma=(n,e)=>{let{provider:t}=n;const s=t?lt[t]:void 0;return t&&!s&&(e==null||e.error(_i(j,t,lt)),t=void 0),{provider:t,consentManagerPluginName:s}},Hn=(n,e)=>{let t,s=[],i=[],r=!1,a,l=(n==null?void 0:n.enabled)===!0;Ge(n)&&l&&({provider:a,consentManagerPluginName:t}=ma(n,e),qt(n.allowedConsentIds)&&(s=n.allowedConsentIds,r=!0),qt(n.deniedConsentIds)&&(i=n.deniedConsentIds,r=!0));const c={allowedConsentIds:s,deniedConsentIds:i};return l=l&&!!t,{provider:a,consentManagerPluginName:t,initialized:r,enabled:l,consentsData:c}},ya=()=>{const n=document.getElementsByTagName("script"),e=/(?:^|\/)rsa(\.min)?\.js$/;for(const t of n){const s=t.getAttribute("src");if(s&&e.test(s))return s}},ba=(n,e)=>{if(o.reporting.isErrorReportingEnabled.value=fa(n.source.config)&&!ha(),o.reporting.isMetricsReportingEnabled.value=va(n.source.config),o.reporting.isErrorReportingEnabled.value){const t=pa(n.source.config),s=t?Ce[t]:void 0;!L(t)&&!s&&(e==null||e.warn(Wi(j,t,Ce,at))),o.reporting.errorReportingProviderPluginName.value=s??Ce[at]}},Sa=n=>{var v;const{useServerSideCookies:e,dataServiceEndpoint:t,storage:s,setCookieDomain:i,sameDomainCookiesOnly:r}=o.loadOptions.value;let a=s==null?void 0:s.type;_(a)&&!oa(a)&&(n==null||n.warn(qi(j,a,ot)),a=ot);let l=(v=s==null?void 0:s.encryption)==null?void 0:v.version;const c=l&&Ne[l];!L(l)&&L(c)?(n==null||n.warn(Yi(j,l,Ne,ne)),l=ne):L(l)&&(l=ne);const u=s==null?void 0:s.migrate,h=u&&l===ne;u===!0&&h!==u&&(n==null||n.warn(Xi(j,l,ne))),M(()=>{o.storage.type.value=a;let T=(s==null?void 0:s.cookie)??{};if(e){o.serverCookies.isEnabledServerSideCookies.value=e;const g=T.domain??i,p=_(g)&&!ca(Tt(g))||r,m=la(t??Tr,p??!1);if(ge(m)){o.serverCookies.dataServiceUrl.value=he(m);const E=ht(window.location.href),P=ht(m);E!==P&&(T={...T,samesite:"None",secure:!0}),!r&&p&&P!==Tt(g)&&(o.serverCookies.isEnabledServerSideCookies.value=!1,n==null||n.warn(Ji(j,g,P)))}else o.serverCookies.isEnabledServerSideCookies.value=!1}o.storage.cookie.value=T,o.storage.encryptionPluginName.value=Ne[l],o.storage.migrate.value=h})},Ra=n=>{var v,T,g,p;const{provider:e,consentManagerPluginName:t,initialized:s,enabled:i,consentsData:r}=Hn(o.loadOptions.value.consentManagement,n),a=o.loadOptions.value.preConsent;let l=((v=a==null?void 0:a.storage)==null?void 0:v.strategy)??We;const c=["none","session","anonymousId"];_(l)&&!c.includes(l)&&(l=We,n==null||n.warn(Er(j,(T=a==null?void 0:a.storage)==null?void 0:T.strategy,We)));let u=((g=a==null?void 0:a.events)==null?void 0:g.delivery)??Ye;const h=["immediate","buffer"];_(u)&&!h.includes(u)&&(u=Ye,n==null||n.warn(mr(j,(p=a==null?void 0:a.events)==null?void 0:p.delivery,Ye))),M(()=>{var m;o.consents.activeConsentManagerPluginName.value=t,o.consents.initialized.value=s,o.consents.enabled.value=i,o.consents.data.value=r,o.consents.provider.value=e,o.consents.preConsent.value={enabled:((m=o.loadOptions.value.preConsent)==null?void 0:m.enabled)===!0&&s===!1&&i===!0,storage:{strategy:l},events:{delivery:u}}})},Ia=n=>{var s;let e=o.consents.resolutionStrategy.value,t;y(n.consentManagementMetadata)&&(o.consents.provider.value&&(e=((s=n.consentManagementMetadata.providers.find(i=>i.provider===o.consents.provider.value))==null?void 0:s.resolutionStrategy)??o.consents.resolutionStrategy.value),t=n.consentManagementMetadata),o.consents.provider.value==="custom"&&(e=void 0),M(()=>{o.consents.metadata.value=R(t),o.consents.resolutionStrategy.value=e})},Ta=n=>{if(o.dataPlaneEvents.deliveryEnabled.value){const e="XhrQueue";let t=e;o.loadOptions.value.useBeacon&&(o.capabilities.isBeaconAvailable.value?t="BeaconQueue":(t=e,n==null||n.warn(er(j)))),M(()=>{o.dataPlaneEvents.eventsQueuePluginName.value=t})}},Aa=(n,e,t,s,i)=>{const r=new URLSearchParams({p:fn,v:ye,build:Se,writeKey:e,lockIntegrationsVersion:t.toString(),lockPluginsVersion:s.toString()});let a=kn,l=r,c="/sourceConfig/",u="";if(ge(n)){const h=new URL(n);he(h.pathname).endsWith("/sourceConfig")||(h.pathname=`${he(h.pathname)}/sourceConfig/`),h.pathname=ta(h.pathname),r.forEach((v,T)=>{h.searchParams.get(T)===null&&h.searchParams.set(T,v)}),a=h.origin,c=h.pathname,l=h.searchParams,u=h.hash}else i==null||i.warn(pr(j,n));return`${a}${c}?${l}${u}`},Vn=(n,e,t,s,i,r)=>{let a="";if(r){if(!ge(r))throw new Error(Ai(n));return he(r)}const l=ya();return a=l?l.split("/").slice(0,-1).concat(e).join("/"):t,i&&(a=a.replace(`/${bt}/${Se}/${e}`,`/${s}/${Se}/${e}`)),a},_a=(n,e,t)=>Vn("integrations",Tn,On,n,e,t),Oa=(n,e,t)=>Vn("plugins",An,Pn,n,e,t);class Pa{constructor(e,t,s){S(this,"hasErrorHandler",!1);this.errorHandler=t,this.logger=s,this.httpClient=e,this.hasErrorHandler=!!this.errorHandler,this.onError=this.onError.bind(this),this.processConfig=this.processConfig.bind(this)}attachEffects(){q(()=>{var e;(e=this.logger)==null||e.setMinLogLevel(o.lifecycle.logLevel.value)})}init(){this.attachEffects(),ia(o.lifecycle.writeKey.value,o.lifecycle.dataPlaneUrl.value);const{logLevel:e,configUrl:t,lockIntegrationsVersion:s,lockPluginsVersion:i,destSDKBaseURL:r,pluginsSDKBaseURL:a}=o.loadOptions.value;o.lifecycle.activeDataplaneUrl.value=he(o.lifecycle.dataPlaneUrl.value);const l=_a(ye,s,r),c=Oa(ye,i,a);Sa(this.logger),Ra(this.logger),Ta(this.logger),M(()=>{o.lifecycle.integrationsCDNPath.value=l,o.lifecycle.pluginsCDNPath.value=c,e&&(o.lifecycle.logLevel.value=e),o.lifecycle.sourceConfigUrl.value=Aa(t,o.lifecycle.writeKey.value,s,i,this.logger)}),this.getConfig()}onError(e,t,s){var i;if(this.hasErrorHandler)(i=this.errorHandler)==null||i.onError(e,j,t,s);else throw e}processConfig(e,t){var r;if(!e){this.onError(Ui(t==null?void 0:t.error));return}let s;try{N(e)?s=JSON.parse(e):s=e}catch(a){this.onError(a,Bt,!0);return}if(!ra(s)){this.onError(new Error(Bt),void 0,!0);return}if(s.source.enabled===!1){(r=this.logger)==null||r.error(bi);return}ba(s,this.logger);const i=s.source.destinations.length>0?ua(s.source.destinations):[];M(()=>{o.source.value={config:s.source.config,id:s.source.id,workspaceId:s.source.workspaceId},o.nativeDestinations.configuredDestinations.value=i,o.plugins.pluginsToLoadFromConfig.value=o.loadOptions.value.plugins??[],Ia(s),o.lifecycle.status.value="configured"})}getConfig(){const e=o.loadOptions.value.getSourceConfig;if(e){if(!f(e))throw new Error(yi);const t=e();t instanceof Promise?t.then(s=>this.processConfig(s)).catch(s=>{this.onError(s,"SourceConfig")}):this.processConfig(t)}else this.httpClient.getAsyncData({url:o.lifecycle.sourceConfigUrl.value,options:{headers:{"Content-Type":void 0}},callback:this.processConfig})}}const ka=()=>{const n=new Date().toString().match(/([A-Z]+[+-]\d+)/);return n&&n[1]?n[1]:"NA"},Kn=()=>(document==null?void 0:document.referrer)||"$direct",Ca=()=>{const n=document.getElementsByTagName("link");let e="";for(let t=0;n[t];t+=1){const s=n[t];if(s.getAttribute("rel")==="canonical"&&!e){e=s.getAttribute("href")??"";break}}return e},Na=()=>{if(L(globalThis.navigator))return null;let{userAgent:n}=globalThis.navigator;const{brave:e}=globalThis.navigator;if(e&&Object.getPrototypeOf(e).isBrave){const t=n.match(/(chrome)\/([\w.]+)/i);t&&(n=`${n} Brave/${t[2]}`)}return n},La=()=>L(globalThis.navigator)?null:globalThis.navigator.language??globalThis.navigator.browserLanguage,Qn=()=>{const n=Ca();let e=globalThis.location.pathname;const{href:t}=globalThis.location;let s=t;const{search:i}=globalThis.location;if(n)try{const c=new URL(n);c.search===""?s=n+i:s=n,e=c.pathname}catch{}const r=ga(s),{title:a}=document,l=Kn();return{path:e,referrer:l,referring_domain:jn(l),search:i,title:a,url:r,tab_url:t}},Da=`https://polyfill-fastly.io/v3/polyfill.min.js?version=3.111.0&features=${Object.keys(dt).join("%2C")}`,wa=10*1e3,Wt="rudderstackPolyfill";class Ma{constructor(e,t){this.logger=t,this.errorHandler=e,this.externalSrcLoader=new vn(this.errorHandler,this.logger),this.onError=this.onError.bind(this),this.onReady=this.onReady.bind(this)}init(){try{this.prepareBrowserCapabilities(),this.attachWindowListeners()}catch(e){this.onError(e)}}detectBrowserCapabilities(){M(()=>{o.capabilities.storage.isCookieStorageAvailable.value=ue($,x($),this.logger),o.capabilities.storage.isLocalStorageAvailable.value=ue(B,void 0,this.logger),o.capabilities.storage.isSessionStorageAvailable.value=ue(G,void 0,this.logger),o.capabilities.isBeaconAvailable.value=ko(),o.capabilities.isUaCHAvailable.value=Qt(),o.capabilities.isCryptoAvailable.value=Po(),o.capabilities.isIE11.value=Co(),o.capabilities.isOnline.value=globalThis.navigator.onLine,o.context.userAgent.value=Na(),o.context.locale.value=La(),o.context.screen.value=zt(),o.context.timezone.value=ka(),Qt()&&No(e=>{o.context["ua-ch"].value=e},o.loadOptions.value.uaChTrackLevel)}),q(()=>{o.loadOptions.value.sendAdblockPage===!0&&o.lifecycle.sourceConfigUrl.value!==void 0&&Oo(this.errorHandler,this.logger)})}prepareBrowserCapabilities(){var i;o.capabilities.isLegacyDOM.value=Do();const e=o.loadOptions.value.polyfillURL;let t=Da;if(de(e)&&(ge(e)?t=e:(i=this.logger)==null||i.warn(br(st,e))),o.loadOptions.value.polyfillIfRequired&&o.capabilities.isLegacyDOM.value&&ge(t)){const r=t!==o.loadOptions.value.polyfillURL;if(r){const a=`RS_polyfillCallback_${o.lifecycle.writeKey.value}`,l=()=>{this.onReady(),delete globalThis[a]};globalThis[a]=l,t=`${t}&callback=${a}`}this.externalSrcLoader.loadJSFile({url:t,id:Wt,async:!0,timeout:wa,callback:a=>{a?r||this.onReady():this.onError(new Error(vr(Wt,t)))}})}else this.onReady()}attachWindowListeners(){globalThis.addEventListener("offline",()=>{o.capabilities.isOnline.value=!1}),globalThis.addEventListener("online",()=>{o.capabilities.isOnline.value=!0}),globalThis.addEventListener("resize",Ys(()=>{o.context.screen.value=zt()},this))}onReady(){this.detectBrowserCapabilities(),o.lifecycle.status.value="browserCapabilitiesReady"}onError(e){if(this.errorHandler)this.errorHandler.onError(e,st);else throw e}}function Ua(n){return crypto.getRandomValues(new Uint8Array(n))}var Yt=4096,De=[],J=0,Xe;for(;J<256;J++)De[J]=(J+256).toString(16).substring(1);function Ba(){(!Xe||J+16>Yt)&&(Xe=Ua(Yt),J=0);for(var n=0,e,t="";n<16;n++)e=Xe[J+n],n==6?t+=De[e&15|64]:n==8?t+=De[e&63|128]:t+=De[e],n&1&&n>1&&n<11&&(t+="-");return J+=16,t}var se=256,we=[],ke;for(;se--;)we[se]=(se+256).toString(16).substring(1);function $a(){var n=0,e,t="";if(!ke||se+16>256){for(ke=Array(n=256);n--;)ke[n]=256*Math.random()|0;n=se=0}for(;n<16;n++)e=ke[se+n],n==6?t+=we[e&15|64]:n==8?t+=we[e&63|128]:t+=we[e],n&1&&n>1&&n<11&&(t+="-");return se++,t}const xa=()=>!H(globalThis.crypto)&&f(globalThis.crypto.getRandomValues),zn=()=>xa()?Ba():$a(),Ga=()=>new Date().toISOString(),Fa="web",ja=["integrations","anonymousId","originalTimestamp"],Xt=["library","consentManagement","userAgent","ua-ch","screen"],Je=["id","anonymous_id","user_id","sent_at","timestamp","received_at","original_timestamp","event","event_text","channel","context_ip","context_request_ip","context_passed_ip","group_id","previous_id"],qn=n=>typeof n=="number"&&!Number.isNaN(n),Ha=(n,e)=>e.toString().length>=n,Wn=n=>qn(n)&&n>=0&&Number.isInteger(n),Jt=10,Zt=n=>{const e=Date.now();return!n||e>n},Va=()=>Date.now(),Ka=(n,e)=>!n||!Wn(n)||!Ha(Jt,n)?(e==null||e.warn(ir(ve,n,Jt)),!1):!0,Qa=n=>{const e=Date.now(),t=n||be;return{id:e,expiresAt:e+t,timeout:t,sessionStart:void 0,autoTrack:!0}},za=(n,e)=>({id:Ka(n,e)?n:Va(),sessionStart:void 0,manualTrack:!0}),Ee=n=>n===$||n===B||n===G||n===K,ft=()=>zn(),qa=n=>{const e=Qn(),t={};return Object.keys(e).forEach(s=>{t[s]=(n==null?void 0:n[s])||e[s]}),t.initial_referrer=(n==null?void 0:n.initial_referrer)||o.session.initialReferrer.value,t.initial_referring_domain=(n==null?void 0:n.initial_referring_domain)||o.session.initialReferringDomain.value,t},Wa=(n,e)=>{const t=(e==null?void 0:e.page)||{},s=n,i=Qn();return Object.keys(i).forEach(r=>{L(s[r])&&(s[r]=t[r]||i[r])}),L(s.initial_referrer)&&(s.initial_referrer=t.initial_referrer||o.session.initialReferrer.value),L(s.initial_referring_domain)&&(s.initial_referring_domain=t.initial_referring_domain||o.session.initialReferringDomain.value),s},Ze=(n,e,t)=>{y(n)&&Object.keys(n).forEach(s=>{(Je.includes(s)||Je.includes(s.toLowerCase()))&&(t==null||t.warn(Zi(hn,s,e,Je)))})},Ya=(n,e)=>{const{properties:t,traits:s,context:i}=n,{traits:r}=i;Ze(t,"properties",e),Ze(s,"traits",e),Ze(r,"context.traits",e)},Xa=(n,e)=>{e.anonymousId&&N(e.anonymousId)&&(n.anonymousId=e.anonymousId),y(e.integrations)&&(n.integrations=e.integrations),e.originalTimestamp&&N(e.originalTimestamp)&&(n.originalTimestamp=e.originalTimestamp)},Ja=(n,e,t)=>{let s=n;return Object.keys(e).forEach(i=>{if(!ja.includes(i)&&!Xt.includes(i)){if(i!=="context")s=k(s,{[i]:e[i]});else if(!L(e[i])&&y(e[i])){const r={};Object.keys(e[i]).forEach(a=>{Xt.includes(a)||(r[a]=e[i][a])}),s=k(s,{...r})}}}),s},Za=()=>{var n;return o.loadOptions.value.useGlobalIntegrationsConfigInEvents&&(y((n=o.consents.postConsent.value)==null?void 0:n.integrations)||y(o.nativeDestinations.loadOnlyIntegrations.value))},el=(n,e)=>{y(e)&&(Xa(n,e),n.context=Ja(n.context,e))},tl=n=>{var t;let e;return Za()?e=R(((t=o.consents.postConsent.value)==null?void 0:t.integrations)??o.nativeDestinations.loadOnlyIntegrations.value):y(n)?e=n:e=Ve,e},fe=(n,e,t,s)=>{var a,l,c;const i={channel:Fa,context:{traits:R(o.session.userTraits.value),sessionId:o.session.sessionInfo.value.id||void 0,sessionStart:o.session.sessionInfo.value.sessionStart||void 0,...o.consents.enabled.value&&{consentManagement:{deniedConsentIds:R(o.consents.data.value.deniedConsentIds),allowedConsentIds:R(o.consents.data.value.allowedConsentIds),provider:o.consents.provider.value,resolutionStrategy:o.consents.resolutionStrategy.value}},"ua-ch":o.context["ua-ch"].value,app:o.context.app.value,library:o.context.library.value,userAgent:o.context.userAgent.value,os:o.context.os.value,locale:o.context.locale.value,screen:o.context.screen.value,campaign:da(globalThis.location.href),page:qa(t),timezone:o.context.timezone.value},originalTimestamp:Ga(),integrations:Ve,messageId:zn(),userId:n.userId||o.session.userId.value};Ee((a=o.storage.entries.value.anonymousId)==null?void 0:a.type)?i.anonymousId=o.session.anonymousId.value:i.anonymousId=ft(),o.storage.trulyAnonymousTracking.value&&(i.context.trulyAnonymousTracking=!0),n.type==="identify"&&(i.context.traits=((l=o.storage.entries.value.userTraits)==null?void 0:l.type)!==ie?R(o.session.userTraits.value):n.context.traits),n.type==="group"&&((n.groupId||o.session.groupId.value)&&(i.groupId=n.groupId||o.session.groupId.value),(n.traits||o.session.groupTraits.value)&&(i.traits=((c=o.storage.entries.value.groupTraits)==null?void 0:c.type)!==ie?R(o.session.groupTraits.value):n.traits));const r=k(n,i);return r.event===void 0&&(r.event=null),r.properties===void 0&&(r.properties=null),el(r,e),Ya(r,s),r.integrations=tl(r.integrations),r};class nl{constructor(e){this.logger=e}generatePageEvent(e,t,s,i){let r=s??{};return r.name=t,r.category=e,r=Wa(r,i),fe({properties:r,name:t,category:e,type:"page"},i,r,this.logger)}generateTrackEvent(e,t,s){return fe({properties:t,event:e,type:"track"},s,void 0,this.logger)}generateIdentifyEvent(e,t,s){return fe({userId:e,type:"identify",context:{traits:t}},s,void 0,this.logger)}generateAliasEvent(e,t,s){const r=fe({previousId:t,type:"alias"},s,void 0,this.logger);return r.userId=e??r.userId,r}generateGroupEvent(e,t,s){const i={type:"group"};return e&&(i.groupId=e),t&&(i.traits=t),fe(i,s,void 0,this.logger)}create(e){let t;switch(e.type){case"page":t=this.generatePageEvent(e.category,e.name,e.properties,e.options);break;case"track":t=this.generateTrackEvent(e.name,e.properties,e.options);break;case"identify":t=this.generateIdentifyEvent(e.userId,e.traits,e.options);break;case"alias":t=this.generateAliasEvent(e.to,e.from,e.options);break;case"group":t=this.generateGroupEvent(e.groupId,e.traits,e.options);break}return t}}class sl{constructor(e,t,s,i){this.eventRepository=e,this.userSessionManager=t,this.errorHandler=s,this.logger=i,this.eventFactory=new nl(this.logger),this.onError=this.onError.bind(this)}init(){this.eventRepository.init()}resume(){this.eventRepository.resume()}addEvent(e){this.userSessionManager.refreshSession();const t=this.eventFactory.create(e);t?this.eventRepository.enqueue(t,e.callback):this.onError(new Error(Ri))}onError(e,t,s){if(this.errorHandler)this.errorHandler.onError(e,hn,t,s);else throw e}}class il{constructor(e,t,s,i,r){this.storeManager=i,this.pluginsManager=s,this.logger=t,this.errorHandler=e,this.httpClient=r,this.onError=this.onError.bind(this),this.serverSideCookieDebounceFuncs={}}init(){this.syncStorageDataToState(),this.registerEffects()}syncStorageDataToState(){this.migrateStorageIfNeeded(),this.migrateDataFromPreviousStorage(),this.setUserId(this.getUserId()),this.setUserTraits(this.getUserTraits()),this.setGroupId(this.getGroupId()),this.setGroupTraits(this.getGroupTraits());const{externalAnonymousIdCookieName:e,anonymousIdOptions:t}=o.loadOptions.value;let s;de(e)&&typeof e=="string"&&(s=this.getExternalAnonymousIdByCookieName(e)),this.setAnonymousId(s??this.getAnonymousId(t)),this.setAuthToken(this.getAuthToken()),this.setInitialReferrerInfo(),this.configureSessionTracking()}configureSessionTracking(){let e=this.getSessionInfo();if(this.isPersistenceEnabledForStorageEntry("sessionInfo")){const t=this.getConfiguredSessionTrackingInfo(),s=e??Pr;e={...s,...t,autoTrack:t.autoTrack&&s.manualTrack!==!0}}o.session.sessionInfo.value=this.isPersistenceEnabledForStorageEntry("sessionInfo")?e:I.sessionInfo,o.session.sessionInfo.value.autoTrack&&this.startOrRenewAutoTracking(o.session.sessionInfo.value)}setInitialReferrerInfo(){const e=this.getInitialReferrer(),t=this.getInitialReferringDomain();if(e&&t)this.setInitialReferrer(e),this.setInitialReferringDomain(t);else{const s=e||Kn();this.setInitialReferrer(s),this.setInitialReferringDomain(jn(s))}}isPersistenceEnabledForStorageEntry(e){var t;return Ee((t=o.storage.entries.value[e])==null?void 0:t.type)}migrateDataFromPreviousStorage(){const e=o.storage.entries.value,t=[$,B,G];Object.keys(e).forEach(s=>{var l,c;const i=s,r=(l=e[i])==null?void 0:l.type,a=(c=this.storeManager)==null?void 0:c.getStore(ae[r]);a&&t.forEach(u=>{var v;const h=(v=this.storeManager)==null?void 0:v.getStore(ae[u]);if(h&&u!==r){const T=h.get(oe[i]);Ps(T)&&a.set(oe[i],T),h.remove(oe[i])}})})}migrateStorageIfNeeded(){if(!o.storage.migrate.value)return;const e=[Dn,wn,Mn],t=[];e.forEach(s=>{var r;const i=(r=this.storeManager)==null?void 0:r.getStore(s);i&&t.push(i)}),Object.keys(oe).forEach(s=>{const i=oe[s];t.forEach(r=>{var l;const a=(l=this.pluginsManager)==null?void 0:l.invokeSingle("storage.migrate",i,r.engine,this.errorHandler,this.logger);H(a)||r.set(i,a)})})}getConfiguredSessionTrackingInfo(){var i,r,a,l,c;let e=((i=o.loadOptions.value.sessions)==null?void 0:i.autoTrack)!==!1;if(!e)return{autoTrack:e};let t;const s=(r=o.loadOptions.value.sessions)==null?void 0:r.timeout;return Wn(s)?t=s:((a=this.logger)==null||a.warn(tr(ve,s,be)),t=be),t===0&&((l=this.logger)==null||l.warn(nr(ve)),e=!1),t>0&&t<Dt&&((c=this.logger)==null||c.warn(sr(ve,t,Dt))),{timeout:t,autoTrack:e}}onError(e,t){if(this.errorHandler)this.errorHandler.onError(e,ve,t);else throw e}getEncryptedCookieData(e,t){const s=[];return e.forEach(i=>{const r=t==null?void 0:t.encrypt(X(i.value,!1,[],this.logger));de(r)&&s.push({name:i.name,value:r})}),s}makeRequestToSetCookie(e,t){var s,i,r,a,l,c,u,h;(h=this.httpClient)==null||h.getAsyncData({url:o.serverCookies.dataServiceUrl.value,options:{method:"POST",data:X({reqType:"setCookies",workspaceId:(s=o.source.value)==null?void 0:s.workspaceId,data:{options:{maxAge:(i=o.storage.cookie.value)==null?void 0:i.maxage,path:(r=o.storage.cookie.value)==null?void 0:r.path,domain:(a=o.storage.cookie.value)==null?void 0:a.domain,sameSite:(l=o.storage.cookie.value)==null?void 0:l.samesite,secure:(c=o.storage.cookie.value)==null?void 0:c.secure,expires:(u=o.storage.cookie.value)==null?void 0:u.expires},cookies:e}}),sendRawData:!0,withCredentials:!0},isRawResponse:!0,callback:t})}setServerSideCookies(e,t,s){try{const i=this.getEncryptedCookieData(e,s);i.length>0&&this.makeRequestToSetCookie(i,(r,a)=>{var l,c,u;((l=a==null?void 0:a.xhr)==null?void 0:l.status)===200?e.forEach(h=>{var p;const v=s==null?void 0:s.get(h.name),T=X(h.value,!1,[]);X(v,!1,[])!==T&&((p=this.logger)==null||p.error(Qi(h.name)),t&&t(h.name,h.value))}):((u=this.logger)==null||u.error(Ki((c=a==null?void 0:a.xhr)==null?void 0:c.status)),e.forEach(h=>{t&&t(h.name,h.value)}))})}catch(i){this.onError(i,zi),e.forEach(r=>{t&&t(r.name,r.value)})}}syncValueToStorage(e,t){var r,a,l;const s=o.storage.entries.value,i=(r=s[e])==null?void 0:r.type;if(Ee(i)){const c=(a=this.storeManager)==null?void 0:a.getStore(ae[i]),u=(l=s[e])==null?void 0:l.key;t&&(N(t)||Ge(t))?o.serverCookies.isEnabledServerSideCookies.value&&i===$?(this.serverSideCookieDebounceFuncs[e]&&globalThis.clearTimeout(this.serverSideCookieDebounceFuncs[e]),this.serverSideCookieDebounceFuncs[e]=globalThis.setTimeout(()=>{this.setServerSideCookies([{name:u,value:t}],(h,v)=>{c==null||c.set(h,v)},c)},Or)):c==null||c.set(u,t):c==null||c.remove(u)}}registerEffects(){Un.forEach(e=>{q(()=>{this.syncValueToStorage(e,o.session[e].value)})})}setAnonymousId(e,t){var i;let s=e;this.isPersistenceEnabledForStorageEntry("anonymousId")?(!s&&t&&(s=(i=this.pluginsManager)==null?void 0:i.invokeSingle("userSession.anonymousIdGoogleLinker",t)),s=s||ft()):s=I.anonymousId,o.session.anonymousId.value=s}getAnonymousId(e){var s,i;const t=(s=o.storage.entries.value.anonymousId)==null?void 0:s.type;if(Ee(t)){let r=this.getEntryValue("anonymousId");!r&&e&&(r=(i=this.pluginsManager)==null?void 0:i.invokeSingle("storage.getAnonymousId",x,e)),o.session.anonymousId.value=r||ft()}return o.session.anonymousId.value}getEntryValue(e){var i,r,a;const t=o.storage.entries.value,s=(i=t[e])==null?void 0:i.type;if(Ee(s)){const l=(r=this.storeManager)==null?void 0:r.getStore(ae[s]),c=(a=t[e])==null?void 0:a.key;return(l==null?void 0:l.get(c))??null}return null}getExternalAnonymousIdByCookieName(e){const t=x($);return t!=null&&t.isEnabled?t.getItem(e)??null:null}getUserId(){return this.getEntryValue("userId")}getUserTraits(){return this.getEntryValue("userTraits")}getGroupId(){return this.getEntryValue("groupId")}getGroupTraits(){return this.getEntryValue("groupTraits")}getInitialReferrer(){return this.getEntryValue("initialReferrer")}getInitialReferringDomain(){return this.getEntryValue("initialReferringDomain")}getSessionInfo(){return this.getEntryValue("sessionInfo")}getAuthToken(){return this.getEntryValue("authToken")}getSessionId(){const e=this.getSessionInfo()??I.sessionInfo;return e.autoTrack&&!Zt(e.expiresAt)||e.manualTrack?e.id??null:null}refreshSession(){let e=this.getSessionInfo()??I.sessionInfo;(e.autoTrack||e.manualTrack)&&(e.autoTrack&&(this.startOrRenewAutoTracking(e),e=o.session.sessionInfo.value),e.sessionStart===void 0?e={...e,sessionStart:!0}:e.sessionStart&&(e={...e,sessionStart:!1})),o.session.sessionInfo.value=e,o.lifecycle.status.value!=="readyExecuted"&&this.syncValueToStorage("sessionInfo",e)}reset(e,t){const{session:s}=o,{manualTrack:i,autoTrack:r}=s.sessionInfo.value;M(()=>{s.userId.value=I.userId,s.userTraits.value=I.userTraits,s.groupId.value=I.groupId,s.groupTraits.value=I.groupTraits,s.authToken.value=I.authToken,e&&this.setAnonymousId(),!t&&(r?(s.sessionInfo.value=I.sessionInfo,this.startOrRenewAutoTracking(s.sessionInfo.value)):i&&this.startManualTrackingInternal())})}setUserId(e){o.session.userId.value=this.isPersistenceEnabledForStorageEntry("userId")&&e?e:I.userId}setUserTraits(e){o.session.userTraits.value=this.isPersistenceEnabledForStorageEntry("userTraits")&&e?k(o.session.userTraits.value??I.userTraits,e):I.userTraits}setGroupId(e){o.session.groupId.value=this.isPersistenceEnabledForStorageEntry("groupId")&&e?e:I.groupId}setGroupTraits(e){o.session.groupTraits.value=this.isPersistenceEnabledForStorageEntry("groupTraits")&&e?k(o.session.groupTraits.value??I.groupTraits,e):I.groupTraits}setInitialReferrer(e){o.session.initialReferrer.value=this.isPersistenceEnabledForStorageEntry("initialReferrer")&&e?e:I.initialReferrer}setInitialReferringDomain(e){o.session.initialReferringDomain.value=this.isPersistenceEnabledForStorageEntry("initialReferringDomain")&&e?e:I.initialReferringDomain}startOrRenewAutoTracking(e){if(Zt(e.expiresAt))o.session.sessionInfo.value=Qa(e.timeout);else{const t=Date.now(),s=e.timeout;o.session.sessionInfo.value=k(e,{expiresAt:t+s})}}start(e){o.session.sessionInfo.value=za(e,this.logger)}startManualTrackingInternal(){this.start(Date.now())}end(){o.session.sessionInfo.value=I.sessionInfo}setAuthToken(e){o.session.authToken.value=this.isPersistenceEnabledForStorageEntry("authToken")&&e?e:I.authToken}}const rl=["BeaconQueue","Bugsnag","CustomConsentManager","DeviceModeDestinations","DeviceModeTransformation","ErrorReporting","ExternalAnonymousId","GoogleLinker","KetchConsentManager","NativeDestinationQueue","OneTrustConsentManager","StorageEncryption","StorageEncryptionLegacy","StorageMigrator","XhrQueue"],ol=(n,e)=>{var a,l,c,u;const t=R(e);return N(t.setCookieDomain)||delete t.setCookieDomain,["Strict","Lax","None"].includes(t.sameSiteCookie)||delete t.sameSiteCookie,t.secureCookie=t.secureCookie===!0,["none","default","full"].includes(t.uaChTrackLevel)||delete t.uaChTrackLevel,y(t.integrations)||delete t.integrations,t.plugins=t.plugins??rl,t.useGlobalIntegrationsConfigInEvents=t.useGlobalIntegrationsConfigInEvents===!0,t.bufferDataPlaneEventsUntilReady=t.bufferDataPlaneEventsUntilReady===!0,t.sendAdblockPage=t.sendAdblockPage===!0,t.useServerSideCookies=t.useServerSideCookies===!0,t.dataServiceEndpoint&&typeof t.dataServiceEndpoint!="string"&&delete t.dataServiceEndpoint,y(t.sendAdblockPageOptions)||delete t.sendAdblockPageOptions,_(t.loadIntegration)?t.loadIntegration=t.loadIntegration===!0:delete t.loadIntegration,y(t.storage)?(t.storage=te(t.storage),t.storage.migrate=((a=t.storage)==null?void 0:a.migrate)===!0):delete t.storage,y(t.beaconQueueOptions)?t.beaconQueueOptions=te(t.beaconQueueOptions):delete t.beaconQueueOptions,y(t.destinationsQueueOptions)?t.destinationsQueueOptions=te(t.destinationsQueueOptions):delete t.destinationsQueueOptions,y(t.queueOptions)?t.queueOptions=te(t.queueOptions):delete t.queueOptions,t.lockIntegrationsVersion=t.lockIntegrationsVersion===!0,t.lockPluginsVersion=t.lockPluginsVersion===!0,qn(t.dataPlaneEventsBufferTimeout)||delete t.dataPlaneEventsBufferTimeout,y((l=t.storage)==null?void 0:l.cookie)?t.storage.cookie=te((u=t.storage)==null?void 0:u.cookie):(c=t.storage)==null||delete c.cookie,y(t.preConsent)?t.preConsent=te(t.preConsent):delete t.preConsent,k(n,t)},en="dataplaneEventsQueue",tn="destinationsEventsQueue",al="transformEvent",ll=(n,e)=>Object.keys(n).filter(t=>n[t]!==!0||!e[t]).reduce((t,s)=>{const i=R(t);return i[s]=n[s],i},{}),cl=(n,e)=>{const t=R(n),s=n.integrations??Ve,i=e.nativeDestinations.integrationsConfig.value,r=ll(s,i);return t.integrations=k(i,r),t},ul=n=>{var e,t,s;return n.consents.preConsent.value.enabled&&((e=n.consents.preConsent.value.events)==null?void 0:e.delivery)==="buffer"&&(((t=n.consents.preConsent.value.storage)==null?void 0:t.strategy)==="session"||((s=n.consents.preConsent.value.storage)==null?void 0:s.strategy)==="none")};class dl{constructor(e,t,s,i){this.pluginsManager=e,this.errorHandler=s,this.logger=i,this.httpClient=new St(s,i),this.storeManager=t,this.onError=this.onError.bind(this)}init(){try{this.dataplaneEventsQueue=this.pluginsManager.invokeSingle(`${en}.init`,o,this.httpClient,this.storeManager,this.errorHandler,this.logger)}catch(s){this.onError(s,dr)}try{this.dmtEventsQueue=this.pluginsManager.invokeSingle(`${al}.init`,o,this.pluginsManager,this.httpClient,this.storeManager,this.errorHandler,this.logger)}catch(s){this.onError(s,gr)}try{this.destinationsEventsQueue=this.pluginsManager.invokeSingle(`${tn}.init`,o,this.pluginsManager,this.storeManager,this.dmtEventsQueue,this.errorHandler,this.logger)}catch(s){this.onError(s,ur)}q(()=>{var s,i;o.nativeDestinations.clientDestinationsReady.value===!0&&((s=this.destinationsEventsQueue)==null||s.start(),(i=this.dmtEventsQueue)==null||i.start())});const e=ul(o);let t;q(()=>{var r,a;const s=o.loadOptions.value.bufferDataPlaneEventsUntilReady===!0&&o.nativeDestinations.clientDestinationsReady.value===!1;(o.nativeDestinations.activeDestinations.value.some(l=>Xr(l))===!1||s===!1)&&!e&&((r=this.dataplaneEventsQueue)==null?void 0:r.scheduleTimeoutActive)!==!0&&(globalThis.clearTimeout(t),(a=this.dataplaneEventsQueue)==null||a.start())}),o.loadOptions.value.bufferDataPlaneEventsUntilReady===!0&&(t=globalThis.setTimeout(()=>{var s,i;((s=this.dataplaneEventsQueue)==null?void 0:s.scheduleTimeoutActive)!==!0&&((i=this.dataplaneEventsQueue)==null||i.start())},o.loadOptions.value.dataPlaneEventsBufferTimeout))}resume(){var e,t,s,i;((e=this.dataplaneEventsQueue)==null?void 0:e.scheduleTimeoutActive)!==!0&&(o.consents.postConsent.value.discardPreConsentEvents&&((t=this.dataplaneEventsQueue)==null||t.clear(),(s=this.destinationsEventsQueue)==null||s.clear()),(i=this.dataplaneEventsQueue)==null||i.start())}enqueue(e,t){let s;try{s=cl(e,o),this.pluginsManager.invokeSingle(`${en}.enqueue`,o,this.dataplaneEventsQueue,s,this.errorHandler,this.logger)}catch(i){this.onError(i,fr)}try{const i=R(e);this.pluginsManager.invokeSingle(`${tn}.enqueue`,o,this.destinationsEventsQueue,i,this.errorHandler,this.logger)}catch(i){this.onError(i,hr)}try{t==null||t(s)}catch(i){this.onError(i,cr)}}onError(e,t,s){if(this.errorHandler)this.errorHandler.onError(e,Us,t,s);else throw e}}const nn=n=>{const e=new CustomEvent(n,{detail:{analyticsInstance:globalThis.rudderanalytics},bubbles:!0,cancelable:!0,composed:!0});globalThis.document.dispatchEvent(e)};class sn{constructor(){this.preloadBuffer=new Rn,this.initialized=!1,this.errorHandler=He,this.logger=V,this.externalSrcLoader=new vn(this.errorHandler,this.logger),this.capabilitiesManager=new Ma(this.errorHandler,this.logger),this.httpClient=ao}load(e,t,s={}){var a;if(o.lifecycle.status.value)return;let i=R(t),r=R(s);cn(t)&&(r=t,i=void 0),M(()=>{o.lifecycle.writeKey.value=e,o.lifecycle.dataPlaneUrl.value=i,o.loadOptions.value=ol(o.loadOptions.value,r),o.lifecycle.status.value="mounted"}),o.loadOptions.value.logLevel&&((a=this.logger)==null||a.setMinLogLevel(o.loadOptions.value.logLevel)),Fe("state",o,e),this.startLifecycle()}startLifecycle(){q(()=>{try{switch(o.lifecycle.status.value){case"mounted":this.onMounted();break;case"browserCapabilitiesReady":this.onBrowserCapabilitiesReady();break;case"configured":this.onConfigured();break;case"pluginsLoading":break;case"pluginsReady":this.onPluginsReady();break;case"initialized":this.onInitialized();break;case"loaded":this.onLoaded();break;case"destinationsLoading":break;case"destinationsReady":this.onDestinationsReady();break;case"ready":this.onReady();break;case"readyExecuted":default:break}}catch(e){const t="Failed to load the SDK";this.errorHandler.onError(Re(e,t),Qe)}})}onBrowserCapabilitiesReady(){ei(this),this.prepareInternalServices(),this.loadConfig()}onLoaded(){this.processBufferedEvents(),o.consents.preConsent.value.enabled===!0?o.lifecycle.status.value="ready":this.loadDestinations()}onMounted(){this.capabilitiesManager.init()}enqueuePreloadBufferEvents(e){Array.isArray(e)&&e.forEach(t=>this.preloadBuffer.enqueue(R(t)))}processDataInPreloadBuffer(){for(;this.preloadBuffer.size()>0;){const e=this.preloadBuffer.dequeue();e&&ti([...e],this)}}prepareInternalServices(){this.pluginsManager=new ro(Cn,this.errorHandler,this.logger),this.storeManager=new ea(this.pluginsManager,this.errorHandler,this.logger),this.configManager=new Pa(this.httpClient,this.errorHandler,this.logger),this.userSessionManager=new il(this.errorHandler,this.logger,this.pluginsManager,this.storeManager,this.httpClient),this.eventRepository=new dl(this.pluginsManager,this.storeManager,this.errorHandler,this.logger),this.eventManager=new sl(this.eventRepository,this.userSessionManager,this.errorHandler,this.logger)}loadConfig(){var e;o.lifecycle.writeKey.value&&this.httpClient.setAuthHeader(o.lifecycle.writeKey.value),(e=this.configManager)==null||e.init()}onPluginsReady(){var e,t,s,i,r;this.errorHandler.init(this.externalSrcLoader),(e=this.storeManager)==null||e.init(),(t=this.userSessionManager)==null||t.init(),o.consents.enabled.value&&!o.consents.initialized.value&&((s=this.pluginsManager)==null||s.invokeSingle("consentManager.init",o,this.logger),o.consents.preConsent.value.enabled===!1&&((i=this.pluginsManager)==null||i.invokeSingle("consentManager.updateConsentsInfo",o,this.storeManager,this.logger))),(r=this.eventManager)==null||r.init(),o.lifecycle.status.value="initialized"}onConfigured(){var e;(e=this.pluginsManager)==null||e.init()}onInitialized(){this.processDataInPreloadBuffer(),f(o.loadOptions.value.onLoaded)&&o.loadOptions.value.onLoaded(globalThis.rudderanalytics),M(()=>{o.lifecycle.loaded.value=!0,o.lifecycle.status.value="loaded"}),this.initialized=!0,nn("RSA_Initialised")}onReady(){o.lifecycle.status.value="readyExecuted",o.eventBuffer.readyCallbacksArray.value.forEach(e=>{try{e()}catch(t){this.errorHandler.onError(t,Qe,$t)}}),nn("RSA_Ready")}processBufferedEvents(){let e=o.eventBuffer.toBeProcessedArray.value;for(;e.length>0;){const t=e.shift();if(o.eventBuffer.toBeProcessedArray.value=e,t){const s=t[0];f(this[s])&&this[s](...t.slice(1),!0)}e=o.eventBuffer.toBeProcessedArray.value}}loadDestinations(){var t,s;if(o.nativeDestinations.clientDestinationsReady.value)return;(t=this.pluginsManager)==null||t.invokeSingle("nativeDestinations.setActiveDestinations",o,this.pluginsManager,this.errorHandler,this.logger);const e=o.nativeDestinations.activeDestinations.value.length;if(e===0){o.lifecycle.status.value="destinationsReady";return}o.lifecycle.status.value="destinationsLoading",(s=this.pluginsManager)==null||s.invokeSingle("nativeDestinations.load",o,this.externalSrcLoader,this.errorHandler,this.logger),q(()=>{(e===0||o.nativeDestinations.initializedDestinations.value.length+o.nativeDestinations.failedDestinations.value.length===e)&&M(()=>{o.lifecycle.status.value="destinationsReady",o.nativeDestinations.clientDestinationsReady.value=!0})})}onDestinationsReady(){o.lifecycle.status.value!=="ready"&&(o.lifecycle.status.value="ready")}ready(e,t=!1){const s="ready";if(!o.lifecycle.loaded.value){o.eventBuffer.toBeProcessedArray.value=[...o.eventBuffer.toBeProcessedArray.value,[s,e]];return}if(this.errorHandler.leaveBreadcrumb(`New ${s} invocation`),!f(e)){this.logger.error(xi(Ms));return}if(o.lifecycle.status.value==="readyExecuted")try{e()}catch(i){this.errorHandler.onError(i,Qe,$t)}else o.eventBuffer.readyCallbacksArray.value=[...o.eventBuffer.readyCallbacksArray.value,e]}page(e,t=!1){var i;const s="page";if(!o.lifecycle.loaded.value){o.eventBuffer.toBeProcessedArray.value=[...o.eventBuffer.toBeProcessedArray.value,[s,e]];return}this.errorHandler.leaveBreadcrumb(`New ${s} event`),o.metrics.triggered.value+=1,(i=this.eventManager)==null||i.addEvent({type:"page",category:e.category,name:e.name,properties:e.properties,options:e.options,callback:e.callback}),o.capabilities.isAdBlocked.value===!0&&e.category!==kt&&this.page(Ue(kt,Gs,{path:Fs},o.loadOptions.value.sendAdblockPageOptions))}track(e,t=!1){var i;const s="track";if(!o.lifecycle.loaded.value){o.eventBuffer.toBeProcessedArray.value=[...o.eventBuffer.toBeProcessedArray.value,[s,e]];return}this.errorHandler.leaveBreadcrumb(`New ${s} event`),o.metrics.triggered.value+=1,(i=this.eventManager)==null||i.addEvent({type:s,name:e.name||void 0,properties:e.properties,options:e.options,callback:e.callback})}identify(e,t=!1){var r,a,l;const s="identify";if(!o.lifecycle.loaded.value){o.eventBuffer.toBeProcessedArray.value=[...o.eventBuffer.toBeProcessedArray.value,[s,e]];return}this.errorHandler.leaveBreadcrumb(`New ${s} event`),o.metrics.triggered.value+=1,!!(e.userId&&o.session.userId.value&&e.userId!==o.session.userId.value)&&this.reset(),F(e.userId)||(r=this.userSessionManager)==null||r.setUserId(e.userId),(a=this.userSessionManager)==null||a.setUserTraits(e.traits),(l=this.eventManager)==null||l.addEvent({type:s,userId:e.userId,traits:e.traits,options:e.options,callback:e.callback})}alias(e,t=!1){var r,a,l;const s="alias";if(!o.lifecycle.loaded.value){o.eventBuffer.toBeProcessedArray.value=[...o.eventBuffer.toBeProcessedArray.value,[s,e]];return}this.errorHandler.leaveBreadcrumb(`New ${s} event`),o.metrics.triggered.value+=1;const i=e.from??((r=this.userSessionManager)==null?void 0:r.getUserId())??((a=this.userSessionManager)==null?void 0:a.getAnonymousId());(l=this.eventManager)==null||l.addEvent({type:s,to:e.to,from:i,options:e.options,callback:e.callback})}group(e,t=!1){var i,r,a;const s="group";if(!o.lifecycle.loaded.value){o.eventBuffer.toBeProcessedArray.value=[...o.eventBuffer.toBeProcessedArray.value,[s,e]];return}this.errorHandler.leaveBreadcrumb(`New ${s} event`),o.metrics.triggered.value+=1,F(e.groupId)||(i=this.userSessionManager)==null||i.setGroupId(e.groupId),(r=this.userSessionManager)==null||r.setGroupTraits(e.traits),(a=this.eventManager)==null||a.addEvent({type:s,groupId:e.groupId,traits:e.traits,options:e.options,callback:e.callback})}reset(e,t=!1){var i;const s="reset";if(!o.lifecycle.loaded.value){o.eventBuffer.toBeProcessedArray.value=[...o.eventBuffer.toBeProcessedArray.value,[s,e]];return}this.errorHandler.leaveBreadcrumb(`New ${s} invocation, resetAnonymousId: ${e}`),(i=this.userSessionManager)==null||i.reset(e)}getAnonymousId(e){var t;return(t=this.userSessionManager)==null?void 0:t.getAnonymousId(e)}setAnonymousId(e,t,s=!1){var r;const i="setAnonymousId";if(!o.lifecycle.loaded.value){o.eventBuffer.toBeProcessedArray.value=[...o.eventBuffer.toBeProcessedArray.value,[i,e,t]];return}this.errorHandler.leaveBreadcrumb(`New ${i} invocation`),(r=this.userSessionManager)==null||r.setAnonymousId(e,t)}getUserId(){return o.session.userId.value}getUserTraits(){return o.session.userTraits.value}getGroupId(){return o.session.groupId.value}getGroupTraits(){return o.session.groupTraits.value}startSession(e,t=!1){var i;const s="startSession";if(!o.lifecycle.loaded.value){o.eventBuffer.toBeProcessedArray.value=[...o.eventBuffer.toBeProcessedArray.value,[s,e]];return}this.errorHandler.leaveBreadcrumb(`New ${s} invocation`),(i=this.userSessionManager)==null||i.start(e)}endSession(e=!1){var s;const t="endSession";if(!o.lifecycle.loaded.value){o.eventBuffer.toBeProcessedArray.value=[...o.eventBuffer.toBeProcessedArray.value,[t]];return}this.errorHandler.leaveBreadcrumb(`New ${t} invocation`),(s=this.userSessionManager)==null||s.end()}getSessionId(){var t;return((t=this.userSessionManager)==null?void 0:t.getSessionId())??null}consent(e,t=!1){var i,r,a,l;const s="consent";if(!o.lifecycle.loaded.value){o.eventBuffer.toBeProcessedArray.value=[...o.eventBuffer.toBeProcessedArray.value,[s,e]];return}this.errorHandler.leaveBreadcrumb("New consent invocation"),M(()=>{o.consents.preConsent.value={...o.consents.preConsent.value,enabled:!1},o.consents.postConsent.value=Ea(e);const{initialized:c,consentsData:u}=Hn(o.consents.postConsent.value.consentManagement,this.logger);o.consents.initialized.value=c||o.consents.initialized.value,o.consents.data.value=u}),o.consents.enabled.value&&!o.consents.initialized.value&&((i=this.pluginsManager)==null||i.invokeSingle("consentManager.updateConsentsInfo",o,this.storeManager,this.logger)),(r=this.storeManager)==null||r.initializeStorageState(),(a=this.userSessionManager)==null||a.syncStorageDataToState(),(l=this.eventManager)==null||l.resume(),this.loadDestinations(),this.sendTrackingEvents(t)}sendTrackingEvents(e){if(o.consents.postConsent.value.trackConsent){const t=mt(js);e?o.eventBuffer.toBeProcessedArray.value=[...o.eventBuffer.toBeProcessedArray.value,["track",t]]:this.track(t)}if(o.consents.postConsent.value.sendPageEvent){const t=Ue();e?o.eventBuffer.toBeProcessedArray.value=[...o.eventBuffer.toBeProcessedArray.value,["page",t]]:this.page(t)}}setAuthToken(e){var t;(t=this.userSessionManager)==null||t.setAuthToken(e)}}const ce=class ce{constructor(){S(this,"analyticsInstances",{});S(this,"defaultAnalyticsKey","");S(this,"logger",V);if(ce.globalSingleton)return ce.globalSingleton;He.attachErrorListeners(),this.setDefaultInstanceKey=this.setDefaultInstanceKey.bind(this),this.getAnalyticsInstance=this.getAnalyticsInstance.bind(this),this.load=this.load.bind(this),this.ready=this.ready.bind(this),this.triggerBufferedLoadEvent=this.triggerBufferedLoadEvent.bind(this),this.page=this.page.bind(this),this.track=this.track.bind(this),this.identify=this.identify.bind(this),this.alias=this.alias.bind(this),this.group=this.group.bind(this),this.reset=this.reset.bind(this),this.getAnonymousId=this.getAnonymousId.bind(this),this.setAnonymousId=this.setAnonymousId.bind(this),this.getUserId=this.getUserId.bind(this),this.getUserTraits=this.getUserTraits.bind(this),this.getGroupId=this.getGroupId.bind(this),this.getGroupTraits=this.getGroupTraits.bind(this),this.startSession=this.startSession.bind(this),this.endSession=this.endSession.bind(this),this.getSessionId=this.getSessionId.bind(this),this.setAuthToken=this.setAuthToken.bind(this),this.consent=this.consent.bind(this),ce.globalSingleton=this,this.triggerBufferedLoadEvent(),globalThis.rudderanalytics=this}setDefaultInstanceKey(e){e&&(this.defaultAnalyticsKey=e)}getAnalyticsInstance(e){const t=e??this.defaultAnalyticsKey;return!!this.analyticsInstances[t]||(this.analyticsInstances[t]=new sn),this.analyticsInstances[t]}load(e,t,s){if(!N(e)){this.logger.error(ar(Ot,e));return}this.analyticsInstances[e]||(this.setDefaultInstanceKey(e),this.analyticsInstances[e]=new sn,this.getAnalyticsInstance(e).load(e,t,s))}triggerBufferedLoadEvent(){const e=Array.isArray(globalThis.rudderanalytics)?globalThis.rudderanalytics:[];Zs(e);const t=Js(e);Fe(it,R(e)),t.length>0&&(t.shift(),this.load.apply(null,t))}ready(e){this.getAnalyticsInstance().ready(e)}page(e,t,s,i,r){this.getAnalyticsInstance().page(Ue(e,t,s,i,r))}track(e,t,s,i){this.getAnalyticsInstance().track(mt(e,t,s,i))}identify(e,t,s,i){this.getAnalyticsInstance().identify(un(e,t,s,i))}alias(e,t,s,i){this.getAnalyticsInstance().alias(dn(e,t,s,i))}group(e,t,s,i){if(arguments.length===0){this.logger.error(lr(Ot));return}this.getAnalyticsInstance().group(gn(e,t,s,i))}reset(e){this.getAnalyticsInstance().reset(e)}getAnonymousId(e){return this.getAnalyticsInstance().getAnonymousId(e)}setAnonymousId(e,t){this.getAnalyticsInstance().setAnonymousId(e,t)}getUserId(){return this.getAnalyticsInstance().getUserId()}getUserTraits(){return this.getAnalyticsInstance().getUserTraits()}getGroupId(){return this.getAnalyticsInstance().getGroupId()}getGroupTraits(){return this.getAnalyticsInstance().getGroupTraits()}startSession(e){return this.getAnalyticsInstance().startSession(e)}endSession(){return this.getAnalyticsInstance().endSession()}getSessionId(){return this.getAnalyticsInstance().getSessionId()}setAuthToken(e){return this.getAnalyticsInstance().setAuthToken(e)}consent(e){return this.getAnalyticsInstance().consent(e)}};S(ce,"globalSingleton",null);let pt=ce;function Yn(n=0){return n>5?!1:(setTimeout(()=>{if(window.htmx)return!0;Yn(n+1)},500),!0)}function gl(){const n=document.querySelector('[name="fields[anonymous_id]"]');n!==null?(n.value=z.getAnonymousId(),console.log("RudderStack Field Update complete - ",z.getAnonymousId())):console.log("anonymousIdField is null")}function rn(){[...document.getElementsByTagName("a")].forEach(t=>{if(t.addEventListener("click",r=>{const a=r.currentTarget,l={eventElement:"a",target:a.href,title:a.innerText,id_html:a.id,className:a.className.split(" "),ariaLabel:a.getAttribute("aria-label")};z.track("Clicked A Link",l),console.warn(l)},{once:!0}),!t.href||!t.hasAttribute("href"))return!1;const s=new URL(t.href);s.origin!==location.origin&&!s.searchParams.get("anonymous_id")&&(s.searchParams.append("anonymous_id",z.getAnonymousId()),t.href=s)}),[...document.getElementsByTagName("button")].forEach(t=>{t.addEventListener("click",s=>{const i=s.currentTarget,r={eventElement:"button",title:i.innerText,id_html:i.id,className:i.className.split(" "),ariaLabel:i.getAttribute("aria-label")};z.track("Pressed A Button",r),console.warn(r)},{once:!0})})}const z=new pt;z.load("2Fivwkm2WzdbgiuTksdgWz729mz","https://conversionwbv.dataplane.rudderstack.com",{storage:{encryption:{version:"legacy"}}});z.ready(()=>{rn(),Yn()&&window.htmx.on("htmx:afterSwap",()=>{rn()}),z.getAnonymousId(),window.addEventListener("onBeforeFormieSubmit",()=>{gl()})});z.page();function hl(){let n=null,e=null;document.addEventListener("afterBlitzInjectAll",function(){n=document.getElementById("socialShare"),e=document.getElementById("referrerSelectInput"),n&&s()});function t(i,r){const a=new Date(new Date().getTime()+31536e6);tt.set(i,r,{expires:a})}function s(){n.addEventListener("submit",function(i){i.preventDefault();const r=document.querySelector("#jobSearch input"),a=r?Array.from(r):[],l=`${window.location.origin}${window.location.pathname}`,c=new URL(l);a.filter(u=>u.value!=="").forEach(u=>c.searchParams.append(u.name,u.value)),t("social-role",e.value),c.searchParams.append("r",e.value),navigator.clipboard.writeText(c.href).then(()=>{const u=document.createElement("div");u.classList.add("clipboard"),u.textContent="Copied to clipboard",document.body.appendChild(u),setTimeout(()=>{document.body.removeChild(u)},2e3)}).catch(u=>{console.error("Failed to copy URL: ",u)})})}}hl();function fl(){const n=document.querySelectorAll("[data-event-trigger]");function e(i){const r=i.dataset.googleEventCategory,a=i.dataset.facebookEventTrack;r&&window.hasOwnProperty("dataLayer")&&t(r),a&&window.hasOwnProperty("fbq")&&s(a)}function t(i){let r={event:"click",method:"",transport_type:"beacon",event_category:i};window.dataLayer.push(r)}function s(i){window.fbq("track",i)}n.forEach(i=>{const r=i.dataset.eventTriggerType||"click";i.addEventListener(r,()=>e(i))})}fl();function pl(){document.addEventListener("DOMContentLoaded",function(){const n=document.querySelector("[data-field-handle='virtualRecruiter']");if(n!==null){let l=function(){n.addEventListener("onAfterFormieEvaluateConditions",function(u){u.target.conditionallyHidden?c(!1):r.dispatchEvent(new Event("change",{bubbles:!0}))}),r.addEventListener("change",u=>{c(u.target.checked)})},c=function(u){const h=u?"thankyou":"sorry";a.value=h};var t=l,s=c;const i=document.querySelector(".fui-form"),r=n.querySelector("input[type='checkbox']"),a=i.querySelector("[data-field-handle='vrRedirect'] input");l()}},!1)}pl();
//# sourceMappingURL=site.js.map
})()